import{$ as n}from"./api-bc262951.js";import{b as x,a as B,s as A,e as R,c as $}from"./notifications-cae4d01c.js";import{ac as G,r,k as L,a2 as b}from"./index-91fc7b83.js";const j=async a=>await n(`/property/${a}`,{method:"GET"}),k=async a=>await n("/billboards",{method:"GET",params:a}),C=async(a,c)=>await n(`/project/${c}/properties`,{method:"GET",params:a}),N=async(a,c)=>await n(`/property/${a}`,{method:"PATCH",body:c}),U=async a=>await n(`/property${a}`,{method:"DELETE"}),z=async a=>await n(`/properties/${a}`,{method:"GET"}),O=async()=>await n("/available/properties",{method:"GET"}),S=async()=>await n("/export/property",{method:"GET"});function V(){G("userData").value;const a=r(!1),c=r(null);L();const u=r(null),i=r([]),v=r([]),d=r(0),f=async e=>{a.value=!0,c.value=null;try{console.log("este es el formulario:",e);const t={1:"available",2:"reserved",3:"rented",4:"inactive"}[e.status.value]||"UNKNOWN";console.log(t)}catch(s){console.log(s),s.response&&s.response.status==422&&x("Advertencia","Faltan Datos por Rellenar")}finally{a.value=!1}},y=async e=>{var s,t,o,p;a.value=!0,c.value=null;try{const l={title:e.title,code:e.code,surface:e.surface,base_price:e.base_price,percentage_initial_fee:e.percentage_initial_fee,property_type:e.property_type,number_bathrooms:((s=e==null?void 0:e.departament)==null?void 0:s.number_bathrooms)??"",number_bedrooms:((t=e==null?void 0:e.departament)==null?void 0:t.number_bedrooms)??"",surface_balcony:((o=e==null?void 0:e.departament)==null?void 0:o.surface_balcony)??"",is_balcony:(p=e==null?void 0:e.departament)==null?void 0:p.is_balcony,covered:!!(e!=null&&e.covered)},T=await N(e.id,l);return console.log(T),B("¡Propiedad actualizada exitosamente!","Los detalles de la propiedad han sido editados y guardados correctamente."),{success:!0,message:"Actualización Exitosa"}}catch(l){return console.log(l),l.response&&l.response.status==422?(A("Validación fallida","Faltan datos por rellenar"),{success:!1,message:"Validación fallida"}):(R("Advertencia","Hubo un problema al actualizar la propiedad."),{success:!1,message:"Error de actualización"})}finally{a.value=!1}},h=async e=>{try{const s=await k(e);console.log("respuesta",s),i.value=s.data.data,d.value=s.data.total}catch(s){console.log(s)}},w=async(e,s)=>{try{const t=await C(e,s);console.log("respuesta",t),i.value=t.data.data,d.value=t.data.total}catch(t){console.log(t)}},g=async e=>{try{const s=await U(e);console.log(s),$("Elimino una Propidad Correctamente","Se Acaba de eliminar una propiedad con exito del sistema de inventario.")}catch(s){console.log(s)}},P=async e=>{try{const s=await j(e);u.value=s.data}catch(s){console.log(s)}},m=async e=>{try{const s=await z(e);return v.value=s.data,console.log("propertyfortype ",s.data),s.data}catch(s){console.log(s)}},E=async()=>{try{const e=await O();return i.value=e.data,console.log("properties: ",e.data),e.data}catch(e){console.log(e)}},_=async()=>{try{const e=await S();if(!(e instanceof Blob))throw new Error("Respuesta inválida del servidor con el BLOB");const s=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=window.URL.createObjectURL(s),o=document.createElement("a");o.href=t,o.setAttribute("download","propiedades.xlsx"),document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(t),document.body.removeChild(o)}catch(e){console.error("Error en exportación:",e)}};return{loadingProperty:a,error:c,addBillboard:f,editProperty:y,getPropertyId:P,allBillboard:h,allPropertybyProject:w,propertiesForType:m,removeProperty:g,propertiesAvailbles:E,properties:b(()=>i.value),property:u,totalProperties:b(()=>d.value),exportPropertyExcel:_}}export{V as u};
