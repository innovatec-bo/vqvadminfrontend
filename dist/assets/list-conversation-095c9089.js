import{_ as j}from"./AppSelect-848fd71b.js";import{_ as E}from"./AppTextField-a30fbcb8.js";import{$}from"./api-5e105e76.js";import{a as z}from"./notifications-e0287a8c.js";import{r as p,a2 as b,w as I,o as B,c as F,b as l,e as a,d as u,n as o,a0 as V,x as f,v as w,a4 as P,s as S}from"./index-b40b785d.js";import{p as H}from"./paginationMeta-4ad053a4.js";import{l as R}from"./lodash-8a6ce57c.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import{V as L}from"./VCard-2ad73a87.js";import{V as O}from"./VCardText-3fc39e2b.js";import{V as A}from"./VDivider-1866a089.js";import{V as Q}from"./VDataTableServer-a40edf09.js";import{V as q}from"./VRow-be1e0310.js";import{V as J}from"./VChip-a1be3f1e.js";import{V as K}from"./VCheckbox-b0ac60df.js";import{V as W}from"./VTooltip-24e6bd7d.js";import{V as X}from"./VPagination-f232b5e2.js";import"./form-6c56fbec.js";import"./VSelect-c7887e8a.js";import"./VTextField-f72f7a7b.js";/* empty css                   */import"./VCounter-122618cf.js";import"./VImg-d8b1f694.js";import"./VField-7ff231c0.js";import"./easing-9f15041e.js";import"./VInput-199f1c57.js";import"./forwardRefs-8348545e.js";import"./VList-48bba736.js";import"./ssrBoot-51124d42.js";import"./VAvatar-fc605694.js";import"./dialog-transition-8dbae8f6.js";import"./VMenu-3781f2e6.js";import"./VOverlay-adc3474d.js";import"./lazy-08fd721d.js";import"./scopeId-df115906.js";import"./VCheckboxBtn-4156c138.js";import"./VSelectionControl-cbf2c210.js";import"./index-9c720871.js";import"./constants-71880aa6.js";import"./VDataTable-0ee0497f.js";import"./VTable-f0a4c716.js";import"./filter-fb016a25.js";const Y=async m=>await $("conversations/list-paginated",{method:"GET",params:m}),Z=async(m,_)=>await $(`/conversations/update-status/${m}/${_}`,{method:"PATCH"});function ee(){const m=p(!1),_=p(null),g=p(null),y=p([]),x=p(0),c=async n=>{m.value=!0;try{const i=await Y(n);console.log(i),y.value=i.data.data,x.value=i.data.total}catch(i){i.value=i.message,console.log(i)}finally{m.value=!1}},s=async(n,i)=>{m.value=!0;try{const d=await Z(n,i);console.log(d),z("Estado Actualizado","Se Actualizo el estado de la IA")}catch(d){d.value=d.message,console.log(d)}finally{m.value=!1}};return{loading:m,error:_,conversation:g,conversations:b(()=>y.value),totalConversations:b(()=>x.value),allConversationsPaginate:c,updateConversationStatus:s}}const te={class:"d-flex justify-space-between flex-wrap gap-y-4"},ae={class:"d-flex flex-row gap-4 align-center flex-wrap"},oe={class:"d-flex gap-x-2"},se=["href"],ne={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},le={class:"text-sm text-disabled mb-0"},ie={__name:"list-conversation",setup(m){const{allConversationsPaginate:_,totalConversations:g,conversations:y,updateConversationStatus:x}=ee(),c=p(""),s=p(10),n=p(1);p(),p();const i=[{title:"Celular",key:"phone"},{title:"Es Cliente ?",key:"isCustomer"},{title:"Cliente",key:"customerName"},{title:"Ultimo Mensaje",key:"last_message"},{title:"Estado",key:"ia_status"},{title:"Acción",key:"action"}],d=r=>{n.value=r.page,s.value=r.itemsPerPage},D=()=>{_({page:n.value,itemsPerPage:s.value,search:c.value})},k=R.debounce(D,300);I([c,s,n],k,{immediate:!0});const U=async r=>{const t=p(0);r.ia_status&&(t.value=1),await x(r.id,t.value)},M=r=>{const t=new Date(r),h=t.getDate(),e=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][t.getMonth()],C=t.getHours().toString().padStart(2,"0"),T=t.getMinutes().toString().padStart(2,"0");return`${h} de ${e}, ${C}:${T}`},N=r=>{const t=new Date,h=new Date(r),v=(t-h)/(1e3*60*60);return console.log(v),v>=12?"error":v>=6?"warning":v>=3?"info":"succes"};return(r,t)=>{const h=E,v=j;return B(),F("div",null,[l(L,{title:"Lista de Conversación con la IA"},{default:a(()=>[l(O,null,{default:a(()=>[u("div",te,[l(h,{modelValue:o(c),"onUpdate:modelValue":t[0]||(t[0]=e=>V(c)?c.value=e:null),style:{"max-inline-size":"200px","min-inline-size":"200px"},placeholder:"Search ..",density:"compact"},null,8,["modelValue"]),u("div",ae,[l(v,{modelValue:o(s),"onUpdate:modelValue":t[1]||(t[1]=e=>V(s)?s.value=e:null),density:"compact",items:[5,10,20,50,100]},null,8,["modelValue"])])])]),_:1}),l(A),l(o(Q),{"items-per-page":o(s),"onUpdate:itemsPerPage":t[3]||(t[3]=e=>V(s)?s.value=e:null),page:o(n),"onUpdate:page":t[4]||(t[4]=e=>V(n)?n.value=e:null),items:o(y),headers:i,"items-length":o(g),class:"text-no-wrap","onUpdate:options":d},{"item.phone":a(({item:e})=>[u("div",oe,[u("a",{href:`https://api.whatsapp.com/send?phone=${e.phone}`,target:"_blank",rel:"noopener noreferrer",class:"text-body-1"},f(e.cod_phone)+" "+f(e.phone),9,se)])]),"item.last_message":a(({item:e})=>[l(q,{class:"gap-2 align-center"},{default:a(()=>[l(J,{color:N(e.last_message)},{default:a(()=>[w(f(M(e.last_message)),1)]),_:2},1032,["color"])]),_:2},1024)]),"item.ia_status":a(({item:e})=>[u("span",null,f(e.ia_status?"Activado":"No activado"),1)]),"item.isCustomer":a(({item:e})=>[u("span",null,f(e.isCustomer?"Sí":"No"),1)]),"item.action":a(({item:e})=>[l(K,{modelValue:e.ia_status,"onUpdate:modelValue":C=>e.ia_status=C,"true-value":1,"false-value":0,onChange:C=>U(e)},{default:a(()=>[l(W,{activator:"parent",location:"top"},{default:a(()=>[w(f(e.ia_status?"Desactivar IA":"Activar IA"),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),bottom:a(()=>[l(A),u("div",ne,[u("p",le,f(o(H)({page:o(n),itemsPerPage:o(s)},o(g))),1),l(X,{modelValue:o(n),"onUpdate:modelValue":t[2]||(t[2]=e=>V(n)?n.value=e:null),length:Math.ceil(o(g)/o(s)),"total-visible":r.$vuetify.display.xs?1:Math.min(Math.ceil(o(g)/o(s)),5)},{prev:a(e=>[l(P,S({variant:"tonal",color:"default"},e,{icon:!1}),{default:a(()=>t[5]||(t[5]=[w(" Previous ")])),_:2},1040)]),next:a(e=>[l(P,S({variant:"tonal",color:"default"},e,{icon:!1}),{default:a(()=>t[6]||(t[6]=[w(" Next ")])),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1})])}}},We=G(ie,[["__scopeId","data-v-7a46a387"]]);export{We as default};
