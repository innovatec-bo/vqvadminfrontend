import{_ as j}from"./AppSelect-efaf9105.js";import{_ as E}from"./AppTextField-29b22b24.js";import{$}from"./api-aa8c13ee.js";import{c as z}from"./notifications-cae4d01c.js";import{r as p,a2 as b,w as I,o as B,c as F,b as l,e as a,d as u,n as o,a0 as V,x as v,v as w,a4 as P,s as S}from"./index-c2e96262.js";import{p as H}from"./paginationMeta-4ad053a4.js";import{l as R}from"./lodash-e73df43d.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import{V as L}from"./VCard-f5bbdae8.js";import{V as O}from"./VCardText-df626bb1.js";import{V as A}from"./VDivider-88128b79.js";import{V as Q}from"./VDataTableServer-a5cb9db4.js";import{V as q}from"./VRow-7348eabc.js";import{V as J}from"./VChip-e912eeed.js";import{V as K}from"./VCheckbox-510e1275.js";import{V as W}from"./VTooltip-6699a366.js";import{V as X}from"./VPagination-e368eed8.js";import"./form-b8ba296f.js";import"./VSelect-b13256b2.js";import"./VTextField-86db8845.js";/* empty css                   */import"./VCounter-7567efe3.js";import"./VImg-31fed283.js";import"./VField-e94b1a76.js";import"./easing-9f15041e.js";import"./VInput-66adbaa5.js";import"./forwardRefs-8348545e.js";import"./VList-b9114e4f.js";import"./ssrBoot-de99a4c4.js";import"./VAvatar-a0558956.js";import"./dialog-transition-00941f89.js";import"./VMenu-b0d8fe43.js";import"./VOverlay-ca90609e.js";import"./lazy-b6b07144.js";import"./scopeId-10fccddb.js";import"./VCheckboxBtn-fffadaff.js";import"./VSelectionControl-e3762066.js";import"./index-9c720871.js";import"./constants-b7e4fea4.js";import"./VDataTable-dfa81003.js";import"./VTable-d0b86b7f.js";import"./filter-fd4c1098.js";const Y=async m=>await $("conversations/list-paginated",{method:"GET",params:m}),Z=async(m,_)=>await $(`/conversations/update-status/${m}/${_}`,{method:"PATCH"});function ee(){const m=p(!1),_=p(null),g=p(null),y=p([]),x=p(0),c=async n=>{m.value=!0;try{const i=await Y(n);console.log(i),y.value=i.data.data,x.value=i.data.total}catch(i){i.value=i.message,console.log(i)}finally{m.value=!1}},s=async(n,i)=>{m.value=!0;try{const d=await Z(n,i);console.log(d),z("Estado Actualizado","Se Actualizo el estado de la IA")}catch(d){d.value=d.message,console.log(d)}finally{m.value=!1}};return{loading:m,error:_,conversation:g,conversations:b(()=>y.value),totalConversations:b(()=>x.value),allConversationsPaginate:c,updateConversationStatus:s}}const te={class:"d-flex justify-space-between flex-wrap gap-y-4"},ae={class:"d-flex flex-row gap-4 align-center flex-wrap"},oe={class:"d-flex gap-x-2"},se=["href"],ne={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},le={class:"text-sm text-disabled mb-0"},ie={__name:"list-conversation",setup(m){const{allConversationsPaginate:_,totalConversations:g,conversations:y,updateConversationStatus:x}=ee(),c=p(""),s=p(10),n=p(1);p(),p();const i=[{title:"Celular",key:"phone"},{title:"Es Cliente ?",key:"isCustomer"},{title:"Cliente",key:"customerName"},{title:"Ultimo Mensaje",key:"last_message"},{title:"Estado",key:"ia_status"},{title:"Acción",key:"action"}],d=r=>{n.value=r.page,s.value=r.itemsPerPage},D=()=>{_({page:n.value,itemsPerPage:s.value,search:c.value})},k=R.debounce(D,300);I([c,s,n],k,{immediate:!0});const U=async r=>{const t=p(0);r.ia_status&&(t.value=1),await x(r.id,t.value)},M=r=>{const t=new Date(r),h=t.getDate(),e=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][t.getMonth()],C=t.getHours().toString().padStart(2,"0"),T=t.getMinutes().toString().padStart(2,"0");return`${h} de ${e}, ${C}:${T}`},N=r=>{const t=new Date,h=new Date(r),f=(t-h)/(1e3*60*60);return console.log(f),f>=12?"error":f>=6?"warning":f>=3?"info":"succes"};return(r,t)=>{const h=E,f=j;return B(),F("div",null,[l(L,{title:"Lista de Conversación con la IA"},{default:a(()=>[l(O,null,{default:a(()=>[u("div",te,[l(h,{modelValue:o(c),"onUpdate:modelValue":t[0]||(t[0]=e=>V(c)?c.value=e:null),style:{"max-inline-size":"200px","min-inline-size":"200px"},placeholder:"Search ..",density:"compact"},null,8,["modelValue"]),u("div",ae,[l(f,{modelValue:o(s),"onUpdate:modelValue":t[1]||(t[1]=e=>V(s)?s.value=e:null),density:"compact",items:[5,10,20,50,100]},null,8,["modelValue"])])])]),_:1}),l(A),l(o(Q),{"items-per-page":o(s),"onUpdate:itemsPerPage":t[3]||(t[3]=e=>V(s)?s.value=e:null),page:o(n),"onUpdate:page":t[4]||(t[4]=e=>V(n)?n.value=e:null),items:o(y),headers:i,"items-length":o(g),class:"text-no-wrap","onUpdate:options":d},{"item.phone":a(({item:e})=>[u("div",oe,[u("a",{href:`https://api.whatsapp.com/send?phone=${e.phone}`,target:"_blank",rel:"noopener noreferrer",class:"text-body-1"},v(e.cod_phone)+" "+v(e.phone),9,se)])]),"item.last_message":a(({item:e})=>[l(q,{class:"gap-2 align-center"},{default:a(()=>[l(J,{color:N(e.last_message)},{default:a(()=>[w(v(M(e.last_message)),1)]),_:2},1032,["color"])]),_:2},1024)]),"item.ia_status":a(({item:e})=>[u("span",null,v(e.ia_status?"Activado":"No activado"),1)]),"item.isCustomer":a(({item:e})=>[u("span",null,v(e.isCustomer?"Sí":"No"),1)]),"item.action":a(({item:e})=>[l(K,{modelValue:e.ia_status,"onUpdate:modelValue":C=>e.ia_status=C,"true-value":1,"false-value":0,onChange:C=>U(e)},{default:a(()=>[l(W,{activator:"parent",location:"top"},{default:a(()=>[w(v(e.ia_status?"Desactivar IA":"Activar IA"),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),bottom:a(()=>[l(A),u("div",ne,[u("p",le,v(o(H)({page:o(n),itemsPerPage:o(s)},o(g))),1),l(X,{modelValue:o(n),"onUpdate:modelValue":t[2]||(t[2]=e=>V(n)?n.value=e:null),length:Math.ceil(o(g)/o(s)),"total-visible":r.$vuetify.display.xs?1:Math.min(Math.ceil(o(g)/o(s)),5)},{prev:a(e=>[l(P,S({variant:"tonal",color:"default"},e,{icon:!1}),{default:a(()=>t[5]||(t[5]=[w(" Previous ")])),_:2},1040)]),next:a(e=>[l(P,S({variant:"tonal",color:"default"},e,{icon:!1}),{default:a(()=>t[6]||(t[6]=[w(" Next ")])),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1})])}}},We=G(ie,[["__scopeId","data-v-e16e22f5"]]);export{We as default};
