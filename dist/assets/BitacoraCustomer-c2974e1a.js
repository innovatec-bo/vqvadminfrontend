import{$ as g}from"./api-40e7a553.js";import{a as v,c as w,b as V}from"./notifications-b6da0b75.js";import{r as d,k as b,a2 as x,H as B,w as C,o as u,c as _,b as p,e as l,d as m,F as T,i as k,n as f,f as h,x as y,v as N,z as P}from"./index-eea64eab.js";import{f as z}from"./formatters-58bf909e.js";import{V as A}from"./VCardText-74af991a.js";import{V as S}from"./VRow-a5449575.js";import{V as $}from"./VCol-6b79a532.js";import{V as D,a as H}from"./VTimelineItem-bc1b2333.js";import{V as I}from"./VChip-d184a964.js";import{V as E}from"./VCard-1446dd49.js";const F=async a=>await g(`/sale/paymentPlans/${a}/confirm`,{method:"PATCH"}),L=async(a,e)=>await g(`/sale/paymentPlans/${a}`,{method:"PATCH",body:e});function oa(){const a=d(!1),e=d([]),o=d(null),n=d(null);return{loadingPaymentPlans:a,paymentPlan:n,error:o,paymentPlans:e,confirmPaymentPlans:async i=>{try{const t=await F(i);v("Actualizacion Exitosa","Se confirmo el pago")}catch(t){console.log(t)}},updatePaymentPlans:async(i,t)=>{a.value=!0,o.value=null;try{console.log(t);const c=await L(i,t);n.value=c.data,w("¡Planes de pago actualizados exitosamente! ","Los planes de pago han sido modificados y guardados correctamente."),console.log(c)}catch(c){console.log(c),c.response&&c.response.status==422&&V("Advertencia","Faltan datos por Completar"),o.value=c.message}finally{a.value=!1}}}}const j=async a=>await g(`/customer/${a}/bitacora`,{method:"GET"});function R(){const a=d(!1),e=d([]);return b(),d(0),{getBitacorabyId:async n=>{try{const r=await j(n);e.value=r,console.log(r)}catch(r){console.error(r)}},loadingBitacora:a,bitacoras:x(()=>e.value)}}const q={class:"my-5"},G={class:"d-flex justify-space-between align-center gap-2 flex-wrap"},M={class:"app-timeline-title"},O={class:"app-timeline-meta"},W={class:"app-timeline-text"},J={key:0,class:"empty-state my-2"},na={__name:"BitacoraCustomer",props:{customer:{type:String,required:!0}},setup(a){const e=a,{bitacoras:o,getBitacorabyId:n}=R();B(async()=>{await n(e.customer)}),C(()=>e.customer,async(s,i)=>{s&&(console.log("Customer actualizado:",s),await n(s))},{immediate:!0});const r=s=>{switch(s){case 1:return"Visita";case 2:return"Llamada";case 3:return"Cotización";default:return"Otro"}};return(s,i)=>(u(),_("div",null,[p(E,{title:"Historial del cliente"},{default:l(()=>[p(A,null,{default:l(()=>[p(S,{class:"d-flex justify-space-between"},{default:l(()=>[p($,{cols:"12"},{default:l(()=>[m("div",q,[p(D,{side:"end",align:"start","line-inset":"8","truncate-line":"both",density:"compact"},{default:l(()=>[(u(!0),_(T,null,k(f(o),t=>(u(),h(H,{key:t.id,size:"x-small","dot-color":"warning"},{default:l(()=>[m("div",G,[m("span",M,y(t.log_name),1),m("span",O,y(("formatDate"in s?s.formatDate:f(z))(t.created_at)),1)]),m("div",W,[m("p",null,y(t.description),1),t.properties.activity?(u(),h(I,{key:0},{default:l(()=>[N(y(r(t.properties.activity.type_activity_id)),1)]),_:2},1024)):P("",!0)])]),_:2},1024))),128))]),_:1}),!f(o)||f(o).length===0?(u(),_("div",J,i[0]||(i[0]=[m("p",null,"No hay actividades registradas para este cliente.",-1)]))):P("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{na as _,oa as u};
