import{$ as a}from"./api-63799492.js";import{a as m,b as h,s as _,c as T,e as w}from"./notifications-81bc0416.js";import{ac as g,r as l,k as E,a2 as f}from"./index-cdb2548c.js";import{D as i,L as u}from"./constants-f3b5ca65.js";const A=async o=>await a("/property",{method:"POST",body:o}),N=async o=>await a(`/property/${o}`,{method:"GET"}),$=async o=>await a("/properties",{method:"GET",params:o}),j=async(o,s)=>await a(`/project/${s}/properties`,{method:"GET",params:o}),R=async(o,s)=>await a(`/property/${o}`,{method:"PATCH",body:s}),x=async o=>await a(`/property${o}`,{method:"DELETE"}),C=async o=>await a(`/properties/${o}`,{method:"GET"}),G=async()=>await a("/available/properties",{method:"GET"});function q(){g("userData").value;const o=l(!1),s=l(null),v=E(),d=l(null),n=l([]),P=l([]),c=l(0);return{loadingProperty:o,error:s,addProperty:async e=>{o.value=!0,s.value=null;try{console.log("este es el formulario:",e);const t={1:"DEPARTAMENT",2:"PARK"}[e.propertyDetails.propertyType.value]||"UNKNOWN";console.log(t);const y={code:e.propertyDetails.code,surface:e.propertyFeatures.surface,description:e.propertyDetails.description,delivery_date:e.propertyDetails.deliveryDate,base_price:e.propertyDetails.price,percentage_initial_fee:e.propertyDetails.percentageinitialfee,property_type:t,property_type_id:e.propertyDetails.propertyType.value,project_id:e.propertyDetails.projectType.value,benefits:e.propertyFeatures.benefitsDetails.map(p=>p.value),features:e.propertyFeatures.featureDetails.map(p=>p.value),type_department_id:t===i?e.propertyFeatures.typeDepartmentsDetails.value:null,number_bathrooms:t!==u?e.propertyFeatures.bathroomCount:"",number_bedrooms:t!==u?e.propertyFeatures.bedroomCount:"",number_floors:t!==u&&t!==i?e.propertyFeatures.floorNo:"",floors:t===i?e.propertyFeatures.floor:"",number_rooms:""};console.log(y);const b=await A(y);console.log("Respuesta del servidor:",b),m("Se Agrego una nueva Propiedad","La propiedad fue registrada exitosamente en el sistema de inventario."),v.push("/realty/property/list")}catch(r){console.log(r),r.response&&r.response.status==422&&h("Advertencia","Faltan Datos por Rellenar")}finally{o.value=!1}},editProperty:async e=>{o.value=!0,s.value=null;try{const r={title:e.title,code:e.code,surface:e.surface,base_price:e.base_price,percentage_initial_fee:e.percentage_initial_fee,property_type:e.property_type,number_bathrooms:e.departament.number_bathrooms,number_bedrooms:e.departament.number_bedrooms,floor:e.departament.floor,covered:!!(e!=null&&e.covered)},t=await R(e.id,r);return _("¡Propiedad actualizada exitosamente!","Los detalles de la propiedad han sido editados y guardados correctamente."),{success:!0,message:"Actualización Exitosa"}}catch(r){return r.response&&r.response.status==422?(T("Validación fallida","Faltan datos por rellenar"),{success:!1,message:"Validación fallida"}):(w("Advertencia","Hubo un problema al actualizar la propiedad."),{success:!1,message:"Error de actualización"})}finally{o.value=!1}},getPropertyId:async e=>{try{const r=await N(e);d.value=r.data}catch(r){console.log(r)}},allProperty:async e=>{try{const r=await $(e);console.log("respuesta",r),n.value=r.data.data,c.value=r.data.total}catch(r){console.log(r)}},allPropertybyProject:async(e,r)=>{try{const t=await j(e,r);console.log("respuesta",t),n.value=t.data.data,c.value=t.data.total}catch(t){console.log(t)}},propertiesForType:async e=>{try{const r=await C(e);return P.value=r.data,console.log("propertyfortype ",r.data),r.data}catch(r){console.log(r)}},removeProperty:async e=>{try{const r=await x(e);console.log(r),m("Elimino una Propidad Correctamente","Se Acaba de eliminar una propiedad con exito del sistema de inventario.")}catch(r){console.log(r)}},propertiesAvailbles:async e=>{try{const r=await G(e);return n.value=r.data,console.log("propertyfortype ",r.data),r.data}catch(r){console.log(r)}},properties:f(()=>n.value),property:d,totalProperties:f(()=>c.value)}}export{q as u};
