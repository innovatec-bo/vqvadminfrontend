import{$ as n}from"./api-f4900d91.js";import{c as w,b,d as Q,a as i}from"./notifications-cae4d01c.js";import{r as c,k as E,a2 as d}from"./index-a54c57b2.js";const q=async a=>await n("/quote/register",{method:"POST",body:a}),x=async(a,s)=>await n(`/quote/${a}/change_status`,{method:"PATCH",body:s}),C=async(a,s)=>await n(`/quote/${a}/change_status_customer`,{method:"PATCH",body:s}),z=async a=>await n("quote/list-paginated",{method:"GET",params:a}),L=async()=>await n("/export/quote",{method:"GET"}),S=async a=>await n(`/quote/${a}`,{method:"GET"});function B(){const a=c(!1),s=c(null),l=c([]),h=E(),u=c(0),p=async t=>{try{const e=await S(t);s.value=e.data,console.log(s.value)}catch(e){console.error(e)}},m=async t=>{a.value=!0;try{const e=await q(t);console.log(e),s.value=e.data,w("¡Cotización registrada exitosamente!","La cotización ha sido generada y registrada en el sistema. ¡Buen trabajo!"),h.push(`/quote/${s.value.id}`)}catch(e){return e.response&&e.response.status==422?(b("Validación fallida","Faltan datos por rellenar"),{success:!1,message:"Validación fallida"}):(Q("Advertencia","Hubo un problema al registrar la Cotizacion. Contactese con Soporte."),{success:!1,message:"Error al Registrar"})}finally{a.value=!1}},g=async(t,e)=>{a.value=!0;try{const o=await x(t,e);s.value=o.data,console.log(o),i("¡El estado de la cotización ha cambiado! ","La cotización ha pasado a un nuevo estado")}catch(o){console.log(o)}finally{a.value=!1}},y=async(t,e)=>{a.value=!0;try{const o=await C(t,e);s.value=o.data,console.log(o),i("¡El estado de la cotización ha cambiado! ","La cotización ha pasado a un nuevo estado")}catch(o){console.log(o)}finally{a.value=!1}},f=async t=>{a.value=!0;try{const e=await z(t);console.log(e),l.value=e.data.data,u.value=e.data.total}catch(e){console.log(e)}finally{a.value=!1}},v=async()=>{try{const t=await L();if(!(t instanceof Blob))throw new Error("Respuesta inválida del servidor con el BLOB");const e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=window.URL.createObjectURL(e),r=document.createElement("a");r.href=o,r.setAttribute("download","cotizaciones.xlsx"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(o),document.body.removeChild(r)}catch(t){console.error("Error en exportación:",t)}};return{changeStatusQuotes:g,changeStatusQuotesCustomer:y,getQuotebyId:p,loadingQuote:a,quote:s,quotes:d(()=>l.value),totalQuotes:d(()=>u.value),generateQuote:m,allQuotePaginate:f,exportQuoteExcel:v}}export{B as u};
