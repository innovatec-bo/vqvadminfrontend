import{$ as n}from"./api-40e7a553.js";import{b as m,c as w}from"./notifications-b6da0b75.js";import{r as a,k as C,a2 as p}from"./index-eea64eab.js";const E=async t=>await n("/customer/register/prospect",{method:"POST",body:t}),x=async t=>await n(`/customer/perfil/${t}`,{method:"GET"}),d=async t=>await n("customer/list-paginated",{method:"GET",params:t}),P=async()=>await n("/export/customer",{method:"GET",responseType:"blob"});function k(){const t=a(!1),c=a(null),l=a(null),i=a([]),u=a(0),f=C(),y=async o=>{if(!o.name||!o.phone){m("Falta Informacion","El nombre y el celular son obligatorios");return}t.value=!0,c.value=null;try{const e={name:o.name,phone:o.phone,email:o.email,ci:o.ci,type_customer:o.type_customer,cod_phone:o.countryCode.replace(/\+/g,""),description:o.description};console.log(e);const s=await E(e);console.log("Respuesta del servidor:",s),w("Cliente agregado exitosamente","El cliente ha sido registrado en el sistema correctamente."),l.value=s.data,f.push("/customers/listCustomers")}catch(e){console.log(e),e.response&&e.response.status==422&&m("Falta Informacion","El nombre y el celular son obligatorios"),e.response&&e.response.status==409&&m("Advertencia",e.response._data.message),c.value=e.message}finally{t.value=!1}},h=async o=>{try{const e=await d(o);console.log(e),i.value=e.data.data,u.value=e.data.total}catch(e){console.log(e)}},g=async o=>{try{t.value=!0;const e=await x(o);l.value=e.data}catch(e){console.error(e)}finally{t.value=!1}},v=async()=>{try{const o=await P();if(!(o instanceof Blob))throw new Error("Respuesta inválida del servidor con el BLOB");const e=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.setAttribute("download","clientes.xlsx"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),document.body.removeChild(r)}catch(o){console.error("Error en exportación:",o)}},b=async o=>{t.value=!0;try{const e=await d({search:o,page:1,itemsPerPage:10});i.value=e.data.data,u.value=e.data.total}catch(e){console.error("Error en búsqueda de clientes:",e)}finally{t.value=!1}};return{loading:t,error:c,customer:l,customers:p(()=>i.value),totalCustomers:p(()=>u.value),addCustomer:y,allCustomerPaginate:h,getPerfilCutomerbyId:g,exportCustomerExcel:v,searchCustomers:b}}export{k as u};
