import{$ as y}from"./api-82cd37b3.js";import{c as w,a as V,b}from"./notifications-e0287a8c.js";import{r,k as C,a2 as x,H as B,w as T,o as d,c as P,b as m,e as u,d as p,F as k,i as F,n as f,f as _,x as g,v as $,z as v}from"./index-00f4ab0f.js";import{f as S}from"./formatters-b3558c7d.js";import{V as N}from"./VCardText-f7de957d.js";import{V as O}from"./VRow-a69cdb9a.js";import{V as z}from"./VCol-dc58c310.js";import{V as A,a as E}from"./VTimelineItem-dc1e9f9b.js";import{V as H}from"./VChip-f8e11da3.js";import{V as I}from"./VCard-643c730e.js";const D=async(e,a)=>await y(`/opportunity/${e}/stage/${a}`,{method:"GET"}),L=async(e,a,o)=>await y(`/opportunity/${e}/procedure/${a}`,{method:"PATCH",body:o});function ce(){const e=r(null),a=r(!1),o=r(!1),c=r([]);return{process:e,loadingProcess:a,errorProcess:o,processes:c,allProcessesOpportunityForStage:async(n,t)=>{try{const s=await D(n,t);c.value=s.data}catch(s){console.log(s)}},checkProcessForOpportunity:async(n,t,s)=>{try{console.log(s);const h=await L(n,t,s);w("¡Proceso completado exitosamente!","El proceso ha sido llevado a cabo sin inconvenientes. ")}catch(h){console.log(h)}}}}const j=async e=>await y(`/sale/paymentPlans/${e}/confirm`,{method:"PATCH"}),G=async(e,a)=>await y(`/sale/paymentPlans/${e}`,{method:"PATCH",body:a});function ie(){const e=r(!1),a=r([]),o=r(null),c=r(null);return{loadingPaymentPlans:e,paymentPlan:c,error:o,paymentPlans:a,confirmPaymentPlans:async n=>{try{const t=await j(n);w("Actualizacion Exitosa","Se confirmo el pago")}catch(t){console.log(t)}},updatePaymentPlans:async(n,t)=>{e.value=!0,o.value=null;try{console.log(t);const s=await G(n,t);c.value=s.data,V("¡Planes de pago actualizados exitosamente! ","Los planes de pago han sido modificados y guardados correctamente."),console.log(s)}catch(s){console.log(s),s.response&&s.response.status==422&&b("Advertencia","Faltan datos por Completar"),o.value=s.message}finally{e.value=!1}}}}const R=async e=>await y(`/customer/${e}/bitacora`,{method:"GET"});function q(){const e=r(!1),a=r([]);return C(),r(0),{getBitacorabyId:async c=>{try{const l=await R(c);a.value=l,console.log(l)}catch(l){console.error(l)}},loadingBitacora:e,bitacoras:x(()=>a.value)}}const M={class:"my-5"},W={class:"d-flex justify-space-between align-center gap-2 flex-wrap"},J={class:"app-timeline-title"},K={class:"app-timeline-meta"},Q={class:"app-timeline-text"},U={key:0,class:"empty-state my-2"},le={__name:"BitacoraCustomer",props:{customer:{type:String,required:!0}},setup(e){const a=e,{bitacoras:o,getBitacorabyId:c}=q();B(async()=>{await c(a.customer)}),T(()=>a.customer,async(i,n)=>{i&&(console.log("Customer actualizado:",i),await c(i))},{immediate:!0});const l=i=>{switch(i){case 1:return"Visita";case 2:return"Llamada";case 3:return"Cotización";default:return"Otro"}};return(i,n)=>(d(),P("div",null,[m(I,{title:"Historial del cliente"},{default:u(()=>[m(N,null,{default:u(()=>[m(O,{class:"d-flex justify-space-between"},{default:u(()=>[m(z,{cols:"12"},{default:u(()=>[p("div",M,[m(A,{side:"end",align:"start","line-inset":"8","truncate-line":"both",density:"compact"},{default:u(()=>[(d(!0),P(k,null,F(f(o),t=>(d(),_(E,{key:t.id,size:"x-small","dot-color":"warning"},{default:u(()=>[p("div",W,[p("span",J,g(t.log_name),1),p("span",K,g(("formatDate"in i?i.formatDate:f(S))(t.created_at)),1)]),p("div",Q,[p("p",null,g(t.description),1),t.properties.activity?(d(),_(H,{key:0},{default:u(()=>[$(g(l(t.properties.activity.type_activity_id)),1)]),_:2},1024)):v("",!0)])]),_:2},1024))),128))]),_:1}),!f(o)||f(o).length===0?(d(),P("div",U,n[0]||(n[0]=[p("p",null,"No hay actividades registradas para este cliente.",-1)]))):v("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{le as _,ie as a,ce as u};
