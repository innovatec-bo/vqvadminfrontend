import{_ as E}from"./AppTextField-bc3597c6.js";import{_ as A}from"./DialogCloseBtn-bca8d862.js";import{r as c,am as v,w as B,o as C,f as h,e as t,b as a,v as b,a3 as S,n as s,z as I,a0 as P,a4 as x}from"./index-e0f854fb.js";import{$ as w}from"./api-7e421e3b.js";import{a as $,s as j,e as N}from"./notifications-cae4d01c.js";import{V as R,a as z,b as k}from"./VCard-18f293ae.js";import{V as O}from"./VCardText-7683b789.js";import{V as G}from"./VForm-88e0c39e.js";import{V as T}from"./VRow-6bb6adbe.js";import{V as f}from"./VCol-ba474af9.js";import{V as q}from"./VImg-06c338d7.js";import{V as L}from"./VFileInput-cb11468c.js";import{V as M}from"./VDialog-1653676d.js";const H=async u=>await w("/users",{method:"GET",body:u}),J=async u=>{for(let V of u.entries())console.log(V[0]+": "+V[1]);return await w("/users/update_profile",{method:"POST",body:u})},W=async u=>await w(`/users/${u}`,{method:"GET"});function K(){const u=c(null),V=c([]),i=c(null),r=c(!1),g=c(null);return{allSellerUsers:async()=>{r.value=!0;try{const e=await H();V.value=e.data,i.value=e.total}catch(e){console.error(e),e.value=e.message}finally{r.value=!1}},updateProfile:async e=>{r.value=!0,g.value=null;try{const m=await J(e);return $("¡El perfil ha sido actualizado exitosamente!","Los detalles del perfil han sido editados y guardados correctamente."),{success:!0,message:"Actualización Exitosa"}}catch(m){return m.response&&m.response.status===422?(j("Validación fallida","Faltan datos por rellenar"),{success:!1,message:"Validación fallida"}):(N("Advertencia","Hubo un problema al actualizar los datos del perfil."),{success:!1,message:"Error de actualización"})}finally{r.value=!1}},getById:async e=>{try{const m=await W(e);u.value=m.data}catch(m){console.log(m)}},user:u,users:V,totalUsers:i,loading:r,error:g}}const de={__name:"UserInfoEditDialog",props:{userData:{type:Object,required:!1,default:()=>({id:0,fullName:"",email:"",avatar:""})},isDialogVisible:{type:Boolean,required:!0}},emits:["submit","update:isDialogVisible"],setup(u,{emit:V}){const i=u,r=c([]),g=c(i.userData.avatar.sm),_=o=>{if(!o||o.length===0)return;const l=o[0],p=new FileReader;p.onload=()=>{g.value=p.result},p.readAsDataURL(l)},y=V,{updateProfile:U}=K(),e=c(structuredClone(v(i.userData)));c(!1),B(i,()=>{e.value=structuredClone(v(i.userData))});const m=async()=>{const o=new FormData;o.append("_method","PUT"),Object.entries(e.value).forEach(([p,d])=>{d!==null&&typeof d=="object"&&!(d instanceof File)?o.append(p,JSON.stringify(d)):o.append(p,d)}),r.value&&r.value.length>0&&o.append("image",r.value[0]),(await U(o)).success&&(y("profileUpdated",e.value),y("update:isDialogVisible",!1))},F=()=>{e.value=structuredClone(v(i.userData)),y("update:isDialogVisible",!1)},D=o=>{y("update:isDialogVisible",o)};return(o,l)=>{const p=A,d=E;return C(),h(M,{width:o.$vuetify.display.smAndDown?"auto":677,"model-value":i.isDialogVisible,"onUpdate:modelValue":D},{default:t(()=>[a(p,{onClick:l[0]||(l[0]=n=>D(!1))}),a(R,{class:"pa-sm-8 pa-5"},{default:t(()=>[a(z,{class:"text-center"},{default:t(()=>[a(k,{class:"text-h3 mb-3"},{default:t(()=>l[7]||(l[7]=[b(" Editar información del usuario ")])),_:1})]),_:1}),a(O,null,{default:t(()=>[a(G,{ref:"refForm",class:"mt-6",onSubmit:S(m,["prevent"])},{default:t(()=>[a(T,{class:"justify-center"},{default:t(()=>[a(f,{cols:"12",class:"text-center"},{default:t(()=>[s(g)?(C(),h(q,{key:0,src:s(g),class:"mt-4 mx-auto","max-width":"150"},null,8,["src"])):I("",!0)]),_:1}),a(f,{cols:"12",md:"6"},{default:t(()=>[a(L,{label:"Seleccionar foto de perfil",accept:"image/*","prepend-icon":"ti ti-camera",multiple:!1,modelValue:s(r),"onUpdate:modelValue":[l[1]||(l[1]=n=>P(r)?r.value=n:null),_]},null,8,["modelValue"])]),_:1})]),_:1}),a(T,null,{default:t(()=>[a(f,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:s(e).name,"onUpdate:modelValue":l[2]||(l[2]=n=>s(e).name=n),label:"Nombre",placeholder:""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:s(e).last_name,"onUpdate:modelValue":l[3]||(l[3]=n=>s(e).last_name=n),label:"Apellido",placeholder:""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:s(e).email,"onUpdate:modelValue":l[4]||(l[4]=n=>s(e).email=n),label:"Email",readonly:!0,placeholder:"johndoe@email.com"},null,8,["modelValue"])]),_:1}),a(f,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:s(e).cod_phone,"onUpdate:modelValue":l[5]||(l[5]=n=>s(e).cod_phone=n),label:"Cod. Teléfono",placeholder:""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:s(e).phone,"onUpdate:modelValue":l[6]||(l[6]=n=>s(e).phone=n),label:"Teléfono",placeholder:""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[a(x,{type:"submit"},{default:t(()=>l[8]||(l[8]=[b(" Guardar ")])),_:1}),a(x,{color:"secondary",variant:"tonal",onClick:F},{default:t(()=>l[9]||(l[9]=[b(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};export{de as _,K as u};
