import{_ as D}from"./AppTextField-935152ba.js";import{_ as h}from"./DialogCloseBtn-819078ea.js";import{r as m,am as y,w as C,o as T,f as x,e as o,b as e,v as g,a3 as E,n as d,a4 as w}from"./index-29b7cc60.js";import{$ as b}from"./api-d30cbc93.js";import{a as B,s as P,e as $}from"./notifications-cae4d01c.js";import{V as I,a as k,b as A}from"./VCard-bf13d430.js";import{V as S}from"./VCardText-39037d93.js";import{V as j}from"./VForm-c5c832c7.js";import{V as z}from"./VRow-e48c256c.js";import{V as c}from"./VCol-d1606abf.js";import{V as N}from"./VDialog-f47f8ae9.js";const F=async r=>await b("/users",{method:"GET",body:r}),G=async r=>await b("/users/update_profile",{method:"PUT",body:r}),R=async r=>await b(`/users/${r}`,{method:"GET"});function q(){const r=m(null),f=m([]),i=m(null),n=m(!1),V=m(null);return{allSellerUsers:async()=>{n.value=!0;try{const l=await F();f.value=l.data,i.value=l.total}catch(l){console.error(l),l.value=l.message}finally{n.value=!1}},updateProfile:async l=>{n.value=!0,V.value=null;try{const t={_method:"PUT",name:l.name,last_name:l.last_name,cod_phone:l.cod_phone,phone:l.status},a=await G(t);return B("¡El perfil ha sido actualizado exitosamente!","Los detalles del perfil han sido editados y guardados correctamente."),{success:!0,message:"Actualización Exitosa"}}catch(t){return t.response&&t.response.status==422?(P("Validación fallida","Faltan datos por rellenar"),{success:!1,message:"Validación fallida"}):($("Advertencia","Hubo un problema al actualizar los datos del perfil."),{success:!1,message:"Error de actualización"})}finally{n.value=!1}},getById:async l=>{try{const t=await R(l);r.value=t.data}catch(t){console.log(t)}},user:r,users:f,totalUsers:i,loading:n,error:V}}const ee={__name:"UserInfoEditDialog",props:{userData:{type:Object,required:!1,default:()=>({id:0,fullName:"",company:"",role:"",username:"",country:"",contact:"",email:"",currentPlan:"",status:"",avatar:"",taskDone:null,projectDone:null,taxId:"",language:""})},isDialogVisible:{type:Boolean,required:!0}},emits:["submit","update:isDialogVisible"],setup(r,{emit:f}){const i=r,n=f,{updateProfile:V}=q(),s=m(structuredClone(y(i.userData)));m(!1),C(i,()=>{s.value=structuredClone(y(i.userData))});const _=async()=>{(await V(s.value)).success&&n("profileUpdated",s.value),n("update:isDialogVisible",!1)},v=()=>{s.value=structuredClone(y(i.userData)),n("update:isDialogVisible",!1)},l=t=>{n("update:isDialogVisible",t)};return(t,a)=>{const U=h,p=D;return T(),x(N,{width:t.$vuetify.display.smAndDown?"auto":677,"model-value":i.isDialogVisible,"onUpdate:modelValue":l},{default:o(()=>[e(U,{onClick:a[0]||(a[0]=u=>l(!1))}),e(I,{class:"pa-sm-8 pa-5"},{default:o(()=>[e(k,{class:"text-center"},{default:o(()=>[e(A,{class:"text-h3 mb-3"},{default:o(()=>a[6]||(a[6]=[g(" Editar información del usuario ")])),_:1})]),_:1}),e(S,null,{default:o(()=>[e(j,{ref:"refForm",class:"mt-6",onSubmit:E(_,["prevent"])},{default:o(()=>[e(z,null,{default:o(()=>[e(c,{cols:"12",md:"6"},{default:o(()=>[e(p,{modelValue:d(s).name,"onUpdate:modelValue":a[1]||(a[1]=u=>d(s).name=u),label:"Nombre",placeholder:""},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",md:"6"},{default:o(()=>[e(p,{modelValue:d(s).last_name,"onUpdate:modelValue":a[2]||(a[2]=u=>d(s).last_name=u),label:"Apellido",placeholder:""},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",md:"6"},{default:o(()=>[e(p,{modelValue:d(s).email,"onUpdate:modelValue":a[3]||(a[3]=u=>d(s).email=u),label:"Email",readonly:!0,placeholder:"johndoe@email.com"},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",md:"6"},{default:o(()=>[e(p,{modelValue:d(s).cod_phone,"onUpdate:modelValue":a[4]||(a[4]=u=>d(s).cod_phone=u),label:"Cod. Teléfono",placeholder:""},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",md:"6"},{default:o(()=>[e(p,{modelValue:d(s).phone,"onUpdate:modelValue":a[5]||(a[5]=u=>d(s).phone=u),label:"Teléfono",placeholder:""},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:o(()=>[e(w,{type:"submit"},{default:o(()=>a[7]||(a[7]=[g(" Guardar ")])),_:1}),e(w,{color:"secondary",variant:"tonal",onClick:v},{default:o(()=>a[8]||(a[8]=[g(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};export{ee as _,q as u};
