import{u as ye}from"./useActivity-cf8d1ced.js";import{r as N,e as Ae}from"./validators-dea6e3a5.js";import{_ as fe}from"./AppTextarea-26e339c9.js";import{_ as he}from"./AppDateTimePicker-9c79ccfd.js";import{_ as se}from"./AppTextField-0379a0cb.js";import{_ as ne}from"./AppSelect-4aa5fdb1.js";import{u as Z,p as ve,S as ge,_ as Se}from"./PreSaleForm-69864fc8.js";import{$ as X}from"./api-244ee7c5.js";import{s as ee,a as Oe}from"./notifications-5942749b.js";import{r as b,o as u,c as _,d as l,F as j,i as L,b as e,e as t,n as i,v as $,x,z as M,f as F,$ as H,a4 as T,w as le,a3 as _e,a as re,a0 as q,am as G,an as ce,ac as ze,H as Ue}from"./index-c350574b.js";import{V as be}from"./VAvatar-d994a10c.js";import{b as W,c as J,a as ae}from"./VList-cfc7de26.js";import{a as f,V as R}from"./VRow-71717c62.js";import{V as K}from"./VChip-92806f30.js";import{V as B}from"./VCardText-300a3d28.js";import{a as Ve}from"./formatters-b3558c7d.js";import{_ as qe}from"./AppAutocomplete-fc6b82e6.js";import{_ as ue}from"./DialogCloseBtn-ae1d96f1.js";import{u as Fe}from"./useProperty-b2942811.js";import{V as Q,b as we}from"./VCard-b3af87fc.js";import{V as xe}from"./VForm-25813f48.js";import{V as de}from"./VDialog-cf0ca8b7.js";import{V as ie}from"./VCheckbox-70598518.js";import{V as te}from"./VTable-6eef0871.js";import{V as Y}from"./VTextField-1a13059f.js";import{_ as ke}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as Te}from"./AppDrawerHeaderSection-7106fddb.js";import{P as Ee}from"./vue3-perfect-scrollbar.esm-5f69d5a1.js";import{V as je}from"./VNavigationDrawer-c17038dc.js";import{V as De,a as Ie}from"./VWindowItem-ae1238c3.js";import{V as Ne,a as me}from"./VRadioGroup-c347684b.js";import{V as Re}from"./VDivider-fcbd1d2a.js";import{V as Le,a as Be}from"./VTabs-915aa110.js";import{V as Me}from"./VOverlay-8eb0def9.js";import"./helpers-61e4df1a.js";import"./form-abb5c414.js";/* empty css                   */import"./VCounter-70c3a3c5.js";import"./VImg-f93d845c.js";import"./VField-e39c0f7e.js";import"./easing-9f15041e.js";import"./VInput-49b5f2d6.js";import"./forwardRefs-8348545e.js";import"./VSelect-4c757acd.js";import"./dialog-transition-24fb640a.js";import"./VMenu-83705cd4.js";import"./scopeId-a4aedccb.js";import"./VCheckboxBtn-b29ccf31.js";import"./VSelectionControl-a939c0f8.js";import"./InvoiceAddProperty-5fdc4f01.js";import"./VNodeRenderer-3f9c8246.js";import"./index-9c720871.js";import"./constants-8e30317b.js";import"./ssrBoot-8aa5c650.js";import"./filter-f3a70448.js";import"./VSpacer-f539aa0e.js";import"./lazy-d5590789.js";import"./VSlideGroup-b1466b49.js";const He=async(V,k)=>await X(`/opportunity/${V}/stage/${k}`,{method:"GET"}),Qe=async(V,k,o)=>await X(`/opportunity/${V}/procedure/${k}`,{method:"PATCH",body:o});function oe(){const V=b(null),k=b(!1),o=b(!1),v=b([]);return{process:V,loadingProcess:k,errorProcess:o,processes:v,allProcessesOpportunityForStage:async(r,n)=>{try{const m=await He(r,n);v.value=m.data}catch(m){console.log(m)}},checkProcessForOpportunity:async(r,n,m)=>{try{console.log(m);const w=await Qe(r,n,m);ee("Marcado Exitoso","Se Actualizo el estado del proceso")}catch(w){console.log(w)}}}}const Ge={class:"mb-5"},Ke={key:0},We=["src"],Je={class:"my-5"},Xe={key:0,class:"d-flex flex-wrap gap-2 my-5"},Ze={key:1},Ye={__name:"EditDeliveryOpportunity",props:{opportunity:{type:Object,required:!0}},emits:["updateStageId","complet"],setup(V,{emit:k}){const o=V,v=k,{changeStatusByOpportunity:z}=Z(),{checkProcessForOpportunity:P}=oe(),r=async()=>{try{await z(o.opportunity.id,7,{}),v("complet")}catch(m){console.error("Error updating customer:",m)}},n=async(m,w)=>{console.log(`Procedimiento ${m} marcado como: ${w?"realizado":"no realizado"}`),await P(o.opportunity.id,m,{is_check:!w}),v("updateStageId",o.opportunity.id)};return(m,w)=>(u(),_(j,null,[l("div",Ge,[w[0]||(w[0]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Propiedades ",-1)),o.opportunity.sales.properties&&o.opportunity.sales.properties.length>0?(u(),_("div",Ke,[(u(!0),_(j,null,L(o.opportunity.sales.properties,y=>(u(),_("div",{key:y.id,class:"d-flex align-center justify-between"},[e(be,{size:"50",rounded:""},{default:t(()=>[l("img",{src:i(ve),alt:"Logo pora",style:{"border-radius":"30%"}},null,8,We)]),_:1}),e(f,{cols:"12",md:"7"},{default:t(()=>[e(W,{class:"font-weight-medium"},{default:t(()=>[$(x(y.project_title)+" | "+x(y.title),1)]),_:2},1024),e(J,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",null,"$ "+x(y.pivot_price),1)]),_:2},1024)]),_:2},1024)]))),128))])):M("",!0)]),l("div",Je,[w[2]||(w[2]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Procesos ",-1)),o.opportunity.procedure&&o.opportunity.procedure.length>0?(u(),_("div",Xe,[(u(!0),_(j,null,L(o.opportunity.procedure,y=>(u(),_("div",{key:y.id},[e(K,{color:y.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:A=>n(y.id,y.pivot.is_check)},{default:t(()=>[y.pivot.is_check?(u(),F(H,{key:0,icon:"tabler-check",class:"mr-2"})):M("",!0),$(" "+x(y.title),1)]),_:2},1032,["color","onClick"])]))),128))])):(u(),_("div",Ze,w[1]||(w[1]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),e(B,{class:"d-flex justify-center mt-4"},{default:t(()=>[e(T,{color:"primary",size:"small",onClick:r},{default:t(()=>w[3]||(w[3]=[$(" Finalizar Oportunidad ")])),_:1})]),_:1})],64))}},et=async V=>await X("/quote/register",{method:"POST",body:V}),tt=async(V,k)=>await X(`/quote/${V}/change_status`,{method:"PATCH",body:k});function lt(){const V=b(!1),k=b(null),o=b([]);return{changeStatusQuotes:async(P,r)=>{V.value=!0;try{const n=await tt(P,r);k.value=n.data,console.log(n),ee("ACTUALIZACION EXITOSA","Cotizacion Actualizada")}catch(n){console.log(n)}finally{V.value=!1}},loadingQuote:V,quote:k,quotes:o,generateQuote:async P=>{V.value=!0;try{const r=await et(P);console.log(r),k.value=r.data}catch(r){console.error(r)}finally{V.value=!1}}}}const Pe={__name:"EditCustomerDialog",props:{isDialogVisible:{type:Boolean,required:!0},opportunityKanban:{type:Object,required:!0}},emits:["update:isDialogVisible"],setup(V,{emit:k}){const o=V,v=k;Object.values(ge).map(a=>({title:a.label,value:a.value}));const{allProperty:z,properties:P}=Fe(),{getOpportunitybyId:r,opportunity:n,changeOpportunity:m,loadingOpportunity:w}=Z(),y=()=>{v("update:isDialogVisible",!1)},A=async()=>{console.log("antes del save:",n);const a={id:n.value.id,description:n.value.description,property_id:n.value.property_id,customer:{id:n.value.customer.id,name:n.value.customer.name,email:n.value.customer.email,ci:n.value.customer.ci,cod_phone:n.value.cod_phone,phone:n.value.customer.phone}};await m(n.value.id,a),v("update:isDialogVisible",!1)},p=async()=>{var a;(a=o.opportunityKanban)!=null&&a.id&&await r(o.opportunityKanban.id)},g=async()=>{await z({page:1,itemsPerPage:100})};return le(()=>o.isDialogVisible,async a=>{a===!0&&(p(),await g())}),(a,d)=>{const s=ue,U=se,D=ne,C=qe,E=fe;return u(),F(de,{"max-width":"800","model-value":o.isDialogVisible,persistent:"","close-on-esc":!1,"onUpdate:modelValue":y},{default:t(()=>[e(s,{onClick:y}),e(Q,{title:"Información del Cliente y Oportunidad",class:"pa-sm-8 pa-5"},{default:t(()=>[e(B,null,{default:t(()=>[e(xe,{onSubmit:_e(A,["prevent"])},{default:t(()=>[e(R,{dense:""},{default:t(()=>[e(f,{cols:"12",md:"6"},{default:t(()=>[e(U,{modelValue:i(n).customer.name,"onUpdate:modelValue":d[0]||(d[0]=c=>i(n).customer.name=c),label:"Nombre del Cliente",placeholder:"Ingresa el nombre",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(U,{modelValue:i(n).customer.email,"onUpdate:modelValue":d[1]||(d[1]=c=>i(n).customer.email=c),label:"Email del Cliente",placeholder:"Ingresa el email",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(R,null,{default:t(()=>[e(f,{cols:"4"},{default:t(()=>[e(D,{modelValue:i(n).customer.cod_phone,"onUpdate:modelValue":d[2]||(d[2]=c=>i(n).customer.cod_phone=c),label:"Código",items:["+591","+1","+52"],placeholder:"Cód.",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"8"},{default:t(()=>[e(U,{modelValue:i(n).customer.phone,"onUpdate:modelValue":d[3]||(d[3]=c=>i(n).customer.phone=c),label:"Número de Teléfono",placeholder:"Ingresa el teléfono",outlined:"",dense:"",maxlength:"9"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(U,{modelValue:i(n).customer.ci,"onUpdate:modelValue":d[4]||(d[4]=c=>i(n).customer.ci=c),label:"CI del Cliente",placeholder:"Ingresa el CI",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(C,{modelValue:i(n).property_id,"onUpdate:modelValue":d[5]||(d[5]=c=>i(n).property_id=c),label:"Departamento de Interés",placeholder:"Selecciona un Departamento",items:i(P).map(c=>({title:c.title,value:c.id})),outlined:""},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(E,{modelValue:i(n).description,"onUpdate:modelValue":d[6]||(d[6]=c=>i(n).description=c),label:"Descripción de la Oportunidad",placeholder:"Ingresa una descripción",rows:"3","auto-grow":"",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",class:"text-center"},{default:t(()=>[e(T,{type:"submit",color:"primary",class:"me-3",disabled:i(w),loading:i(w)},{default:t(()=>d[7]||(d[7]=[$(" Guardar ")])),_:1},8,["disabled","loading"]),e(T,{color:"secondary",variant:"tonal",onClick:y},{default:t(()=>d[8]||(d[8]=[$(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},ot={class:"d-flex align-bottom flex-sm-row flex-column"},at={class:"user-profile-info"},it={class:"d-flex align-center justify-center justify-sm-space-between flex-wrap gap-4"},st={class:"d-flex align-center gap-x-3"},nt={class:"text-4xl font-weight-medium"},rt={class:"d-flex flex-column py-2",style:{"font-size":"14px"}},ut={class:"text-sm text-disabled"},dt={key:0,class:"d-flex flex-wrap gap-2 my-5"},pt={key:1},ct={key:0,class:"d-flex flex-wrap gap-2 my-5"},mt={key:1},yt={__name:"EditPreSaleOpportunity",props:{opportunity:{type:Object,required:!0}},emits:["updateStageId"],setup(V,{emit:k}){const o=V,v=k,{checkProcessForOpportunity:z}=oe(),{changeStatusQuotes:P}=lt(),r=b(!1),n=b(!1),m=()=>{r.value=!0},w=()=>{n.value=!0},y=async g=>{v("updateStageId",g)},A=async(g,a)=>{console.log(`Procedimiento ${g} marcado como: ${a?"realizado":"no realizado"}`),await z(o.opportunity.id,g,{is_check:!a}),v("updateStageId",o.opportunity.id)},p=async(g,a)=>{const d=a==="APPROVED"?"NOT_APPROVED":"APPROVED";console.log(`Procedimiento ${g} marcado como: ${a}`),await P(g,{status:d}),v("updateStageId",o.opportunity.id)};return(g,a)=>{const d=re("RouterLink");return u(),_(j,null,[l("div",ot,[l("div",at,[a[3]||(a[3]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Perfil ",-1)),l("div",it,[l("div",st,[l("span",nt,x(("avatarText"in g?g.avatarText:i(Ve))(o.opportunity.customer.name)),1),l("div",rt,[e(d,{to:{name:"apps-ecommerce-customer-details-id",params:{id:1}},class:"font-weight-base"},{default:t(()=>[$(x(o.opportunity.customer.name),1)]),_:1}),l("span",ut,x(o.opportunity.customer.phone),1)]),e(T,{color:"secondary",variant:"tonal",size:"small",onClick:m},{default:t(()=>a[2]||(a[2]=[$(" Editar Perfil ")])),_:1})])])])]),l("div",null,[a[5]||(a[5]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Procesos ",-1)),o.opportunity.procedure&&o.opportunity.procedure.length>0?(u(),_("div",dt,[(u(!0),_(j,null,L(o.opportunity.procedure,s=>(u(),_("div",{key:s.id},[e(K,{color:s.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:U=>A(s.id,s.pivot.is_check)},{default:t(()=>[s.pivot.is_check?(u(),F(H,{key:0,icon:"tabler-check",class:"mr-2"})):M("",!0),$(" "+x(s.title),1)]),_:2},1032,["color","onClick"])]))),128))])):(u(),_("div",pt,a[4]||(a[4]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),l("div",null,[a[8]||(a[8]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Cotizaciones ",-1)),o.opportunity.quotes&&o.opportunity.quotes.length>0?(u(),_("div",ct,[e(te,{density:"compact",class:"text-no-wrap",style:{"font-size":"12px"}},{default:t(()=>[a[6]||(a[6]=l("thead",null,[l("tr",null,[l("th",null," Nombre "),l("th",null," Fecha "),l("th",null," Monto "),l("th")])],-1)),l("tbody",null,[(u(!0),_(j,null,L(o.opportunity.quotes,s=>(u(),_("tr",{key:s.id},[l("td",null,x(s.social_reason),1),l("td",null,x(new Date(s.created_at).toLocaleDateString()),1),l("td",null,x(s.amount),1),l("td",null,[e(R,null,{default:t(()=>[e(ie,{modelValue:s.status,"onUpdate:modelValue":U=>s.status=U,"true-value":"APPROVED","false-value":"NOT_APPROVED",onClick:U=>p(s.id,s.status)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024)])]))),128))])]),_:1})])):(u(),_("div",mt,a[7]||(a[7]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),e(B,{class:"d-flex justify-center mt-4"},{default:t(()=>[e(T,{color:"primary",class:"mx-1",variant:"tonal",size:"small",onClick:g.generateQuote},{default:t(()=>a[9]||(a[9]=[$(" Agregar Cotizacion ")])),_:1},8,["onClick"]),e(T,{color:"primary",class:"mx-auto",size:"small",onClick:w},{default:t(()=>a[10]||(a[10]=[$(" Generar Venta ")])),_:1})]),_:1}),e(Pe,{"is-dialog-visible":i(r),"onUpdate:isDialogVisible":a[0]||(a[0]=s=>q(r)?r.value=s:null),"opportunity-kanban":o.opportunity},null,8,["is-dialog-visible","opportunity-kanban"]),e(Se,{"is-dialog-visible":i(n),"onUpdate:isDialogVisible":a[1]||(a[1]=s=>q(n)?n.value=s:null),opportunity:o.opportunity,onRegisterSale:y},null,8,["is-dialog-visible","opportunity"])],64)}}},ft={class:"d-flex align-bottom flex-sm-row flex-column"},vt={class:"user-profile-info"},gt={class:"d-flex align-center justify-center justify-sm-space-between flex-wrap gap-4"},_t={class:"d-flex align-center gap-x-3"},bt={class:"text-4xl font-weight-medium"},Vt={class:"d-flex flex-column py-2",style:{"font-size":"14px"}},wt={class:"text-sm text-disabled"},xt={key:0,class:"d-flex flex-wrap gap-2 my-5"},kt={key:1},Dt={key:0,class:"d-flex flex-wrap gap-2 my-5"},Pt={key:1},Ct={__name:"EditProspectOpportunity",props:{opportunity:{type:Object,required:!0}},emits:["updateStageId"],setup(V,{emit:k}){const o=V,v=k,{checkProcessForOpportunity:z}=oe(),{changeStatusByOpportunity:P,loadingOpportunity:r}=Z(),n=b(!1),m=()=>{n.value=!0},w=async A=>{P(A,ge.PRESALE.value,{}),v("updateStageId",A)},y=(A,p)=>{console.log(`Procedimiento ${A} marcado como: ${p?"realizado":"no realizado"}`),z(o.opportunity.id,A,{is_check:!p}),v("updateStageId",o.opportunity.id)};return(A,p)=>{const g=re("RouterLink");return u(),_(j,null,[l("div",ft,[l("div",vt,[p[3]||(p[3]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Perfil ",-1)),l("div",gt,[l("div",_t,[l("span",bt,x(("avatarText"in A?A.avatarText:i(Ve))(o.opportunity.customer.name)),1),l("div",Vt,[e(g,{to:{name:"apps-ecommerce-customer-details-id",params:{id:1}},class:"font-weight-base"},{default:t(()=>[$(x(o.opportunity.customer.name),1)]),_:1}),l("span",wt,x(o.opportunity.customer.phone),1)]),l("div",null,[e(T,{color:"secondary",variant:"tonal",size:"small",onClick:m},{default:t(()=>p[2]||(p[2]=[$(" Editar Perfil ")])),_:1})])])])])]),l("div",null,[p[5]||(p[5]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Procesos ",-1)),o.opportunity.procedure&&o.opportunity.procedure.length>0?(u(),_("div",xt,[(u(!0),_(j,null,L(o.opportunity.procedure,a=>(u(),_("div",{key:a.id},[e(K,{color:a.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:d=>y(a.id,a.pivot.is_check)},{default:t(()=>[a.pivot.is_check?(u(),F(H,{key:0,icon:"tabler-check",class:"mr-2"})):M("",!0),$(" "+x(a.title),1)]),_:2},1032,["color","onClick"])]))),128))])):(u(),_("div",kt,p[4]||(p[4]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),l("div",null,[p[8]||(p[8]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Cotizaciones ",-1)),o.opportunity.quotes&&o.opportunity.quotes.length>0?(u(),_("div",Dt,[e(te,{density:"compact",class:"text-no-wrap",style:{"font-size":"12px"}},{default:t(()=>[p[6]||(p[6]=l("thead",null,[l("tr",null,[l("th",null," Nombre "),l("th",null," Fecha "),l("th",null," Monto "),l("th")])],-1)),l("tbody",null,[(u(!0),_(j,null,L(o.opportunity.quotes,a=>(u(),_("tr",{key:a.id},[l("td",null,x(a.social_reason),1),l("td",null,x(new Date(a.created_at).toLocaleDateString()),1),l("td",null,x(a.amount),1),l("td",null,[e(H,{icon:"tabler-eye"})])]))),128))])]),_:1})])):(u(),_("div",Pt,p[7]||(p[7]=[l("span",null,"No hay cotizaciones disponibles.",-1)])))]),e(B,{class:"d-flex justify-center mt-4"},{default:t(()=>[e(T,{color:"primary",class:"mx-1",variant:"tonal",size:"small",onClick:A.generateQuote},{default:t(()=>p[9]||(p[9]=[$(" Generar Cotización ")])),_:1},8,["onClick"]),e(T,{color:"primary",class:"mx-auto",size:"small",disabled:i(r),loading:i(r),onClick:p[0]||(p[0]=a=>w(o.opportunity.id))},{default:t(()=>p[10]||(p[10]=[$(" Siguiente Etapa ")])),_:1},8,["disabled","loading"])]),_:1}),e(Pe,{"is-dialog-visible":i(n),"onUpdate:isDialogVisible":p[1]||(p[1]=a=>q(n)?n.value=a:null),"opportunity-kanban":o.opportunity},null,8,["is-dialog-visible","opportunity-kanban"])],64)}}},$t=async V=>await X(`/sale/paymentPlans/${V}/confirm`,{method:"PATCH"}),At=async(V,k)=>await X(`/sale/paymentPlans/${V}`,{method:"PATCH",body:k});function Ce(){const V=b(!1),k=b([]),o=b(null),v=b(null);return{loadingPaymentPlans:V,paymentPlan:v,error:o,paymentPlans:k,confirmPaymentPlans:async r=>{try{const n=await $t(r);ee("Actualizacion Exitosa","Se confirmo el pago")}catch(n){console.log(n)}},updatePaymentPlans:async(r,n)=>{V.value=!0,o.value=null;try{console.log(n);const m=await At(r,n);v.value=m.data,ee("ACTUALIZACION EXITOSA",""),console.log(m)}catch(m){console.log(m),m.response&&m.response.status==422&&Oe("ERROR","FALTAN DATOS POR RELLENAR"),o.value=m.message}finally{V.value=!1}}}}const ht={__name:"DeliveryForm",props:{isDialogVisible:{type:Boolean,required:!0},opportunity:{type:Object,required:!0}},emits:["update:isDialogVisible","updateDeliveryDate"],setup(V,{emit:k}){const o=V,v=k,{changeStatusByOpportunity:z}=Z(),P=w=>{v("update:isDialogVisible",w)},r=b(structuredClone(G(o.opportunity)));le(o,()=>{r.value=structuredClone(G(o.opportunity))});const n=async()=>{v("update:isDialogVisible",!1);try{await z(o.opportunity.id,5,{delivery_date:r.value.sales.delivery_date}),v("updateDeliveryDate",r.value.id)}catch(w){console.error("Error updating customer:",w)}},m=()=>{v("update:isDialogVisible",!1)};return(w,y)=>{const A=ue;return u(),F(de,{"model-value":o.isDialogVisible,"max-width":"800","onUpdate:modelValue":P},{default:t(()=>[e(A,{onClick:y[0]||(y[0]=p=>w.$emit("update:isDialogVisible",!1))}),e(Q,{class:"pa-sm-8 pa-5"},{default:t(()=>[e(we,{class:"text-h3 text-center"},{default:t(()=>y[2]||(y[2]=[$(" Confirmar Fecha ")])),_:1}),e(B,null,{default:t(()=>[e(B,null,{default:t(()=>[e(R,null,{default:t(()=>[e(f,{cols:"12",style:{"padding-block":"0","padding-inline":"8px"}},{default:t(()=>[e(Y,{modelValue:i(r).sales.delivery_date,"onUpdate:modelValue":y[1]||(y[1]=p=>i(r).sales.delivery_date=p),label:"Fecha de Entrega",type:"date",rules:["requiredValidator"in w?w.requiredValidator:i(N)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(T,{onClick:n},{default:t(()=>y[3]||(y[3]=[$(" Pasar a Entrega ")])),_:1}),e(T,{color:"secondary",variant:"tonal",onClick:m},{default:t(()=>y[4]||(y[4]=[$(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},St={__name:"PaymentPlanEdit",props:{isDialogVisible:{type:Boolean,required:!0},opportunity:{type:Object,required:!0},payment:{type:Object,required:!0}},emits:["update:isDialogVisible","updateDeliveryDate"],setup(V,{emit:k}){const o=V,v=k,{updatePaymentPlans:z}=Ce(),P=g=>{v("update:isDialogVisible",g)},r=b(structuredClone(G(o.payment))),n=b(structuredClone(G(o.opportunity)));le(o,()=>{r.value=structuredClone(G(o.payment)),n.value=structuredClone(G(o.opportunity))});const m=b([]),w=()=>{m.value.push({amount:"",date:"",type:r.value.type})},y=g=>{m.value.splice(g,1)},A=async()=>{try{await z(r.value.id,{date:r.value.date,differData:m.value})}catch(g){console.error("Error updating customer:",g)}finally{v("updateDeliveryDate",n.value.id),v("update:isDialogVisible",!1),m.value=[]}},p=()=>{v("update:isDialogVisible",!1),m.value=[],errorMessage.value=""};return(g,a)=>{const d=ue;return u(),F(de,{"model-value":o.isDialogVisible,"max-width":"800","onUpdate:modelValue":P},{default:t(()=>[e(d,{onClick:a[0]||(a[0]=s=>g.$emit("update:isDialogVisible",!1))}),e(Q,{class:"pa-sm-8 pa-5"},{default:t(()=>[e(we,{class:"text-h3 text-center"},{default:t(()=>a[2]||(a[2]=[$(" Confirmar Fecha ")])),_:1}),e(B,null,{default:t(()=>[e(B,null,{default:t(()=>[e(R,null,{default:t(()=>[e(f,{cols:"12",style:{"padding-block":"0","padding-inline":"8px"}},{default:t(()=>[l("span",null," Monto a Pagar : "+x(i(r).amount),1),e(Q,{flat:"",class:"d-flex flex-column pa-5"},{default:t(()=>[e(Y,{modelValue:i(r).date,"onUpdate:modelValue":a[1]||(a[1]=s=>i(r).date=s),label:"Fecha de Entrega",type:"date",rules:["requiredValidator"in g?g.requiredValidator:i(N)]},null,8,["modelValue","rules"]),(u(!0),_(j,null,L(i(m),(s,U)=>(u(),_("div",{key:s.id,class:"d-flex align-center my-4"},[e(Y,{modelValue:s.amount,"onUpdate:modelValue":D=>s.amount=D,label:"Monto",type:"number",class:"mr-4",outlined:"",rules:["requiredValidator"in g?g.requiredValidator:i(N)]},null,8,["modelValue","onUpdate:modelValue","rules"]),e(Y,{modelValue:s.date,"onUpdate:modelValue":D=>s.date=D,label:"Fecha de Pago",type:"date",class:"mr-3",outlined:"",rules:["requiredValidator"in g?g.requiredValidator:i(N)]},null,8,["modelValue","onUpdate:modelValue","rules"]),e(T,{color:"error",onClick:D=>y(U)},{default:t(()=>[e(H,{icon:"tabler-square-x"})]),_:2},1032,["onClick"])]))),128)),e(T,{color:"primary",variant:"tonal",class:"mt-4",size:"small",onClick:w},{default:t(()=>a[3]||(a[3]=[$(" Agregar Pago ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(T,{onClick:A},{default:t(()=>a[4]||(a[4]=[$(" Guardar ")])),_:1}),e(T,{color:"error",variant:"tonal",onClick:p},{default:t(()=>a[5]||(a[5]=[$(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Ot={class:"text-h6"},zt={class:"text-h6"},Ut={class:"text-h6"},qt={class:"my-5"},Ft={key:0},Tt=["src"],Et=["onClick"],jt=["onClick"],It={class:"my-5"},Nt={key:0,class:"d-flex flex-wrap gap-2 my-5"},Rt={key:1},Lt={__name:"EditSaleOpportunity",props:{opportunity:{type:Object,required:!0}},emits:["updateStageId"],setup(V,{emit:k}){const o=V,v=k,{checkProcessForOpportunity:z}=oe(),{confirmPaymentPlans:P}=Ce(),r=b(!1),n=b(!1);b(!1);const m=b(""),w=()=>{r.value=!0},y=a=>{console.log("entro aqui"),n.value=!0,m.value={...a}},A=async(a,d)=>{console.log(`Procedimiento ${a} marcado como: ${d?"realizado":"no realizado"}`),await z(o.opportunity.id,a,{is_check:!d}),v("updateStageId",o.opportunity.id)},p=async a=>{console.log(a),await P(a),v("updateStageId",o.opportunity.id)},g=async a=>{v("updateStageId",a)};return(a,d)=>(u(),_(j,null,[l("div",null,[e(Q,null,{default:t(()=>[e(B,null,{default:t(()=>[e(R,null,{default:t(()=>[e(f,{cols:"4",class:"border rounded-sm mx-1"},{default:t(()=>[e(W,{class:"font-weight-medium"},{default:t(()=>d[2]||(d[2]=[$(" Saldo ")])),_:1}),e(J,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",Ot,"$ "+x(o.opportunity.sales.amount-o.opportunity.sales.initial_fee),1)]),_:1})]),_:1}),e(f,{cols:"3",class:"border rounded-sm mx-1"},{default:t(()=>[e(W,{class:"font-weight-medium"},{default:t(()=>d[3]||(d[3]=[$(" Anticipo ")])),_:1}),e(J,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",zt,"$ "+x(o.opportunity.sales.initial_fee),1)]),_:1})]),_:1}),e(f,{cols:"4",class:"border rounded-sm mx-1"},{default:t(()=>[e(W,{class:"font-weight-medium"},{default:t(()=>d[4]||(d[4]=[$(" Precio Final ")])),_:1}),e(J,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",Ut,"$"+x(o.opportunity.sales.amount),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",qt,[d[5]||(d[5]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Propiedades ",-1)),o.opportunity.sales.properties&&o.opportunity.sales.properties.length>0?(u(),_("div",Ft,[(u(!0),_(j,null,L(o.opportunity.sales.properties,s=>(u(),_("div",{key:s.id,class:"d-flex align-center justify-between"},[e(be,{size:"50",rounded:""},{default:t(()=>[l("img",{src:i(ve),alt:"Logo pora",style:{"border-radius":"30%"}},null,8,Tt)]),_:1}),e(f,{cols:"12",md:"7"},{default:t(()=>[e(W,{class:"font-weight-medium"},{default:t(()=>[$(x(s.project_title)+" | "+x(s.title),1)]),_:2},1024),e(J,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",null,"$ "+x(s.pivot_price),1)]),_:2},1024)]),_:2},1024)]))),128))])):M("",!0)]),l("div",null,[d[7]||(d[7]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Cuota Inicial ",-1)),e(te,{density:"compact",class:"text-no-wrap my-2",style:{"font-size":"12px"}},{default:t(()=>[d[6]||(d[6]=l("thead",null,[l("tr",null,[l("th",null," Propiedad "),l("th",null," Fecha "),l("th",null," Monto "),l("th",null," Action ")])],-1)),l("tbody",null,[(u(!0),_(j,null,L(o.opportunity.sales.initial_payments,s=>(u(),_("tr",{key:s.id},[l("td",null,x(s.property_title),1),l("td",null,x(s.date),1),l("td",null,x(s.amount),1),l("td",null,[e(R,null,{default:t(()=>[e(ie,{modelValue:s.is_paid,"onUpdate:modelValue":U=>s.is_paid=U,"true-value":1,"false-value":0,disabled:s.is_paid===1,onChange:U=>p(s.id)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),l("div",{"fill-dot":"",onClick:U=>y(s)},[e(H,{size:"25",icon:"tabler-edit"})],8,Et)]),_:2},1024)])]))),128))])]),_:1})]),l("div",null,[d[9]||(d[9]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Saldo ",-1)),e(te,{density:"compact",class:"text-no-wrap my-2",style:{"font-size":"12px"}},{default:t(()=>[d[8]||(d[8]=l("thead",null,[l("tr",null,[l("th",null," Propiedad "),l("th",null," Fecha "),l("th",null," Monto "),l("th",null," Action ")])],-1)),l("tbody",null,[(u(!0),_(j,null,L(o.opportunity.sales.balance_payments,s=>(u(),_("tr",{key:s.id},[l("td",null,x(s.property_title),1),l("td",null,x(s.date),1),l("td",null,x(s.amount),1),l("td",null,[e(R,null,{default:t(()=>[e(ie,{modelValue:s.is_paid,"onUpdate:modelValue":U=>s.is_paid=U,"true-value":1,"false-value":0,disabled:s.is_paid===1,onChange:U=>p(s.id)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),l("div",{"fill-dot":"",onClick:U=>y(s)},[e(H,{size:"25",icon:"tabler-edit"})],8,jt)]),_:2},1024)])]))),128))])]),_:1})]),l("div",It,[d[11]||(d[11]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Procesos ",-1)),o.opportunity.procedure&&o.opportunity.procedure.length>0?(u(),_("div",Nt,[(u(!0),_(j,null,L(o.opportunity.procedure,s=>(u(),_("div",{key:s.id},[e(K,{color:s.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:U=>A(s.id,s.pivot.is_check)},{default:t(()=>[s.pivot.is_check?(u(),F(H,{key:0,icon:"tabler-check",class:"mr-2"})):M("",!0),$(" "+x(s.title),1)]),_:2},1032,["color","onClick"])]))),128))])):(u(),_("div",Rt,d[10]||(d[10]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),e(B,{class:"d-flex justify-center mt-4"},{default:t(()=>[e(T,{color:"primary",class:"mx-auto",onClick:w},{default:t(()=>d[12]||(d[12]=[$(" Siguiente Etapa ")])),_:1})]),_:1}),e(ht,{"is-dialog-visible":i(r),"onUpdate:isDialogVisible":d[0]||(d[0]=s=>q(r)?r.value=s:null),opportunity:o.opportunity,onUpdateDeliveryDate:g},null,8,["is-dialog-visible","opportunity"]),e(St,{"is-dialog-visible":i(n),"onUpdate:isDialogVisible":d[1]||(d[1]=s=>q(n)?n.value=s:null),payment:i(m),opportunity:o.opportunity,onUpdateDeliveryDate:g},null,8,["is-dialog-visible","payment","opportunity"])],64))}};const Bt={__name:"SellerReport",setup(V){return b([{title:"Actividad 1",date:"2024-10-09",status:"Pendiente"},{title:"Actividad 2",date:"2024-10-10",status:"Completada"},{title:"Actividad 3",date:"2024-10-11",status:"En Progreso"}]),(k,o)=>(u(),F(B,null,{default:t(()=>o[0]||(o[0]=[l("p",null,"No hay actividades seleccionadas. Aquí tienes un resumen de las actividades:",-1)])),_:1}))}},Mt=ke(Bt,[["__scopeId","data-v-c9cbe3f1"]]),Ht={__name:"CustomerHistory",props:{isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","userData"],setup(V,{emit:k}){const o=V,v=k,z=b(!1),P=b(),r=b(""),n=b(""),m=b(""),w=b(""),y=b(),A=b(""),p=b(),g=b(),a=b(),d=()=>{v("update:isDrawerOpen",!1),ce(()=>{var D,C;(D=P.value)==null||D.reset(),(C=P.value)==null||C.resetValidation()})},s=()=>{var D;(D=P.value)==null||D.validate().then(({valid:C})=>{C&&(v("userData",{id:0,fullName:r.value,company:w.value,role:p.value,country:y.value,contact:A.value,email:m.value,currentPlan:g.value,status:a.value,avatar:"",billing:"Auto Debit"}),v("update:isDrawerOpen",!1),ce(()=>{var E,c;(E=P.value)==null||E.reset(),(c=P.value)==null||c.resetValidation()}))})},U=D=>{v("update:isDrawerOpen",D)};return(D,C)=>{const E=Te,c=se,h=ne;return u(),F(je,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":o.isDrawerOpen,"onUpdate:modelValue":U},{default:t(()=>[e(E,{title:"Historial del Cliente",onCancel:d}),e(i(Ee),{options:{wheelPropagation:!1}},{default:t(()=>[e(Q,{flat:""},{default:t(()=>[e(B,null,{default:t(()=>[e(xe,{ref_key:"refForm",ref:P,modelValue:i(z),"onUpdate:modelValue":C[9]||(C[9]=O=>q(z)?z.value=O:null),onSubmit:_e(s,["prevent"])},{default:t(()=>[e(R,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[e(c,{modelValue:i(r),"onUpdate:modelValue":C[0]||(C[0]=O=>q(r)?r.value=O:null),rules:["requiredValidator"in D?D.requiredValidator:i(N)],label:"Full Name",placeholder:"John Doe"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(c,{modelValue:i(n),"onUpdate:modelValue":C[1]||(C[1]=O=>q(n)?n.value=O:null),rules:["requiredValidator"in D?D.requiredValidator:i(N)],label:"Username",placeholder:"Johndoe"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(c,{modelValue:i(m),"onUpdate:modelValue":C[2]||(C[2]=O=>q(m)?m.value=O:null),rules:["requiredValidator"in D?D.requiredValidator:i(N),"emailValidator"in D?D.emailValidator:i(Ae)],label:"Email",placeholder:"johndoe@email.com"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(c,{modelValue:i(w),"onUpdate:modelValue":C[3]||(C[3]=O=>q(w)?w.value=O:null),rules:["requiredValidator"in D?D.requiredValidator:i(N)],label:"Company",placeholder:"PixInvent"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(h,{modelValue:i(y),"onUpdate:modelValue":C[4]||(C[4]=O=>q(y)?y.value=O:null),label:"Select Country",placeholder:"Select Country",rules:["requiredValidator"in D?D.requiredValidator:i(N)],items:["USA","UK","India","Australia"]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(c,{modelValue:i(A),"onUpdate:modelValue":C[5]||(C[5]=O=>q(A)?A.value=O:null),type:"number",rules:["requiredValidator"in D?D.requiredValidator:i(N)],label:"Contact",placeholder:"+1-541-754-3010"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(h,{modelValue:i(p),"onUpdate:modelValue":C[6]||(C[6]=O=>q(p)?p.value=O:null),label:"Select Role",placeholder:"Select Role",rules:["requiredValidator"in D?D.requiredValidator:i(N)],items:["Admin","Author","Editor","Maintainer","Subscriber"]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(h,{modelValue:i(g),"onUpdate:modelValue":C[7]||(C[7]=O=>q(g)?g.value=O:null),label:"Select Plan",placeholder:"Select Plan",rules:["requiredValidator"in D?D.requiredValidator:i(N)],items:["Basic","Company","Enterprise","Team"]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(h,{modelValue:i(a),"onUpdate:modelValue":C[8]||(C[8]=O=>q(a)?a.value=O:null),label:"Select Status",placeholder:"Select Status",rules:["requiredValidator"in D?D.requiredValidator:i(N)],items:[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"},{title:"Pending",value:"pending"}]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(T,{type:"submit",class:"me-3"},{default:t(()=>C[10]||(C[10]=[$(" Submit ")])),_:1}),e(T,{type:"reset",variant:"outlined",color:"secondary",onClick:d},{default:t(()=>C[11]||(C[11]=[$(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Qt={class:"mb-2"},Gt={__name:"AddActivity",props:{activitiesData:{type:Object,required:!0,default:()=>({title:"",description:"",schedule_at:""})},isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","refreshActivities"],setup(V,{emit:k}){const o=V,v=k,z=b(!1);b(!1);const P=b("radio-1"),r=b({title:"",description:"",type_activity_id:null,opportunity_id:null,assigned_to:null,scheduled_at:null,status:"COMPLETED"}),{completedActivityAndRegister:n,getallTypeActivities:m,typeActivities:w,loadingActivity:y}=ye(),{getOpportunitybyId:A,opportunity:p}=Z(),g=b(structuredClone(G(o.activitiesData))),a=E=>{console.log("esta consultando de nuevo despues de cambiar etapa "),A(E)};le(o,()=>{g.value=structuredClone(G(o.activitiesData)),A(g.value.opportunity_id),d()});const d=async()=>{await m()},s=()=>{A(g.value.opportunity_id)},U=()=>{v("update:isDrawerOpen",!1),r.value={title:null,description:null,type_activity_id:null,scheduled_at:null,opportunity_id:null,assigned_to:null,status:"COMPLETED"},v("refreshActivities")},D=async()=>{let E="";P.value==="radio-1"?E="COMPLETED":P.value==="radio-2"&&(E="CANCELLED"),n(g.value.id,{title:r.value.title,description:r.value.description,type_activity_id:r.value.type_activity_id,scheduled_at:r.value.scheduled_at,assigned_to:p.value.user_id,property_id:p.value.property_id,opportunity_id:p.value.id,status:E}),U()},C=async()=>{v("update:isDrawerOpen",!1),v("refreshActivities")};return(E,c)=>{const h=se,O=he,I=fe;return u(),F(R,{class:"d-flex justify-space-between"},{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[V.isDrawerOpen?(u(),F(Q,{key:0},{default:t(()=>[e(B,null,{default:t(()=>[e(De,{class:"mx-2 my-2"},{default:t(()=>[e(R,null,{default:t(()=>[e(f,{cols:"12",sm:"5"},{default:t(()=>[e(R,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>c[6]||(c[6]=[l("span",{style:{"font-size":"18px","font-weight":"500"}}," Actividad ",-1)])),_:1}),e(f,{cols:"12"},{default:t(()=>[l("div",Qt,[l("span",null,x(o.activitiesData.type_activity)+"   •   "+x(o.activitiesData.title),1)]),e(Ne,{modelValue:i(P),"onUpdate:modelValue":c[0]||(c[0]=S=>q(P)?P.value=S:null),style:{"font-size":"10px"}},{default:t(()=>[e(me,{label:"Completar Actividad",value:"radio-1",density:"compact"}),e(me,{label:"Cancelar Actividad",value:"radio-2",density:"compact"})]),_:1},8,["modelValue"]),e(Re,{class:"mt-2"})]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(h,{modelValue:i(r).title,"onUpdate:modelValue":c[1]||(c[1]=S=>i(r).title=S),label:"Titulo de la actividad",placeholder:"..."},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(ne,{modelValue:i(r).type_activity_id,"onUpdate:modelValue":c[2]||(c[2]=S=>i(r).type_activity_id=S),label:"Tipo de Actividad",placeholder:"Selecciona el Tipo de Actividad",items:i(w).map(S=>({title:S.name,value:S.id}))},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(O,{modelValue:i(r).scheduled_at,"onUpdate:modelValue":c[3]||(c[3]=S=>i(r).scheduled_at=S),label:"Seleccione la Fecha y Hora",placeholder:"Select date and time",config:{enableTime:!0,dateFormat:"Y-m-d H:i"},rules:["requiredValidator"in E?E.requiredValidator:i(N)]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(I,{modelValue:i(r).description,"onUpdate:modelValue":c[4]||(c[4]=S=>i(r).description=S),label:"Descripcion",rows:"3",rules:["requiredValidator"in E?E.requiredValidator:i(N)]},null,8,["modelValue","rules"])]),_:1}),e(f,null,{default:t(()=>[e(T,{size:"small",color:"prymary",variant:"tonal",class:"mx-auto",loading:i(y),disabled:i(y),onClick:D},{default:t(()=>c[7]||(c[7]=[$(" Crear Actividad ")])),_:1},8,["loading","disabled"]),e(T,{size:"small",color:"error",variant:"tonal",class:"my-2 mx-2"},{default:t(()=>c[8]||(c[8]=[$(" Dar de Baja ")])),_:1})]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",sm:"7",style:{"align-items":"center"}},{default:t(()=>[e(R,{class:"mb-2"},{default:t(()=>[e(f,{cols:"6"},{default:t(()=>c[9]||(c[9]=[l("span",{style:{"font-size":"18px","font-weight":"500"}}," Etapa ",-1)])),_:1}),e(f,{cols:"12",md:"6",class:"d-flex justify-end align-center"},{default:t(()=>[e(K,{label:"",color:"primary"},{default:t(()=>[$(x(i(p).stage.title),1)]),_:1})]),_:1})]),_:1}),i(p).stage_id===2?(u(),F(Ct,{key:0,opportunity:i(p),onUpdateStageId:a},null,8,["opportunity"])):M("",!0),i(p).stage_id===3?(u(),F(yt,{key:1,opportunity:i(p),onUpdateStageId:a},null,8,["opportunity"])):M("",!0),i(p).stage_id===4?(u(),F(Lt,{key:2,opportunity:i(p),onRefreshActivities:s,onUpdateStageId:a},null,8,["opportunity"])):M("",!0),i(p).stage_id===5?(u(),F(Ye,{key:3,opportunity:i(p),onRefreshActivities:s,onUpdateStageId:a,onComplet:C},null,8,["opportunity"])):M("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(u(),F(Q,{key:1,title:"Reporte de Actividades"},{default:t(()=>[e(Mt)]),_:1}))]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(Ht,{"is-drawer-open":i(z),"onUpdate:isDrawerOpen":c[5]||(c[5]=S=>q(z)?z.value=S:null)},null,8,["is-drawer-open"])]),_:1})]),_:1})}}};const Kt={style:{"font-size":"14px"}},Wt={key:0,class:"no-activities-message d-flex flex-column justify-center align-center",style:{"min-block-size":"200px","text-align":"center"}},Jt=["onClick"],Xt={class:"mx-2"},Zt={class:"d-flex justify-content-between",style:{"font-size":"0.9em"}},Yt={__name:"list",setup(V){const k=b("New");b(["Todos","PORA"]),b("Todos");const{getallActivitiesByAsesorFecha:o,getallActivitiesByFechaPast:v,getallActivitiesByFechaFuture:z,activities:P,activitiesPast:r,activitiesFuture:n}=ye(),m=b(""),w=ze("userData").value,y=b(!0),A=async()=>{await o(w.id),console.log("Actividades de hoy:",P)},p=async()=>{await v(w.id),console.log("Actividades pasadas:",r)},g=async()=>{await z(w.id),console.log("Actividades futuras:",n)};Ue(async()=>{await A(),await p(),await g(),y.value=!1});const a=b(!1),d=c=>{a.value=!0,m.value={...c}},s=async()=>{await A(),await p(),await g(),y.value=!1},U=[{tabName:"Hoy",icon:"tabler-edit",actividades:P,badge:P.value.length},{tabName:"Anteriores",icon:"tabler-calendar",actividades:r,badge:r.value.length},{tabName:"Futuros",icon:"tabler-calendar",actividades:n,badge:n.value.length}],D=[{type:"Visita",icon:"tabler-current-location"},{type:"Llamada",icon:"tabler-phone"},{type:"Cotizacion",icon:"tabler-cash"},{type:"Otro",icon:"tabler-table"}],C=c=>{const h=D.find(O=>O.type===c);return h?h.icon:"tabler-default"},E=c=>{const h=new Date(c),O=h.getDate(),S=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][h.getMonth()],pe=h.getHours().toString().padStart(2,"0"),$e=h.getMinutes().toString().padStart(2,"0");return`${O} de ${S}, ${pe}:${$e}`};return(c,h)=>{const O=re("VCircularProgress");return u(),F(R,{class:"match-height",style:{display:"flex","block-size":"100vh"}},{default:t(()=>[e(f,{cols:"12",md:"4",style:{display:"flex","flex-direction":"column"}},{default:t(()=>[e(Q,{title:"Lista de Actividades",class:"flex-grow-1"},{default:t(()=>[e(Le,{modelValue:i(k),"onUpdate:modelValue":h[0]||(h[0]=I=>q(k)?k.value=I:null),grow:""},{default:t(()=>[(u(),_(j,null,L(U,I=>e(Be,{key:I.tabName},{default:t(()=>[l("span",Kt,x(I.tabName),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),h[7]||(h[7]=l("br",null,null,-1)),e(B,{style:{"flex-grow":"1","overflow-y":"auto"}},{default:t(()=>[i(y)?(u(),F(Me,{key:0,absolute:"",opacity:"0.7"},{default:t(()=>[e(O,{indeterminate:"",size:"70"})]),_:1})):M("",!0),e(De,{modelValue:i(k),"onUpdate:modelValue":h[1]||(h[1]=I=>q(k)?k.value=I:null),class:"disable-tab-transition",style:{"max-block-size":"500px","overflow-y":"auto"}},{default:t(()=>[(u(),_(j,null,L(U,I=>e(Ie,{key:I.tabName,value:I.tabName},{default:t(()=>[I.actividades.value.length===0?(u(),_("div",Wt,[e(H,{size:"64",color:"grey",icon:"tabler-calendar-off",class:"mb-4",style:{animation:"bounce 1s infinite"}}),h[4]||(h[4]=l("div",{style:{color:"#888","font-size":"1.2em"}}," ¡No tienes actividades pendientes! ",-1)),h[5]||(h[5]=l("div",{style:{color:"#aaa","font-size":"0.9em","margin-block-start":"8px"}}," ¡Relájate y disfruta tu día! ",-1))])):(u(!0),_(j,{key:1},L(I.actividades.value,S=>(u(),_("div",{key:S.id,"fill-dot":"",class:"border mb-2 rounded-sm py-2",onClick:pe=>d(S)},[e(ae,null,{default:t(()=>[e(R,null,{default:t(()=>[e(f,{cols:"12",md:"2",style:{"padding-inline-end":"0"}},{default:t(()=>[e(K,{class:"d-flex justify-center align-center",style:{display:"inline-flex","border-radius":"4px","block-size":"36px","inline-size":"36px"}},{default:t(()=>[e(H,{size:"25",icon:"tabler-home"})]),_:1})]),_:1}),S.project_name?(u(),F(f,{key:0,cols:"12",md:"5",class:"d-flex flex-column align-start",style:{"padding-inline-start":"0"}},{default:t(()=>[e(J,{class:"text-left"},{default:t(()=>[l("strong",null,x(S.property_title),1)]),_:2},1024),e(W,{class:"font-weight-medium text-left"},{default:t(()=>[l("span",null,"$ "+x(S.price),1)]),_:2},1024)]),_:2},1024)):M("",!0),S.project_name?M("",!0):(u(),F(f,{key:1,cols:"12",md:"5"})),e(f,{cols:"12",md:"5",class:"d-flex justify-end align-center"},{default:t(()=>[e(K,{label:"",color:"primary",class:"ml-auto",style:{"font-size":"10px"}},{default:t(()=>[$(x(S.stage),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(ae,{class:""},{default:t(()=>[e(K,{label:"",color:"secondary",class:"w-100 h-48"},{default:t(()=>[e(H,{size:"20",icon:C(S.type_activity)},null,8,["icon"]),l("div",Xt,x(S.type_activity)+"   •   "+x(S.name_opportunity),1)]),_:2},1024)]),_:2},1024),e(ae,null,{default:t(()=>[l("div",Zt,[h[6]||(h[6]=l("div",{style:{"flex-grow":"1"}}," Ver ",-1)),l("div",null,x(E(S.scheduled_at)),1)])]),_:2},1024)],8,Jt))),128))]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",md:"8",style:{display:"flex","flex-direction":"column"}},{default:t(()=>[e(Gt,{"is-drawer-open":i(a),"onUpdate:isDrawerOpen":h[2]||(h[2]=I=>q(a)?a.value=I:null),"activities-data":i(m),class:"flex-grow-1",onRefreshActivities:s,onLoaded:h[3]||(h[3]=I=>y.value=!1)},null,8,["is-drawer-open","activities-data"])]),_:1})]),_:1})}}},ao=ke(Yt,[["__scopeId","data-v-0bd1e790"]]);export{ao as default};
