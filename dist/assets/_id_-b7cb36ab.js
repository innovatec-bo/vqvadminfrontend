import{a as j}from"./formatters-b3558c7d.js";import{u as q,a as M,_ as F}from"./BitacoraCustomer-f9e0baa9.js";import{u as U}from"./useCustomer-d7d10058.js";import{V as k}from"./VRow-be1e0310.js";import{V as v}from"./VCol-b8926b4b.js";import{o as r,f as V,e as l,b as e,c,F as h,i as x,d as t,x as s,$ as A,v as b,n as m,z as N,a as w,r as H,j as G,H as K,a4 as S,a0 as B}from"./index-b40b785d.js";import{V as $,b as W}from"./VCard-2ad73a87.js";import{f as O}from"./currencyFormatter-92ad4b3c.js";import{V as D}from"./VCardText-3fc39e2b.js";import{V as Q}from"./VChip-a1be3f1e.js";import{V as L}from"./VTooltip-24e6bd7d.js";import{V as R}from"./VTable-f0a4c716.js";import{V as z}from"./VCheckbox-b0ac60df.js";import{V as Y}from"./VDivider-1866a089.js";import{V as J,a as E,b as T}from"./VList-48bba736.js";import{V as X,a as Z}from"./VTabs-f4c0ccb6.js";import{V as tt,a as I}from"./VWindowItem-e9374dac.js";import"./helpers-61e4df1a.js";import"./api-5e105e76.js";import"./index-9c720871.js";import"./constants-71880aa6.js";import"./notifications-e0287a8c.js";import"./VTimelineItem-d8db158f.js";import"./VAvatar-fc605694.js";import"./VImg-d8b1f694.js";import"./VOverlay-adc3474d.js";import"./easing-9f15041e.js";import"./lazy-08fd721d.js";import"./scopeId-df115906.js";import"./forwardRefs-8348545e.js";import"./VCheckboxBtn-4156c138.js";import"./VSelectionControl-cbf2c210.js";import"./form-6c56fbec.js";import"./VInput-199f1c57.js";import"./ssrBoot-51124d42.js";import"./VSlideGroup-a86ea920.js";const et={class:"d-flex justify-content-between"},lt={style:{"flex-grow":"1"}},ot={class:"d-flex align-center mt-2",style:{"font-size":"small"}},st={class:"ms-2"},nt={class:"d-flex align-center",style:{"font-size":"small"}},at={class:"ms-2"},rt={class:"d-flex gap-x-4 justify-end mt-2",style:{"font-size":"small"}},ut={class:"d-flex align-center"},dt={class:"ms-2"},it={class:"d-flex align-center"},ct={class:"ms-2"},pt={__name:"customerActivity",props:{activities:{type:Object,required:!0}},setup(g){const _=g,C=u=>u==="PENDING"?"Pendiente":u==="COMPLETED"?"Completada":u==="DISCARD"?"Descartada":u==="CANCELLED"?"Cancelada":u,y=u=>{const f=new Date(u),a=f.getDate(),o=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][f.getMonth()],i=f.getHours().toString().padStart(2,"0"),p=f.getMinutes().toString().padStart(2,"0");return`${a} de ${o}, ${i}:${p}`};return(u,f)=>(r(),V($,{title:"Activities"},{default:l(()=>[e(k,{class:"mx-5 my-2"},{default:l(()=>[(r(!0),c(h,null,x(_.activities,a=>(r(),V(v,{key:a.id,cols:"4.5",class:"border my-2 mx-2"},{default:l(()=>[t("div",et,[t("div",lt,[t("strong",null,s(a.title),1)]),t("div",null,[t("strong",null," Asesor: "+s(a.name_assigned),1)])]),t("span",null,s(a.description),1),t("span",ot,[f[0]||(f[0]=t("span",null,"Creado:",-1)),t("span",st,s(y(a.created_at)),1)]),t("span",nt,[f[1]||(f[1]=t("span",null,"Programado:",-1)),t("span",at,s(y(a.scheduled_at)),1)]),t("div",rt,[t("span",ut,[e(A,{color:"primary",icon:"tabler-capture",size:"18"}),t("strong",dt,s(a.type_activity),1)]),t("span",it,[e(A,{color:"primary",icon:"tabler-circle-dotted",size:"18"}),t("strong",ct,s(C(a.state_activity)),1)])])]),_:2},1024))),128))]),_:1})]),_:1}))}},mt={class:"d-flex justify-content-between"},ft={style:{"flex-grow":"1"}},_t={class:"my-5"},yt={key:0,class:"d-flex flex-wrap gap-2"},bt={key:1},ht={__name:"customeropportunity",props:{opportunities:{type:Object,required:!0}},emits:["refreshCustomer"],setup(g,{emit:_}){const C=g,y=_,{checkProcessForOpportunity:u}=q(),f=async(n,o,i)=>{console.log(`Procedimiento ${n} marcado como: ${i?"realizado":"no realizado"}`),await u(o,n,{is_check:!i}),y("refreshCustomer")},a=(n,o)=>n===0?"Última oportunidad":n===o-1?"Primera oportunidad":`${o-n}ª oportunidad`;return(n,o)=>(r(),V(k,null,{default:l(()=>[e(v,{cols:"12"},{default:l(()=>[(r(!0),c(h,null,x(C.opportunities,(i,p)=>(r(),V($,{key:i.id,class:"mb-3"},{default:l(()=>[e(D,null,{default:l(()=>[t("div",mt,[t("div",ft,[t("h2",null,s(a(p,C.opportunities.length)),1)]),t("div",null,[t("strong",null," Fecha: "+s(i.start_date),1)])]),t("div",null,[t("span",null,[o[0]||(o[0]=t("strong",null," Estado: ",-1)),b(" "+s(i.stage.title),1)]),o[3]||(o[3]=t("br",null,null,-1)),o[4]||(o[4]=t("strong",null,"Propiedad de Interes: ",-1)),t("span",null,s(i.property.title)+" | "+s(m(O)(i.property.base_price))+" | "+s(i.property.surface)+" m2 ",1),t("div",_t,[o[2]||(o[2]=t("h3",{class:"my-1"}," Procesos ",-1)),i.procedure&&i.procedure.length>0?(r(),c("div",yt,[(r(!0),c(h,null,x(i.procedure,d=>(r(),c("div",{key:d.id},[e(Q,{color:d.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:P=>f(d.id,i.id,d.pivot.is_check)},{default:l(()=>[d.pivot.is_check?(r(),V(A,{key:0,icon:"tabler-check",class:"mr-2"})):N("",!0),b(" "+s(d.title),1)]),_:2},1032,["color","onClick"]),e(L,{activator:"parent",location:"top"},{default:l(()=>[b(s(d.pivot.is_check?"Deshacer Proceso":"Confirmar Proceso"),1)]),_:2},1024)]))),128))])):(r(),c("div",bt,o[1]||(o[1]=[t("span",null,"No hay procedimientos disponibles.",-1)])))])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}},xt={class:"my-2"},Ct={class:"my-2"},Vt={class:"d-flex items-center gap-x-2"},gt={__name:"customerQuote",props:{quotes:{type:Object,required:!0}},setup(g){const _=g,C=y=>y==="CASH"?"Al Contado":y==="DIRECTCREDIT"?"Crédito Directo":y==="BANKCREDIT"?"Crédito Bancario":y;return(y,u)=>{const f=w("IconBtn"),a=w("RouterLink");return r(),V(k,null,{default:l(()=>[e(v,{cols:"12"},{default:l(()=>[e($,{title:"Cotizaciones"},{default:l(()=>[e(D),e(R,{density:"compact",class:"text-no-wrap my-2"},{default:l(()=>[u[0]||(u[0]=t("thead",null,[t("tr",null,[t("th",null," Metodo de Pago "),t("th",null," Propiedades "),t("th",null," Total "),t("th",null," Gerencia "),t("th",null," Cliente "),t("th",null," Accion ")])],-1)),t("tbody",null,[(r(!0),c(h,null,x(_.quotes,n=>(r(),c("tr",{key:n.id},[t("td",null,s(C(n.payment_method)),1),t("td",null,[(r(!0),c(h,null,x(n.properties,o=>(r(),c("div",{key:o.id,class:"d-flex gap-x-2"},s(o.title)+" | "+s(o.code),1))),128))]),t("td",null,[t("span",xt,s(n.status==="APPROVED"?"Aprobado":"No Aprobado"),1)]),t("td",null,[t("span",Ct,s(n.status_customer==="APPROVED"?"Aprobado":"No Aprobado"),1)]),t("td",null,s(n.creation_date),1),t("td",null,[t("div",Vt,[e(a,{to:{name:"quote-id",params:{id:n.id}}},{default:l(()=>[e(f,null,{default:l(()=>[e(A,{icon:"tabler-eye"})]),_:1})]),_:2},1032,["to"])])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})}}},vt={class:"d-flex items-center gap-x-2"},kt={__name:"customerSale",props:{sales:{type:Object,required:!0}},setup(g){const _=g,{confirmPaymentPlans:C}=M(),y=async a=>{console.log(a),await C(a),emit("updateStageId",_.opportunity.id)},u=a=>a==="CASH"?"Al Contado":a==="DIRECTCREDIT"?"Crédito Directo":a==="BANKCREDIT"?"Crédito Bancario":a,f=a=>a==="SALE"?"VENDIDO":a==="DISCARD"?"CANCELADO":a==="DELIVERY"?"ENTREGADO":a;return(a,n)=>{const o=w("IconBtn"),i=w("RouterLink");return r(),c(h,null,[e(k,null,{default:l(()=>[e(v,{cols:"12"},{default:l(()=>[e($,{title:"Ventas"},{default:l(()=>[e(R,{density:"compact",class:"text-no-wrap my-2"},{default:l(()=>[n[0]||(n[0]=t("thead",null,[t("tr",null,[t("th",null," ID "),t("th",null," Metodo de Pago "),t("th",null," Propiedades "),t("th",null," Total "),t("th",null," Estado "),t("th",null," Fecha "),t("th",null," Accion ")])],-1)),t("tbody",null,[(r(!0),c(h,null,x(_.sales,p=>(r(),c("tr",{key:p.id},[t("td",null,s(p.id),1),t("td",null,s(u(p.payment_method)),1),t("td",null,[(r(!0),c(h,null,x(p.properties,d=>(r(),c("div",{key:d.id,class:"d-flex gap-x-2"},s(d.title)+" | "+s(d.code),1))),128))]),t("td",null,s(("formatCurrency"in a?a.formatCurrency:m(O))(p.amount)),1),t("td",null,s(f(p.status)),1),t("td",null,s(p.creation_date),1),t("td",null,[t("div",vt,[e(i,{to:{name:"sale-id",params:{id:p.id}}},{default:l(()=>[e(o,null,{default:l(()=>[e(A,{icon:"tabler-eye"})]),_:1})]),_:2},1032,["to"])])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),(r(!0),c(h,null,x(_.sales,p=>(r(),c("div",{key:p.id,class:"my-5"},[e($,null,{default:l(()=>[e(D,null,{default:l(()=>[t("h3",null," Venta: "+s(p.id),1),n[7]||(n[7]=t("br",null,null,-1)),e(k,null,{default:l(()=>[e(v,{col:"6",class:"border mx-2"},{default:l(()=>[n[3]||(n[3]=t("strong",null," Cuotas Iniciales ",-1)),p.initial_payments&&p.initial_payments.length>0?(r(),V(R,{key:0,density:"compact",class:"text-no-wrap my-2"},{default:l(()=>[n[2]||(n[2]=t("thead",null,[t("tr",null,[t("th",null," Fecha "),t("th",null," Monto "),t("th",null," Estado "),t("th",null," Action ")])],-1)),t("tbody",null,[(r(!0),c(h,null,x(p.initial_payments,d=>(r(),c("tr",{key:d.id},[t("td",null,s(d.date),1),t("td",null,s(d.amount),1),t("td",null,s(d.is_paid?"Pagado":"Pendiente"),1),t("td",null,[e(z,{modelValue:d.is_paid,"onUpdate:modelValue":P=>d.is_paid=P,"true-value":1,"false-value":0,disabled:d.is_paid===1,onChange:P=>y(d.id)},{default:l(()=>[e(L,{activator:"parent",location:"top"},{default:l(()=>n[1]||(n[1]=[b(" Confirmar Pago ")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])])]))),128))])]),_:2},1024)):N("",!0)]),_:2},1024),e(v,{col:"6",class:"border mx-2"},{default:l(()=>[n[6]||(n[6]=t("strong",null," Saldos ",-1)),p.balance_payments&&p.balance_payments.length>0?(r(),V(R,{key:0,density:"compact",class:"text-no-wrap my-2"},{default:l(()=>[n[5]||(n[5]=t("thead",null,[t("tr",null,[t("th",null," Fecha "),t("th",null," Monto "),t("th",null," Estado "),t("th",null," Action ")])],-1)),t("tbody",null,[(r(!0),c(h,null,x(p.balance_payments,d=>(r(),c("tr",{key:d.id},[t("td",null,s(d.date),1),t("td",null,s(d.amount),1),t("td",null,s(d.is_paid?"Pagado":"Pendiente"),1),t("td",null,[e(k,null,{default:l(()=>[e(z,{modelValue:d.is_paid,"onUpdate:modelValue":P=>d.is_paid=P,"true-value":1,"false-value":0,disabled:d.is_paid===1,onChange:P=>y(d.id)},{default:l(()=>[e(L,{activator:"parent",location:"top"},{default:l(()=>n[4]||(n[4]=[b(" Confirmar Pago ")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:2},1024)])]))),128))])]),_:2},1024)):N("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))],64)}}},$t={class:"text-5xl font-weight-medium"},Pt={class:"text-h4 mt-4"},Dt={class:"text-h6"},At={class:"text-body-1"},Et={class:"text-h6"},Tt={class:"text-body-1"},It={class:"text-h6"},Rt={class:"text-body-1"},wt={class:"text-h6"},Nt={class:"text-body-1"},Lt={class:"text-h6"},St={class:"text-body-1"},xe={__name:"[id]",setup(g){const _=H(null),C=G(),{getPerfilCutomerbyId:y,customer:u}=U(),f=[{icon:"tabler-users",title:"Oportunidades"},{icon:"tabler-star",title:"Actividades"},{icon:"tabler-currency-dollar",title:"Cotizaciones"},{icon:"tabler-cash",title:"ventas"},{icon:"tabler-table",title:"Bitacora"}],a=async()=>{try{await y(C.params.id)}catch(n){console.error("Error al obtener la cotización:",n)}};return K(()=>{a(),console.log(u)}),(n,o)=>m(u)?(r(),V(k,{key:0},{default:l(()=>[e(v,{cols:"12",md:"3"},{default:l(()=>[e($,null,{default:l(()=>[e(D,{class:"text-center pt-15"},{default:l(()=>[t("span",$t,s(("avatarText"in n?n.avatarText:m(j))(m(u).customer.name)),1),t("h6",Pt,s(m(u).customer.name),1)]),_:1}),e(Y),e(D,null,{default:l(()=>[o[7]||(o[7]=t("p",{class:"text-sm text-uppercase text-disabled"}," Detalles ",-1)),e(J,{class:"card-list mt-2"},{default:l(()=>[e(E,null,{default:l(()=>[e(T,null,{default:l(()=>[t("h6",Dt,[o[2]||(o[2]=b(" Nombre: ")),t("span",At,s(m(u).customer.name),1)])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(T,null,{default:l(()=>[t("h6",Et,[o[3]||(o[3]=b(" Email: ")),t("span",Tt,s(m(u).customer.email),1)])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(T,null,{default:l(()=>[t("h6",It,[o[4]||(o[4]=b(" Numero: ")),t("span",Rt,s(m(u).customer.cod_phone)+s(m(u).customer.phone),1)])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(T,null,{default:l(()=>[t("h6",wt,[o[5]||(o[5]=b(" Lugar de Trabajo: ")),t("span",Nt,s(m(u).customer.workplace),1)])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(T,null,{default:l(()=>[t("h6",Lt,[o[6]||(o[6]=b(" Carnet: ")),t("span",St,s(m(u).customer.ci),1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,{class:"d-flex justify-center"},{default:l(()=>[e(S,{variant:"elevated",class:"me-4"},{default:l(()=>o[8]||(o[8]=[b(" Edit ")])),_:1}),e(S,{variant:"tonal",color:"error"},{default:l(()=>o[9]||(o[9]=[b(" Suspend ")])),_:1})]),_:1})]),_:1})]),_:1}),e(v,{cols:"12",md:"9"},{default:l(()=>[e(X,{modelValue:m(_),"onUpdate:modelValue":o[0]||(o[0]=i=>B(_)?_.value=i:null),class:"v-tabs-pill"},{default:l(()=>[(r(),c(h,null,x(f,i=>e(Z,{key:i.icon},{default:l(()=>[e(A,{size:18,icon:i.icon,class:"me-1"},null,8,["icon"]),t("span",null,s(i.title),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(tt,{modelValue:m(_),"onUpdate:modelValue":o[1]||(o[1]=i=>B(_)?_.value=i:null),class:"mt-6 disable-tab-transition",touch:!1},{default:l(()=>[e(I,null,{default:l(()=>[e(ht,{opportunities:m(u).opportunities,onRefreshCustomer:a},null,8,["opportunities"])]),_:1}),e(I,null,{default:l(()=>[e(pt,{activities:m(u).activities},null,8,["activities"])]),_:1}),e(I,null,{default:l(()=>[e(gt,{quotes:m(u).quotes},null,8,["quotes"])]),_:1}),e(I,null,{default:l(()=>[e(kt,{sales:m(u).sales},null,8,["sales"])]),_:1}),e(I,null,{default:l(()=>[e(F,{customer:m(u).customer.id},null,8,["customer"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(r(),V($,{key:1},{default:l(()=>[e(W,{class:"text-center"},{default:l(()=>o[10]||(o[10]=[b(" No User Found ")])),_:1})]),_:1}))}};export{xe as default};
