import{r as N}from"./validators-dea6e3a5.js";import{r as p,o as m,f as P,e as a,b as e,v as b,d,n as s,a0 as D,a3 as M,a4 as E,an as O,k as W,ab as j,ac as q,c as U,x as v,F as R,i as z,z as G,af as H,a2 as J,$ as K}from"./index-29b7cc60.js";import{_ as Q}from"./AppTextField-935152ba.js";import{u as X}from"./useAuth-5e6c5999.js";import{b as S}from"./notifications-cae4d01c.js";import{V as x}from"./VCol-d1606abf.js";import{V as B,b as Y}from"./VCard-bf13d430.js";import{V as A}from"./VCardText-39037d93.js";import{V as Z,a as h}from"./VAlert-7945156f.js";import{V as ee}from"./VForm-c5c832c7.js";import{V as $}from"./VRow-e48c256c.js";import{a as ae}from"./formatters-58bf909e.js";import{_ as te}from"./UserUpgradePlanDialog-5ad43fd7.js";import{_ as le,u as se}from"./UserInfoEditDialog-db00e949.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import{V as re}from"./VAvatar-3429543c.js";import{V as ne}from"./VImg-1c591935.js";import{V as ie}from"./VChip-4c549402.js";import{V as ue}from"./VDivider-6245c6f4.js";import{V as de,a as T,b as I}from"./VList-ff95fa1b.js";import{V as me,a as pe}from"./VTabs-d1ca7168.js";import{V as fe,a as ce}from"./VWindowItem-55d07c06.js";import"./helpers-61e4df1a.js";import"./form-46c7b9be.js";import"./VTextField-5eb6a6dc.js";/* empty css                   */import"./VCounter-c63caf4b.js";import"./VField-1605a089.js";import"./easing-9f15041e.js";import"./VInput-43c70c11.js";import"./forwardRefs-8348545e.js";import"./api-d30cbc93.js";import"./index-9c720871.js";import"./constants-0978c720.js";import"./ConfirmDialog-52a0efe8.js";import"./VDialog-f47f8ae9.js";import"./VOverlay-713169b3.js";import"./lazy-4fe66c8e.js";import"./scopeId-a1937037.js";import"./dialog-transition-bd818187.js";import"./CustomRadios-b8519336.js";import"./VRadioGroup-2a3ab5b5.js";import"./VSelectionControl-7e5360d8.js";import"./VSpacer-d4a298cc.js";import"./DialogCloseBtn-819078ea.js";import"./ssrBoot-380d8664.js";import"./VSlideGroup-674eea9a.js";const Ve={__name:"changePassword",setup(F){const{loading:k,error:o,resetUserPassword:n}=X(),y=p(!1),g=p(),C=u=>u.length>=8||"La contraseña debe tener al menos 8 caracteres",f=p(""),c=p(""),V=p(""),w=p(!1),r=p(!1),t=p(!1),L=async()=>{var l;const{valid:u}=await((l=g.value)==null?void 0:l.validate());if(u){if(f.value===c.value){S("ERROR","La nueva contraseña no puede ser igual que la antigua contraseña.");return}if(c.value!==V.value){S("ERROR","La nueva contraseña y la confirmación de la contraseña no coinciden");return}await n({current_password:f.value,new_password:c.value,new_password_confirmation:V.value}),O(()=>{var _,i;(_=g.value)==null||_.reset(),(i=g.value)==null||i.resetValidation()})}};return(u,l)=>{const _=Q;return m(),P($,null,{default:a(()=>[e(x,{cols:"12"},{default:a(()=>[e(B,{title:"Cambiar Contraseña"},{default:a(()=>[e(A,null,{default:a(()=>[e(Z,{variant:"tonal",color:"warning",class:"mb-4"},{default:a(()=>[e(h,{class:"mb-2"},{default:a(()=>l[7]||(l[7]=[b(" Asegúrate de que se cumplan estos requisitos: ")])),_:1}),l[8]||(l[8]=d("span",null,"Mínimo 8 caracteres de longitud, Mayúsculas y símbolo",-1))]),_:1}),e(ee,{ref_key:"refForm",ref:g,modelValue:s(y),"onUpdate:modelValue":l[6]||(l[6]=i=>D(y)?y.value=i:null),onSubmit:M(L,["prevent"])},{default:a(()=>[e($,null,{default:a(()=>[e(x,{cols:"12",md:"4"},{default:a(()=>[e(_,{modelValue:s(f),"onUpdate:modelValue":l[0]||(l[0]=i=>D(f)?f.value=i:null),label:"Antigua Contraseña",placeholder:"············",rules:["requiredValidator"in u?u.requiredValidator:s(N),C],type:s(w)?"text":"password","append-inner-icon":s(w)?"tabler-eye-off":"tabler-eye","onClick:appendInner":l[1]||(l[1]=i=>w.value=!s(w))},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),e(x,{cols:"12",md:"4"},{default:a(()=>[e(_,{modelValue:s(c),"onUpdate:modelValue":l[2]||(l[2]=i=>D(c)?c.value=i:null),label:"Nueva Contraseña",placeholder:"············",rules:["requiredValidator"in u?u.requiredValidator:s(N),C],type:s(r)?"text":"password","append-inner-icon":s(r)?"tabler-eye-off":"tabler-eye","onClick:appendInner":l[3]||(l[3]=i=>r.value=!s(r))},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),e(x,{cols:"12",md:"4"},{default:a(()=>[e(_,{modelValue:s(V),"onUpdate:modelValue":l[4]||(l[4]=i=>D(V)?V.value=i:null),label:"Confirmar Contraseña",placeholder:"············",rules:["requiredValidator"in u?u.requiredValidator:s(N),C],type:s(t)?"text":"password","append-inner-icon":s(t)?"tabler-eye-off":"tabler-eye","onClick:appendInner":l[5]||(l[5]=i=>t.value=!s(t))},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),e(x,{cols:"12"},{default:a(()=>[e(E,{type:"submit"},{default:a(()=>l[9]||(l[9]=[b(" Cambiar Contraseña ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}};const _e={key:1,class:"text-5xl font-weight-medium"},ve={class:"text-h4 mt-4"},be={class:"text-h6"},ye={class:"text-body-1"},we={class:"text-h6"},ge={class:"text-body-1"},xe={class:"text-h6"},De={class:"text-body-1"},Ce={class:"text-h6"},Ue={class:"text-capitalize text-body-1"},ke={__name:"UserPanel",props:{userData:{type:Object,required:!0}},emits:["profile-updated"],setup(F,{emit:k}){const o=F,n=p(!1),y=p(!1),g=W(),C=j(),f=k;function c(){f("profile-updated")}const V=q("userData"),w=async()=>{q("accessToken").value=null,V.value=null,await g.push("/login"),q("userAbilityRules").value=null,C.update([])};return(r,t)=>{const L=le,u=te;return m(),U(R,null,[e($,null,{default:a(()=>[e(x,{cols:"12"},{default:a(()=>[o.userData?(m(),P(B,{key:0},{default:a(()=>[e(A,{class:"text-center pt-15"},{default:a(()=>[e(re,{rounded:"",size:100,color:o.userData.avatar?void 0:"primary",variant:o.userData.avatar?void 0:"tonal"},{default:a(()=>[o.userData.avatar?(m(),P(ne,{key:0,src:o.userData.avatar},null,8,["src"])):(m(),U("span",_e,v(("avatarText"in r?r.avatarText:s(ae))(o.userData.name)),1))]),_:1},8,["color","variant"]),d("h6",ve,v(o.userData.name),1),(m(!0),U(R,null,z(o.userData.roles,(l,_)=>(m(),U("div",{key:_},[e(ie,{label:"",size:"small",class:"text-capitalize mt-3"},{default:a(()=>[b(v(l),1)]),_:2},1024)]))),128))]),_:1}),e(ue),e(A,null,{default:a(()=>[t[7]||(t[7]=d("p",{class:"text-sm text-uppercase text-disabled"}," Detalles ",-1)),e(de,{class:"card-list mt-2"},{default:a(()=>[e(T,null,{default:a(()=>[e(I,null,{default:a(()=>[d("h6",be,[t[3]||(t[3]=b(" Nombre: ")),d("span",ye,v(o.userData.name)+" "+v(o.userData.last_name),1)])]),_:1})]),_:1}),e(T,null,{default:a(()=>[e(I,null,{default:a(()=>[d("h6",we,[t[4]||(t[4]=b(" Email: ")),d("span",ge,v(o.userData.email),1)])]),_:1})]),_:1}),e(T,null,{default:a(()=>[e(I,null,{default:a(()=>[d("h6",xe,[t[5]||(t[5]=b(" Teléfono: ")),d("span",De,v(o.userData.cod_phone)+" "+v(o.userData.phone),1)])]),_:1})]),_:1}),e(T,null,{default:a(()=>[e(I,null,{default:a(()=>[d("h6",Ce,[t[6]||(t[6]=b(" Rol: ")),(m(!0),U(R,null,z(o.userData.roles,(l,_)=>(m(),U("span",{key:_},[d("span",Ue,v(l),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),e(A,{class:"d-flex justify-center"},{default:a(()=>[e(E,{variant:"elevated",class:"me-4",onClick:t[0]||(t[0]=l=>n.value=!0)},{default:a(()=>t[8]||(t[8]=[b(" Editar ")])),_:1}),e(E,{variant:"elevated",class:"me-4",color:"error",onClick:w},{default:a(()=>t[9]||(t[9]=[b(" Cerrar sesión ")])),_:1})]),_:1})]),_:1})):G("",!0)]),_:1})]),_:1}),e(L,{"is-dialog-visible":s(n),"onUpdate:isDialogVisible":t[1]||(t[1]=l=>D(n)?n.value=l:null),onProfileUpdated:c,"user-data":o.userData},null,8,["is-dialog-visible","user-data"]),e(u,{"is-dialog-visible":s(y),"onUpdate:isDialogVisible":t[2]||(t[2]=l=>D(y)?y.value=l:null)},null,8,["is-dialog-visible"])],64)}}},Pe=oe(ke,[["__scopeId","data-v-12df12a0"]]),ga={__name:"myperfil",async setup(F){let k,o;const n=p(null),{getById:y,user:g}=se(),C=[{icon:"tabler-lock",title:"Seguridad"}],f=async()=>{const w=q("userData").value.id;await y(w)},c=async()=>{await f()};[k,o]=H(()=>f()),await k,o();const V=J(()=>g.value);return(w,r)=>s(V)?(m(),P($,{key:0},{default:a(()=>[e(x,{cols:"12",md:"5",lg:"4"},{default:a(()=>[e(Pe,{"user-data":s(V),onProfileUpdated:c},null,8,["user-data"])]),_:1}),e(x,{cols:"12",md:"7",lg:"8"},{default:a(()=>[e(me,{modelValue:s(n),"onUpdate:modelValue":r[0]||(r[0]=t=>D(n)?n.value=t:null),class:"v-tabs-pill"},{default:a(()=>[(m(),U(R,null,z(C,t=>e(pe,{key:t.icon},{default:a(()=>[e(K,{size:18,icon:t.icon,class:"me-1"},null,8,["icon"]),d("span",null,v(t.title),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(fe,{modelValue:s(n),"onUpdate:modelValue":r[1]||(r[1]=t=>D(n)?n.value=t:null),class:"mt-6 disable-tab-transition",touch:!1},{default:a(()=>[e(ce,null,{default:a(()=>[e(Ve)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(m(),P(B,{key:1},{default:a(()=>[e(Y,{class:"text-center"},{default:a(()=>r[2]||(r[2]=[b(" No User Found ")])),_:1})]),_:1}))}};export{ga as default};
