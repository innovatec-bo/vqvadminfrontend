import{$ as a}from"./api-8c028b5b.js";import{a as v,b as h,s as _,c as T,e as g}from"./notifications-81bc0416.js";import{ac as w,r as n,k as E,a2 as m}from"./index-a89e4ce9.js";import{D as d,L as y}from"./constants-ebd1a512.js";const A=async o=>await a("/property",{method:"POST",body:o}),N=async o=>await a(`/property/${o}`,{method:"GET"}),$=async o=>await a("/properties",{method:"GET",params:o}),j=async(o,l)=>await a(`/project/${l}/properties`,{method:"GET",params:o}),R=async(o,l)=>await a(`/property/${o}`,{method:"PATCH",body:l}),x=async o=>await a(`/property${o}`,{method:"DELETE"}),C=async o=>await a(`/properties/${o}`,{method:"GET"}),G=async()=>await a("/available/properties",{method:"GET"});function q(){w("userData").value;const o=n(!1),l=n(null),P=E(),f=n(null),c=n([]),b=n([]),p=n(0);return{loadingProperty:o,error:l,addProperty:async e=>{o.value=!0,l.value=null;try{console.log("este es el formulario:",e);const t={1:"DEPARTAMENT",2:"PARK"}[e.propertyDetails.propertyType.value]||"UNKNOWN";console.log(t);const s={code:e.propertyDetails.code,surface:e.propertyFeatures.surface,description:e.propertyDetails.description,delivery_date:e.propertyDetails.deliveryDate,base_price:e.propertyDetails.price,percentage_initial_fee:e.propertyDetails.percentageinitialfee,property_type:t,property_type_id:e.propertyDetails.propertyType.value,project_id:e.propertyDetails.projectType.value,benefits:e.propertyFeatures.benefitsDetails.map(u=>u.value),features:e.propertyFeatures.featureDetails.map(u=>u.value),type_department_id:t===d?e.propertyFeatures.typeDepartmentsDetails.value:null,number_bathrooms:t!==y?e.propertyFeatures.bathroomCount:"",number_bedrooms:t!==y?e.propertyFeatures.bedroomCount:"",number_floors:t!==y&&t!==d?e.propertyFeatures.floorNo:"",floors:t===d?e.propertyFeatures.floor:"",number_rooms:""};console.log(s);const i=await A(s);console.log("Respuesta del servidor:",i),v("Se Agrego una nueva Propiedad","La propiedad fue registrada exitosamente en el sistema de inventario."),P.push("/realty/property/list")}catch(r){console.log(r),r.response&&r.response.status==422&&h("Advertencia","Faltan Datos por Rellenar")}finally{o.value=!1}},editProperty:async e=>{var r,t;o.value=!0,l.value=null;try{const s={title:e.title,code:e.code,surface:e.surface,base_price:e.base_price,percentage_initial_fee:e.percentage_initial_fee,property_type:e.property_type,number_bathrooms:((r=e==null?void 0:e.departament)==null?void 0:r.number_bathrooms)??"",number_bedrooms:((t=e==null?void 0:e.departament)==null?void 0:t.number_bedrooms)??"",covered:!!(e!=null&&e.covered)},i=await R(e.id,s);return console.log(i),_("¡Propiedad actualizada exitosamente!","Los detalles de la propiedad han sido editados y guardados correctamente."),{success:!0,message:"Actualización Exitosa"}}catch(s){return console.log(s),s.response&&s.response.status==422?(T("Validación fallida","Faltan datos por rellenar"),{success:!1,message:"Validación fallida"}):(g("Advertencia","Hubo un problema al actualizar la propiedad."),{success:!1,message:"Error de actualización"})}finally{o.value=!1}},getPropertyId:async e=>{try{const r=await N(e);f.value=r.data}catch(r){console.log(r)}},allProperty:async e=>{try{const r=await $(e);console.log("respuesta",r),c.value=r.data.data,p.value=r.data.total}catch(r){console.log(r)}},allPropertybyProject:async(e,r)=>{try{const t=await j(e,r);console.log("respuesta",t),c.value=t.data.data,p.value=t.data.total}catch(t){console.log(t)}},propertiesForType:async e=>{try{const r=await C(e);return b.value=r.data,console.log("propertyfortype ",r.data),r.data}catch(r){console.log(r)}},removeProperty:async e=>{try{const r=await x(e);console.log(r),v("Elimino una Propidad Correctamente","Se Acaba de eliminar una propiedad con exito del sistema de inventario.")}catch(r){console.log(r)}},propertiesAvailbles:async e=>{try{const r=await G(e);return c.value=r.data,console.log("propertyfortype ",r.data),r.data}catch(r){console.log(r)}},properties:m(()=>c.value),property:f,totalProperties:m(()=>p.value)}}export{q as u};
