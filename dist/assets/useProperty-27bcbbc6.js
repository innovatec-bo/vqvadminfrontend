import{$ as a}from"./api-a016fed6.js";import{a as v,b as h,s as T,c as g,e as w}from"./notifications-81bc0416.js";import{ac as E,r as n,k as A,a2 as b}from"./index-b2b9c5e3.js";import{D as d,L as y}from"./constants-ca8ca994.js";const N=async o=>await a("/property",{method:"POST",body:o}),$=async o=>await a(`/property/${o}`,{method:"GET"}),j=async o=>await a("/properties",{method:"GET",params:o}),R=async(o,l)=>await a(`/project/${l}/properties`,{method:"GET",params:o}),x=async(o,l)=>await a(`/property/${o}`,{method:"PATCH",body:l}),C=async o=>await a(`/property${o}`,{method:"DELETE"}),G=async o=>await a(`/properties/${o}`,{method:"GET"}),S=async()=>await a("/available/properties",{method:"GET"});function J(){E("userData").value;const o=n(!1),l=n(null),P=A(),f=n(null),i=n([]),_=n([]),p=n(0);return{loadingProperty:o,error:l,addProperty:async e=>{o.value=!0,l.value=null;try{console.log("este es el formulario:",e);const r={1:"DEPARTAMENT",2:"PARK"}[e.propertyDetails.propertyType.value]||"UNKNOWN";console.log(r);const c={code:e.propertyDetails.code,surface:e.propertyFeatures.surface,description:e.propertyDetails.description,delivery_date:e.propertyDetails.deliveryDate,base_price:e.propertyDetails.price,percentage_initial_fee:e.propertyDetails.percentageinitialfee,property_type:r,property_type_id:e.propertyDetails.propertyType.value,project_id:e.propertyDetails.projectType.value,benefits:e.propertyFeatures.benefitsDetails.map(t=>t.value),features:e.propertyFeatures.featureDetails.map(t=>t.value),type_department_id:r===d?e.propertyFeatures.typeDepartmentsDetails.value:null,number_bathrooms:r!==y?e.propertyFeatures.bathroomCount:"",number_bedrooms:r!==y?e.propertyFeatures.bedroomCount:"",number_floors:r!==y&&r!==d?e.propertyFeatures.floorNo:"",floors:r===d?e.propertyFeatures.floor:"",number_rooms:""};console.log(c);const u=await N(c);console.log("Respuesta del servidor:",u),v("Se Agrego una nueva Propiedad","La propiedad fue registrada exitosamente en el sistema de inventario."),P.push("/realty/property/list")}catch(s){console.log(s),s.response&&s.response.status==422&&h("Advertencia","Faltan Datos por Rellenar")}finally{o.value=!1}},editProperty:async e=>{var s,r,c,u;o.value=!0,l.value=null;try{const t={title:e.title,code:e.code,surface:e.surface,base_price:e.base_price,percentage_initial_fee:e.percentage_initial_fee,property_type:e.property_type,number_bathrooms:((s=e==null?void 0:e.departament)==null?void 0:s.number_bathrooms)??"",number_bedrooms:((r=e==null?void 0:e.departament)==null?void 0:r.number_bedrooms)??"",surface_balcony:((c=e==null?void 0:e.departament)==null?void 0:c.surface_balcony)??"",is_balcony:(u=e==null?void 0:e.departament)==null?void 0:u.is_balcony,covered:!!(e!=null&&e.covered)},m=await x(e.id,t);return console.log(m),T("¡Propiedad actualizada exitosamente!","Los detalles de la propiedad han sido editados y guardados correctamente."),{success:!0,message:"Actualización Exitosa"}}catch(t){return console.log(t),t.response&&t.response.status==422?(g("Validación fallida","Faltan datos por rellenar"),{success:!1,message:"Validación fallida"}):(w("Advertencia","Hubo un problema al actualizar la propiedad."),{success:!1,message:"Error de actualización"})}finally{o.value=!1}},getPropertyId:async e=>{try{const s=await $(e);f.value=s.data}catch(s){console.log(s)}},allProperty:async e=>{try{const s=await j(e);console.log("respuesta",s),i.value=s.data.data,p.value=s.data.total}catch(s){console.log(s)}},allPropertybyProject:async(e,s)=>{try{const r=await R(e,s);console.log("respuesta",r),i.value=r.data.data,p.value=r.data.total}catch(r){console.log(r)}},propertiesForType:async e=>{try{const s=await G(e);return _.value=s.data,console.log("propertyfortype ",s.data),s.data}catch(s){console.log(s)}},removeProperty:async e=>{try{const s=await C(e);console.log(s),v("Elimino una Propidad Correctamente","Se Acaba de eliminar una propiedad con exito del sistema de inventario.")}catch(s){console.log(s)}},propertiesAvailbles:async e=>{try{const s=await S(e);return i.value=s.data,console.log("propertyfortype ",s.data),s.data}catch(s){console.log(s)}},properties:b(()=>i.value),property:f,totalProperties:b(()=>p.value)}}export{J as u};
