import{a as M}from"./formatters-58bf909e.js";import{u as U,_ as F}from"./BitacoraCustomer-c2974e1a.js";import{u as H}from"./useCustomer-f2041fe2.js";import{V as P}from"./VRow-a5449575.js";import{V as $}from"./VCol-6b79a532.js";import{o as r,f as V,e as l,b as e,c as i,F as g,i as b,d as t,x as s,$ as I,v as y,n as p,z as w,a as B,r as G,j as K,H as W,a4 as O,a0 as j}from"./index-eea64eab.js";import{V as D,b as Q}from"./VCard-1446dd49.js";import{u as Y}from"./useProcess-3da37060.js";import{f as q}from"./currencyFormatter-92ad4b3c.js";import{V as T}from"./VCardText-74af991a.js";import{V as J}from"./VChip-d184a964.js";import{V as N}from"./VTooltip-60d6696f.js";import{V as L}from"./VTable-1594d059.js";import{u as X}from"./useSales-8d5565b3.js";import{V as z}from"./VCheckbox-d0024d7a.js";import{V as Z}from"./VDivider-f3ea9039.js";import{V as tt,a as A,b as E}from"./VList-b205d3fa.js";import{V as et,a as lt}from"./VTabs-f417034b.js";import{V as ot,a as S}from"./VWindowItem-122fe088.js";import"./helpers-61e4df1a.js";import"./api-40e7a553.js";import"./index-9c720871.js";import"./constants-71880aa6.js";import"./notifications-b6da0b75.js";import"./VTimelineItem-bc1b2333.js";import"./VAvatar-596ec46a.js";import"./VImg-bf97f22a.js";import"./VOverlay-9f45cad7.js";import"./easing-9f15041e.js";import"./lazy-8a330c44.js";import"./scopeId-752bc43e.js";import"./forwardRefs-8348545e.js";import"./VCheckboxBtn-11740b93.js";import"./VSelectionControl-1cd7c46d.js";import"./form-97d5e662.js";import"./VInput-b54c7b33.js";import"./ssrBoot-d631879b.js";import"./VSlideGroup-ef9af4c0.js";const st={class:"d-flex justify-content-between"},nt={style:{"flex-grow":"1"}},at={class:"d-flex align-center mt-2",style:{"font-size":"small"}},rt={class:"ms-2"},ut={class:"d-flex align-center",style:{"font-size":"small"}},dt={class:"ms-2"},it={class:"d-flex gap-x-4 justify-end mt-2",style:{"font-size":"small"}},ct={class:"d-flex align-center"},pt={class:"ms-2"},mt={class:"d-flex align-center"},ft={class:"ms-2"},_t={__name:"customerActivity",props:{activities:{type:Object,required:!0}},setup(k){const _=k,x=a=>a==="PENDING"?"Pendiente":a==="COMPLETED"?"Completada":a==="DISCARD"?"Descartada":a==="CANCELLED"?"Cancelada":a,h=a=>{const f=new Date(a),m=f.getDate(),n=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][f.getMonth()],o=f.getHours().toString().padStart(2,"0"),C=f.getMinutes().toString().padStart(2,"0");return`${m} de ${n}, ${o}:${C}`};return(a,f)=>(r(),V(D,{title:"Activities"},{default:l(()=>[e(P,{class:"mx-5 my-2"},{default:l(()=>[(r(!0),i(g,null,b(_.activities,m=>(r(),V($,{key:m.id,cols:"4.5",class:"border my-2 mx-2"},{default:l(()=>[t("div",st,[t("div",nt,[t("strong",null,s(m.title),1)]),t("div",null,[t("strong",null," Asesor: "+s(m.name_assigned),1)])]),t("span",null,s(m.description),1),t("span",at,[f[0]||(f[0]=t("span",null,"Creado:",-1)),t("span",rt,s(h(m.created_at)),1)]),t("span",ut,[f[1]||(f[1]=t("span",null,"Programado:",-1)),t("span",dt,s(h(m.scheduled_at)),1)]),t("div",it,[t("span",ct,[e(I,{color:"primary",icon:"tabler-capture",size:"18"}),t("strong",pt,s(m.type_activity),1)]),t("span",mt,[e(I,{color:"primary",icon:"tabler-circle-dotted",size:"18"}),t("strong",ft,s(x(m.state_activity)),1)])])]),_:2},1024))),128))]),_:1})]),_:1}))}},yt={class:"d-flex justify-content-between"},ht={style:{"flex-grow":"1"}},Ct={class:"my-5"},gt={key:0,class:"d-flex flex-wrap gap-2"},bt={key:1},Vt={__name:"customeropportunity",props:{opportunities:{type:Object,required:!0}},emits:["refreshCustomer"],setup(k,{emit:_}){const x=k,h=_,{checkProcessForOpportunity:a}=Y(),f=async(c,n,o)=>{console.log(`Procedimiento ${c} marcado como: ${o?"realizado":"no realizado"}`),await a(n,c,{is_check:!o}),h("refreshCustomer")},m=(c,n)=>c===0?"Última oportunidad":c===n-1?"Primera oportunidad":`${n-c}ª oportunidad`;return(c,n)=>(r(),V(P,null,{default:l(()=>[e($,{cols:"12"},{default:l(()=>[(r(!0),i(g,null,b(x.opportunities,(o,C)=>(r(),V(D,{key:o.id,class:"mb-3"},{default:l(()=>[e(T,null,{default:l(()=>[t("div",yt,[t("div",ht,[t("h2",null,s(m(C,x.opportunities.length)),1)]),t("div",null,[t("strong",null," Fecha: "+s(o.start_date),1)])]),t("div",null,[t("span",null,[n[0]||(n[0]=t("strong",null," Estado: ",-1)),y(" "+s(o.stage.title),1)]),n[3]||(n[3]=t("br",null,null,-1)),n[4]||(n[4]=t("strong",null,"Propiedad de Interes: ",-1)),t("span",null,s(o.property.title)+" | "+s(p(q)(o.property.base_price))+" | "+s(o.property.surface)+" m2 ",1),t("div",Ct,[n[2]||(n[2]=t("h3",{class:"my-1"}," Procesos ",-1)),o.procedure&&o.procedure.length>0?(r(),i("div",gt,[(r(!0),i(g,null,b(o.procedure,v=>(r(),i("div",{key:v.id},[e(J,{color:v.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:d=>f(v.id,o.id,v.pivot.is_check)},{default:l(()=>[v.pivot.is_check?(r(),V(I,{key:0,icon:"tabler-check",class:"mr-2"})):w("",!0),y(" "+s(v.title),1)]),_:2},1032,["color","onClick"]),e(N,{activator:"parent",location:"top"},{default:l(()=>[y(s(v.pivot.is_check?"Deshacer Proceso":"Confirmar Proceso"),1)]),_:2},1024)]))),128))])):(r(),i("div",bt,n[1]||(n[1]=[t("span",null,"No hay procedimientos disponibles.",-1)])))])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}},xt={class:"my-2"},vt={class:"my-2"},kt={class:"d-flex items-center gap-x-2"},$t={__name:"customerQuote",props:{quotes:{type:Object,required:!0}},setup(k){const _=k,x=h=>h==="CASH"?"Al Contado":h==="DIRECTCREDIT"?"Crédito Directo":h==="BANKCREDIT"?"Crédito Bancario":h;return(h,a)=>{const f=B("IconBtn"),m=B("RouterLink");return r(),V(P,null,{default:l(()=>[e($,{cols:"12"},{default:l(()=>[e(D,{title:"Cotizaciones"},{default:l(()=>[e(T),e(L,{density:"compact",class:"text-no-wrap my-2"},{default:l(()=>[a[0]||(a[0]=t("thead",null,[t("tr",null,[t("th",null," Metodo de Pago "),t("th",null," Propiedades "),t("th",null," Total "),t("th",null," Gerencia "),t("th",null," Cliente "),t("th",null," Accion ")])],-1)),t("tbody",null,[(r(!0),i(g,null,b(_.quotes,c=>(r(),i("tr",{key:c.id},[t("td",null,s(x(c.payment_method)),1),t("td",null,[(r(!0),i(g,null,b(c.properties,n=>(r(),i("div",{key:n.id,class:"d-flex gap-x-2"},s(n.title)+" | "+s(n.code),1))),128))]),t("td",null,[t("span",xt,s(c.status==="APPROVED"?"Aprobado":"No Aprobado"),1)]),t("td",null,[t("span",vt,s(c.status_customer==="APPROVED"?"Aprobado":"No Aprobado"),1)]),t("td",null,s(c.creation_date),1),t("td",null,[t("div",kt,[e(m,{to:{name:"quote-id",params:{id:c.id}}},{default:l(()=>[e(f,null,{default:l(()=>[e(I,{icon:"tabler-eye"})]),_:1})]),_:2},1032,["to"])])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})}}},Pt={class:"d-flex items-center gap-x-2"},Dt={__name:"customerSale",props:{sales:{type:Object,required:!0}},setup(k){const _=k,{confirmPaymentPlans:x}=U(),{SaleChangeSignature:h}=X(),a=async n=>{console.log(n),await x(n),emit("updateStageId",_.opportunity.id)},f=async n=>{console.log("entra a firma"),await h(n)},m=n=>n==="CASH"?"Al Contado":n==="DIRECTCREDIT"?"Crédito Directo":n==="BANKCREDIT"?"Crédito Bancario":n,c=n=>n==="SALE"?"VENDIDO":n==="DISCARD"?"CANCELADO":n==="DELIVERY"?"ENTREGADO":n;return(n,o)=>{const C=B("IconBtn"),v=B("RouterLink");return r(),i(g,null,[e(P,null,{default:l(()=>[e($,{cols:"12"},{default:l(()=>[e(D,{title:"Ventas"},{default:l(()=>[e(L,{density:"compact",class:"text-no-wrap my-2"},{default:l(()=>[o[1]||(o[1]=t("thead",null,[t("tr",null,[t("th",null," ID "),t("th",null," Metodo de Pago "),t("th",null," Propiedades "),t("th",null," Total "),t("th",null," Estado "),t("th",null," Fecha "),t("th",null," Accion ")])],-1)),t("tbody",null,[(r(!0),i(g,null,b(_.sales,d=>(r(),i("tr",{key:d.id},[t("td",null,s(d.id),1),t("td",null,s(m(d.payment_method)),1),t("td",null,[(r(!0),i(g,null,b(d.properties,u=>(r(),i("div",{key:u.id,class:"d-flex gap-x-2"},s(u.title)+" | "+s(u.code),1))),128))]),t("td",null,s(("formatCurrency"in n?n.formatCurrency:p(q))(d.amount)),1),t("td",null,s(c(d.status)),1),t("td",null,s(d.creation_date),1),t("td",null,[t("div",Pt,[e(v,{to:{name:"sale-id",params:{id:d.id}}},{default:l(()=>[e(C,null,{default:l(()=>[e(I,{icon:"tabler-eye"})]),_:1})]),_:2},1032,["to"]),e(z,{modelValue:d.confirmation_signature,"onUpdate:modelValue":u=>d.confirmation_signature=u,"true-value":1,"false-value":0,onChange:u=>f(d.id)},{default:l(()=>[e(N,{activator:"parent",location:"top"},{default:l(()=>o[0]||(o[0]=[y(" Confirmar firma ")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),(r(!0),i(g,null,b(_.sales,d=>(r(),i("div",{key:d.id,class:"my-5"},[d.status!="DISCARD"?(r(),V(D,{key:0},{default:l(()=>[e(T,null,{default:l(()=>[t("h3",null," Venta: "+s(d.id),1),o[8]||(o[8]=t("br",null,null,-1)),e(P,null,{default:l(()=>[e($,{col:"6",class:"border mx-2"},{default:l(()=>[o[4]||(o[4]=t("strong",null," Cuotas Iniciales ",-1)),d.initial_payments&&d.initial_payments.length>0?(r(),V(L,{key:0,density:"compact",class:"text-no-wrap my-2"},{default:l(()=>[o[3]||(o[3]=t("thead",null,[t("tr",null,[t("th",null," Fecha "),t("th",null," Monto "),t("th",null," Estado "),t("th",null," Action ")])],-1)),t("tbody",null,[(r(!0),i(g,null,b(d.initial_payments,u=>(r(),i("tr",{key:u.id},[t("td",null,s(u.date),1),t("td",null,s(u.amount),1),t("td",null,s(u.is_paid?"Pagado":"Pendiente"),1),t("td",null,[e(z,{modelValue:u.is_paid,"onUpdate:modelValue":R=>u.is_paid=R,"true-value":1,"false-value":0,disabled:u.is_paid===1,onChange:R=>a(u.id)},{default:l(()=>[e(N,{activator:"parent",location:"top"},{default:l(()=>o[2]||(o[2]=[y(" Confirmar Pago ")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])])]))),128))])]),_:2},1024)):w("",!0)]),_:2},1024),e($,{col:"6",class:"border mx-2"},{default:l(()=>[o[7]||(o[7]=t("strong",null," Saldos ",-1)),d.balance_payments&&d.balance_payments.length>0?(r(),V(L,{key:0,density:"compact",class:"text-no-wrap my-2"},{default:l(()=>[o[6]||(o[6]=t("thead",null,[t("tr",null,[t("th",null," Fecha "),t("th",null," Monto "),t("th",null," Estado "),t("th",null," Action ")])],-1)),t("tbody",null,[(r(!0),i(g,null,b(d.balance_payments,u=>(r(),i("tr",{key:u.id},[t("td",null,s(u.date),1),t("td",null,s(u.amount),1),t("td",null,s(u.is_paid?"Pagado":"Pendiente"),1),t("td",null,[e(P,null,{default:l(()=>[e(z,{modelValue:u.is_paid,"onUpdate:modelValue":R=>u.is_paid=R,"true-value":1,"false-value":0,disabled:u.is_paid===1,onChange:R=>a(u.id)},{default:l(()=>[e(N,{activator:"parent",location:"top"},{default:l(()=>o[5]||(o[5]=[y(" Confirmar Pago ")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:2},1024)])]))),128))])]),_:2},1024)):w("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):w("",!0)]))),128))],64)}}},At={class:"text-5xl font-weight-medium"},Et={class:"text-h4 mt-4"},Tt={class:"text-h6"},It={class:"text-body-1"},Rt={class:"text-h6"},St={class:"text-body-1"},wt={class:"text-h6"},Nt={class:"text-body-1"},Lt={class:"text-h6"},Bt={class:"text-body-1"},zt={class:"text-h6"},Ot={class:"text-body-1"},jt={class:"text-h6"},qt={class:"text-body-1"},Pe={__name:"[id]",setup(k){const _=G(null),x=K(),{getPerfilCutomerbyId:h,customer:a,loading:f}=H(),m=[{icon:"tabler-users",title:"Oportunidades"},{icon:"tabler-star",title:"Actividades"},{icon:"tabler-currency-dollar",title:"Cotizaciones"},{icon:"tabler-cash",title:"ventas"},{icon:"tabler-table",title:"Bitacora"}],c=async()=>{try{await h(x.params.id)}catch(n){console.error("Error al obtener la cotización:",n)}};return W(()=>{c(),console.log(a)}),(n,o)=>p(a)?(r(),V(P,{key:0},{default:l(()=>[e($,{cols:"12",md:"3"},{default:l(()=>[e(D,null,{default:l(()=>[e(T,{class:"text-center pt-15"},{default:l(()=>[t("span",At,s(("avatarText"in n?n.avatarText:p(M))(p(a).customer.name)),1),t("h6",Et,s(p(a).customer.name),1)]),_:1}),e(Z),e(T,null,{default:l(()=>[o[8]||(o[8]=t("p",{class:"text-sm text-uppercase text-disabled"}," Detalles ",-1)),e(tt,{class:"card-list mt-2"},{default:l(()=>[e(A,null,{default:l(()=>[e(E,null,{default:l(()=>[t("h6",Tt,[o[2]||(o[2]=y(" Nombre: ")),t("span",It,s(p(a).customer.name),1)])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(E,null,{default:l(()=>[t("h6",Rt,[o[3]||(o[3]=y(" Email: ")),t("span",St,s(p(a).customer.email),1)])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(E,null,{default:l(()=>[t("h6",wt,[o[4]||(o[4]=y(" Numero: ")),t("span",Nt,s(p(a).customer.cod_phone)+s(p(a).customer.phone),1)])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(E,null,{default:l(()=>[t("h6",Lt,[o[5]||(o[5]=y(" Lugar de Trabajo: ")),t("span",Bt,s(p(a).customer.workplace),1)])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(E,null,{default:l(()=>[t("h6",zt,[o[6]||(o[6]=y(" Carnet: ")),t("span",Ot,s(p(a).customer.ci),1)])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(E,null,{default:l(()=>[t("h6",jt,[o[7]||(o[7]=y(" Tipo de Cliente: ")),t("span",qt,s(p(a).customer.type_customer),1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(T,{class:"d-flex justify-center"},{default:l(()=>[e(O,{variant:"elevated",class:"me-4"},{default:l(()=>o[9]||(o[9]=[y(" Edit ")])),_:1}),e(O,{variant:"tonal",color:"error"},{default:l(()=>o[10]||(o[10]=[y(" Suspend ")])),_:1})]),_:1})]),_:1})]),_:1}),e($,{cols:"12",md:"9"},{default:l(()=>[e(et,{modelValue:p(_),"onUpdate:modelValue":o[0]||(o[0]=C=>j(_)?_.value=C:null),class:"v-tabs-pill"},{default:l(()=>[(r(),i(g,null,b(m,C=>e(lt,{key:C.icon},{default:l(()=>[e(I,{size:18,icon:C.icon,class:"me-1"},null,8,["icon"]),t("span",null,s(C.title),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(ot,{modelValue:p(_),"onUpdate:modelValue":o[1]||(o[1]=C=>j(_)?_.value=C:null),class:"mt-6 disable-tab-transition",touch:!1},{default:l(()=>[e(S,null,{default:l(()=>[e(Vt,{opportunities:p(a).opportunities,onRefreshCustomer:c},null,8,["opportunities"])]),_:1}),e(S,null,{default:l(()=>[e(_t,{activities:p(a).activities},null,8,["activities"])]),_:1}),e(S,null,{default:l(()=>[e($t,{quotes:p(a).quotes},null,8,["quotes"])]),_:1}),e(S,null,{default:l(()=>[e(Dt,{sales:p(a).sales},null,8,["sales"])]),_:1}),e(S,null,{default:l(()=>[e(F,{customer:p(a).customer.id},null,8,["customer"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(r(),V(D,{key:1},{default:l(()=>[e(Q,{class:"text-center"},{default:l(()=>[y(s(p(f)?"Cargando":"Cliente no encontrado"),1)]),_:1})]),_:1}))}};export{Pe as default};
