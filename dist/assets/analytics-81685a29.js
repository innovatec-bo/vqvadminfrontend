import{_ as G}from"./AppDateTimePicker-ad98d1e4.js";import{_ as J}from"./AppSelect-5767fb17.js";import{u as K,f as U}from"./dateFormatter-ae7e0a76.js";import{u as Q}from"./useProject-e347a04d.js";import{L as Z}from"./LogisticsCardStatistics-0f2c1d48.js";import{_ as T}from"./AppCardActions-cb949be4.js";import{m as $}from"./vue3-apexcharts-02e346db.js";import{a as W}from"./VCard-1446dd49.js";import{V as O}from"./VCardText-74af991a.js";import{r as d,w as P,o as y,f as A,e as s,b as a,d as b,c as R,F as ee,i as te,x as j,z as N,H as ae,v as Y,a4 as oe,n as h}from"./index-eea64eab.js";import{V as M}from"./VRow-a5449575.js";import{V as v}from"./VCol-6b79a532.js";import{V as se}from"./VBadge-b40242ef.js";import{V as le,a as re,b as ie,c as ne}from"./VExpansionPanel-cc86bf04.js";import"./VField-cbcf2eef.js";import"./form-97d5e662.js";import"./easing-9f15041e.js";import"./VInput-b54c7b33.js";import"./VImg-bf97f22a.js";import"./VSelect-c4493e38.js";import"./VTextField-fdaf4f5a.js";/* empty css                   */import"./VCounter-1694484c.js";import"./forwardRefs-8348545e.js";import"./VList-b205d3fa.js";import"./ssrBoot-d631879b.js";import"./VAvatar-596ec46a.js";import"./VDivider-f3ea9039.js";import"./dialog-transition-46c42648.js";import"./VMenu-054aa5e8.js";import"./VOverlay-9f45cad7.js";import"./lazy-8a330c44.js";import"./scopeId-752bc43e.js";import"./VCheckboxBtn-11740b93.js";import"./VSelectionControl-1cd7c46d.js";import"./VChip-d184a964.js";import"./api-40e7a553.js";import"./index-9c720871.js";import"./constants-71880aa6.js";import"./notifications-b6da0b75.js";import"./currencyFormatter-92ad4b3c.js";import"./_plugin-vue_export-helper-c27b6911.js";const pe="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",de="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",ue={__name:"ProductStatusStatistics",props:{data:{type:Object,required:!0},isLoading:{type:Boolean,required:!0}},setup(x){const o=x,t={donut:{series1:"#666666",series2:"#474747",series3:"#292929",series4:"#0A0A0A"}},c=d([]),f=d({chart:{height:400,type:"donut",toolbar:{show:!1}},plotOptions:{pie:{donut:{size:"75%",labels:{show:!0,value:{fontSize:"26px",color:pe,fontWeight:500,offsetY:-15,formatter(e){return`${Number.parseInt(e)} Unidades`}},name:{offsetY:30},total:{show:!0,fontSize:"0.75rem",fontWeight:400,label:"Total",color:de,formatter(){return`${o.data.total_property||0} Unidades`}}}}}},labels:["Disponibles","Vendidas","En entrega"],colors:[t.donut.series1,t.donut.series2,t.donut.series3,t.donut.series4],grid:{padding:{top:15}},stroke:{width:0},dataLabels:{enabled:!1},legend:{show:!0,position:"bottom",offsetY:10,markers:{width:8,height:8,offsetX:-3},itemMargin:{horizontal:15,vertical:5},fontSize:"13px",fontWeight:400},tooltip:{theme:"dark"},responsive:[{breakpoint:420,options:{chart:{height:200}}}]}),_=e=>{c.value=[e.total_property_available||0,e.total_property_sale||0,e.total_property_delivery||0]};return P(()=>o.data,e=>{_(e)},{immediate:!0,deep:!0}),(e,i)=>{const m=$,g=T;return y(),A(g,{loading:o.isLoading,"onUpdate:loading":i[0]||(i[0]=l=>o.isLoading=l),noActions:""},{default:s(()=>[a(W,{title:"Análisis del producto"}),a(O,null,{default:s(()=>[a(m,{type:"donut",height:"400",series:c.value,options:f.value},null,8,["series","options"])]),_:1})]),_:1},8,["loading"])}}};const ce={class:"d-flex flex-wrap gap-x-2 gap-y-4 mx-auto"},me={class:"text-body-1",style:{"min-inline-size":"90px"}},ge={class:"text-h4"},fe={__name:"SalesFunnelStatistics",props:{data:{type:Object,required:!0},isLoading:{type:Boolean,required:!0}},setup(x){const o=x,t={bar:{series1:"#858585",series2:"#666666",series3:"#474747",series4:"#292929",series5:"#0A0A0A"}},c=d([{data:[o.data.total_leads,o.data.total_prospect,o.data.total_presales,o.data.total_sales,o.data.total_delivery]}]),f=d({chart:{height:270,type:"bar",toolbar:{show:!1}},plotOptions:{bar:{horizontal:!0,barHeight:"70%",distributed:!0,startingShape:"rounded",borderRadius:7}},labels:[],colors:[t.bar.series1,t.bar.series2,t.bar.series3,t.bar.series4,t.bar.series5],grid:{strokeDashArray:10,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:-35,bottom:-12}},dataLabels:{enabled:!0,style:{colors:["#fff"],fontWeight:200,fontSize:"13px"},offsetX:0,dropShadow:{enabled:!1},formatter(e,i){return f.value.labels[i.dataPointIndex]}},legend:{show:!1},tooltip:{enabled:!0,style:{fontSize:"12px"},onDatasetHover:{highlightDataSeries:!1}},xaxis:{categories:["Lead","Prospecto","Preventa","Venta","Entrega"],axisBorder:{show:!1},axisTicks:{show:!1},labels:{style:{colors:"rgba(var(--v-theme-on-background), var(--v-disabled-opacity))",fontSize:"13px"},formatter(e){return`${e}`}}},yaxis:{labels:{style:{colors:"rgba(var(--v-theme-on-background), var(--v-disabled-opacity))",fontSize:"13px"}}}}),_=d([{title:"Lead",value:o.data.total_leads,color:t.bar.series1},{title:"Prospecto",value:o.data.total_prospect,color:t.bar.series2},{title:"Preventa",value:o.data.total_presales,color:t.bar.series3},{title:"Venta",value:o.data.total_sales,color:t.bar.series4},{title:"Entrega",value:o.data.total_delivery,color:t.bar.series5}]);return P(()=>o.data,e=>{c.value[0].data=[e.total_leads,e.total_prospect,e.total_presales,e.total_sales,e.total_delivery],_.value=[{title:"Lead",value:e.total_leads,color:t.bar.series1},{title:"Prospecto",value:e.total_prospect,color:t.bar.series2},{title:"Preventa",value:e.total_presales,color:t.bar.series3},{title:"Venta",value:e.total_sales,color:t.bar.series4},{title:"Entrega",value:e.total_delivery,color:t.bar.series5}]},{deep:!0}),(e,i)=>{const m=$,g=T;return y(),A(g,{loading:o.isLoading,"onUpdate:loading":i[0]||(i[0]=l=>o.isLoading=l),noActions:""},{default:s(()=>[a(W,{title:"Reporte por etapas"}),a(O,null,{default:s(()=>[a(M,null,{default:s(()=>[a(v,{cols:"12",md:"12"},{default:s(()=>[b("div",null,[a(m,{type:"bar",height:"300",series:c.value,options:f.value},null,8,["series","options"])])]),_:1}),a(v,{cols:"12",md:"12"},{default:s(()=>[b("div",ce,[(y(!0),R(ee,null,te(_.value,l=>(y(),R("div",{key:l.title,class:"d-flex gap-x-1"},[a(se,{dot:"",inline:"",class:"mt-1 custom-badge",color:l.color},null,8,["color"]),b("div",null,[b("div",me,j(l.title),1),b("h4",ge,j(l.value),1)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])}}};const _e="rgba(var(--v-theme-on-background), var(--v-high-emphasis-opacity))",q="rgba(var(--v-theme-on-background), var(--v-medium-emphasis-opacity))",he="rgba(var(--v-border-color), var(--v-border-opacity))",ve={__name:"SellerSalesStatistics",props:{data:{type:Object,required:!0},isLoading:{type:Boolean,required:!0}},setup(x){const o=x,t={line:{series1:"#858585",series2:"#666666",series3:"#474747",series4:"#292929",series5:"#0A0A0A"}},c=d([]),f=d({chart:{height:420,type:"line",stacked:!1,parentHeightOffset:0,toolbar:{show:!1},zoom:{enabled:!1}},plotOptions:{bar:{columnWidth:"30%",startingShape:"rounded",endingShape:"rounded",borderRadius:4}},colors:[t.line.series1,t.line.series2,t.line.series3,t.line.series4,t.line.series5],grid:{strokeDashArray:8,borderColor:he},markers:{size:3,colors:["#FFFFFF"],strokeColors:[t.line.series1,t.line.series2,t.line.series3,t.line.series4,t.line.series5],hover:{size:4},borderRadius:2},stroke:{curve:"smooth",width:[2,2,2,2,2],lineCap:"round"},dataLabels:{enabled:!1},legend:{show:!0,position:"bottom",markers:{width:8,height:8,offsetX:-3},height:40,itemMargin:{horizontal:10,vertical:0},fontSize:"15px",fontFamily:"Open Sans",fontWeight:400,labels:{colors:_e,useSeriesColors:!1},offsetY:10},fill:{opacity:[1,1,1,1,1]},xaxis:{tickAmount:10,categories:[],labels:{style:{colors:q,fontSize:"13px",fontWeight:400}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:q,fontSize:"13px",fontWeight:400},formatter(e){return`${e}`}}},responsive:[{breakpoint:1400,options:{chart:{height:320},xaxis:{labels:{style:{fontSize:"10px"}}},legend:{itemMargin:{vertical:0,horizontal:10},fontSize:"13px",offsetY:12}}},{breakpoint:1025,options:{chart:{height:415},plotOptions:{bar:{columnWidth:"50%"}}}},{breakpoint:982,options:{plotOptions:{bar:{columnWidth:"30%"}}}},{breakpoint:480,options:{chart:{height:250},legend:{offsetY:5}}}]}),_=e=>{var i,m,g,l,S,w;if(e!=null&&e.total_prospect){const D=(i=e.total_prospect)==null?void 0:i.map(n=>n.user.name),F=(m=e.total_prospect)==null?void 0:m.map(n=>n.lead_count),C=(g=e.total_prospect)==null?void 0:g.map(n=>n.prospect_count),V=(l=e.total_prospect)==null?void 0:l.map(n=>n.presale_count),z=(S=e.total_prospect)==null?void 0:S.map(n=>n.sale_count),k=(w=e.total_prospect)==null?void 0:w.map(n=>n.delivery_count);f.value.xaxis.categories=D,c.value=[{name:"Lead",type:"column",data:F},{name:"Prospecto",type:"line",data:C},{name:"Preventa",type:"line",data:V},{name:"Venta",type:"line",data:z},{name:"Entrega",type:"line",data:k}]}};return P(()=>o.data,e=>{_(e)},{immediate:!0,deep:!0}),(e,i)=>{const m=$,g=T;return y(),A(g,{loading:o.isLoading,"onUpdate:loading":i[0]||(i[0]=l=>o.isLoading=l),noActions:""},{default:s(()=>{var l;return[a(W,{title:"Reporte por vendedores"}),(l=x.data)!=null&&l.total_prospect?(y(),A(O,{key:0},{default:s(()=>[a(m,{id:"shipment-statistics",type:"line",height:"420",series:c.value,options:f.value},null,8,["series","options"])]),_:1})):N("",!0)]}),_:1},8,["loading"])}}};const be={class:"d-flex flex-wrap align-end mb-3 gap-x-5"},ye={style:{"min-inline-size":"15rem"}},xe={style:{"min-inline-size":"15rem"}},Se={key:0,style:{"min-inline-size":"15rem"}},ut={__name:"analytics",setup(x){const{logisticsCardData:o,salesFunnelData:t,productStatusData:c,sellerSalesData:f,fetchAnalyticsData:_,getLastWeekRange:e,getLastMonthRange:i,getCurrentMonthRange:m,getLastThreeMonthsRange:g,getYearToDateRange:l,isLoading:S,error:w}=K(),{getallProjects:D,projects:F}=Q(),C=d(0),V=d(1),z=d([]),k=d("lastWeek"),n=d(""),p=d(e()),H=[{title:"Última semana",value:"lastWeek"},{title:"Mes anterior",value:"lastMonth"},{title:"Mes actual",value:"currentMonth"},{title:"Últimos 3 meses",value:"lastThreeMonths"},{title:"Lo que va del año",value:"yearToDate"},{title:"Otro rango de fecha",value:"dateRange"}],I=()=>{B()},B=()=>{var L;((L=p==null?void 0:p.value)==null?void 0:L.length)==2&&_(U(p.value[0]),U(p.value[1]),V.value)};return P(()=>k.value,L=>{switch(L){case"lastWeek":p.value=e();break;case"lastMonth":p.value=i();break;case"currentMonth":p.value=m();break;case"lastThreeMonths":p.value=g();break;case"yearToDate":p.value=l();break;default:p.value=[],n.value=""}},{deep:!0}),ae(()=>{D({itemsPerPage:10,page:1}).then(()=>{z.value=[{id:0,title:"TODOS"},...F.value]}),B()}),(L,u)=>{const E=J,X=G;return y(),A(M,{class:"match-height"},{default:s(()=>[a(v,{cols:"12"},{default:s(()=>[a(le,{modelValue:C.value,"onUpdate:modelValue":u[3]||(u[3]=r=>C.value=r)},{default:s(()=>[a(re,null,{default:s(()=>[a(ie,null,{default:s(()=>u[4]||(u[4]=[Y(" Filtro avanzado ")])),_:1}),a(ne,null,{default:s(()=>[a(M,null,{default:s(()=>[a(v,{cols:"12",md:"12"},{default:s(()=>[b("div",be,[b("span",ye,[a(E,{modelValue:V.value,"onUpdate:modelValue":u[0]||(u[0]=r=>V.value=r),label:"Por proyecto",placeholder:"Seleccione una opción",items:z.value,"item-title":r=>r.title,"item-value":r=>r.id,config:{position:"auto right"}},null,8,["modelValue","items","item-title","item-value"])]),b("span",xe,[a(E,{modelValue:k.value,"onUpdate:modelValue":u[1]||(u[1]=r=>k.value=r),label:"En el tiempo",placeholder:"Seleccione una opción",items:H,config:{position:"auto right"}},null,8,["modelValue"])]),k.value==="dateRange"?(y(),R("span",Se,[a(X,{modelValue:n.value,"onUpdate:modelValue":u[2]||(u[2]=r=>n.value=r),label:"Rango de fecha",placeholder:"Seleccione las fechas",config:{mode:"range",dateFormat:"Y-m-d",maxDate:new Date,defaultDate:p.value,onValueUpdate:r=>{(r==null?void 0:r.length)>0&&(p.value=r)}}},null,8,["modelValue","config"])])):N("",!0),a(oe,{type:"submit",onClick:I,class:"clear-filter-btn"},{default:s(()=>u[5]||(u[5]=[Y(" Filtrar ")])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(v,{cols:"12"},{default:s(()=>[a(Z,{data:h(o),isLoading:h(S)},null,8,["data","isLoading"])]),_:1}),a(v,{cols:"12",md:"8"},{default:s(()=>[a(fe,{data:h(o),isLoading:h(S)},null,8,["data","isLoading"])]),_:1}),a(v,{cols:"12",md:"4"},{default:s(()=>[a(ue,{data:h(c),isLoading:h(S)},null,8,["data","isLoading"])]),_:1}),a(v,{cols:"12",md:"12"},{default:s(()=>[a(ve,{data:h(f),isLoading:h(S)},null,8,["data","isLoading"])]),_:1})]),_:1})}}};export{ut as default};
