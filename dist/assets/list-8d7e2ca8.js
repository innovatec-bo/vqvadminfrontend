import{u as ye}from"./useActivity-6f485a8d.js";import{r as N,e as Se}from"./validators-dea6e3a5.js";import{_ as fe}from"./AppTextarea-8436ece5.js";import{_ as Ae}from"./AppDateTimePicker-6657f4c7.js";import{_ as ne}from"./AppTextField-35484583.js";import{_ as re}from"./AppSelect-8eb8d0d1.js";import{u as X,p as ve,S as ge,_ as _e}from"./PreSaleForm-3d08f590.js";import{$ as te}from"./api-23eb8e44.js";import{s as be,a as ze,b as Oe}from"./notifications-9301c65a.js";import{r as D,o as r,c as x,d as l,F as T,i as B,b as e,e as t,n as a,v as S,x as k,z as R,f as U,$ as H,a4 as F,w as le,a3 as Ve,a as de,a0 as q,am as Q,an as ce,ac as Ue,H as qe}from"./index-c17c0958.js";import{V as xe}from"./VAvatar-ce7265de.js";import{b as J,c as Y,a as ie}from"./VList-ec66719a.js";import{a as f,V as L}from"./VRow-4fd024cd.js";import{V as W}from"./VChip-cf84ed73.js";import{V as M}from"./VCardText-76b245ae.js";import{a as we}from"./formatters-b3558c7d.js";import{u as Fe}from"./useQuote-8000ce06.js";import{_ as je}from"./AppAutocomplete-6b556608.js";import{_ as ue}from"./DialogCloseBtn-a521ccdf.js";import{u as Ee}from"./useProperty-58f92990.js";import{V as K,b as ke}from"./VCard-4b24e77c.js";import{V as De}from"./VForm-4684712c.js";import{V as pe}from"./VDialog-780bb7ea.js";import{V as se}from"./VCheckbox-8fb0e818.js";import{V as ee}from"./VTable-67bbcd85.js";import{V as Z}from"./VTextField-f02d33ae.js";import{_ as Pe}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as Te}from"./AppDrawerHeaderSection-4533aad2.js";import{P as Ie}from"./vue3-perfect-scrollbar.esm-02e69a06.js";import{V as Ne}from"./VNavigationDrawer-1a70f334.js";import{V as he,a as Re}from"./VWindowItem-7a5aedfa.js";import{V as Le,a as me}from"./VRadioGroup-b8c3555a.js";import{V as Be}from"./VDivider-15fe0f66.js";import{V as Me,a as He}from"./VTabs-c616f36c.js";import{V as Ge}from"./VOverlay-cff0f0f9.js";import"./helpers-61e4df1a.js";import"./form-ca750b56.js";/* empty css                   */import"./VCounter-26cf30a1.js";import"./VImg-e31022f3.js";import"./VField-8e24bfaf.js";import"./easing-9f15041e.js";import"./VInput-675679f3.js";import"./forwardRefs-8348545e.js";import"./VSelect-76315226.js";import"./dialog-transition-1b6befc1.js";import"./VMenu-8ef86977.js";import"./scopeId-e584fd0f.js";import"./VCheckboxBtn-2cfa3b3f.js";import"./VSelectionControl-1c667fb2.js";import"./InvoiceAddMoney-d568db8e.js";import"./VNodeRenderer-28528567.js";import"./index-9c720871.js";import"./constants-8e30317b.js";import"./ssrBoot-4659fedc.js";import"./filter-4b520261.js";import"./VSpacer-17b5e6d6.js";import"./lazy-8b508461.js";import"./VSlideGroup-09660861.js";const Ke=async(C,$)=>await te(`/opportunity/${C}/stage/${$}`,{method:"GET"}),Qe=async(C,$,o)=>await te(`/opportunity/${C}/procedure/${$}`,{method:"PATCH",body:o});function oe(){const C=D(null),$=D(!1),o=D(!1),g=D([]);return{process:C,loadingProcess:$,errorProcess:o,processes:g,allProcessesOpportunityForStage:async(d,n)=>{try{const m=await Ke(d,n);g.value=m.data}catch(m){console.log(m)}},checkProcessForOpportunity:async(d,n,m)=>{try{console.log(m);const _=await Qe(d,n,m);be("¡Proceso completado exitosamente!","El proceso ha sido llevado a cabo sin inconvenientes. ")}catch(_){console.log(_)}}}}const We={class:"mb-5"},Je={key:0},Ye=["src"],Xe={class:"my-5"},Ze={key:0,class:"d-flex flex-wrap gap-2 my-5"},et={key:1},tt={__name:"EditDeliveryOpportunity",props:{opportunity:{type:Object,required:!0}},emits:["updateStageId","complet"],setup(C,{emit:$}){const o=C,g=$,{changeStatusByOpportunity:O}=X(),{checkProcessForOpportunity:A}=oe(),d=async()=>{try{await O(o.opportunity.id,7,{}),g("complet")}catch(m){console.error("Error updating customer:",m)}},n=async(m,_)=>{console.log(`Procedimiento ${m} marcado como: ${_?"realizado":"no realizado"}`),await A(o.opportunity.id,m,{is_check:!_}),g("updateStageId",o.opportunity.id)};return(m,_)=>(r(),x(T,null,[l("div",We,[_[0]||(_[0]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Propiedades ",-1)),o.opportunity.sales.properties&&o.opportunity.sales.properties.length>0?(r(),x("div",Je,[(r(!0),x(T,null,B(o.opportunity.sales.properties,y=>(r(),x("div",{key:y.id,class:"d-flex align-center justify-between"},[e(xe,{size:"50",rounded:""},{default:t(()=>[l("img",{src:a(ve),alt:"Logo pora",style:{"border-radius":"30%"}},null,8,Ye)]),_:1}),e(f,{cols:"12",md:"7"},{default:t(()=>[e(J,{class:"font-weight-medium"},{default:t(()=>[S(k(y.project_title)+" | "+k(y.title),1)]),_:2},1024),e(Y,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",null,"$ "+k(y.pivot_price),1)]),_:2},1024)]),_:2},1024)]))),128))])):R("",!0)]),l("div",Xe,[_[2]||(_[2]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Procesos ",-1)),o.opportunity.procedure&&o.opportunity.procedure.length>0?(r(),x("div",Ze,[(r(!0),x(T,null,B(o.opportunity.procedure,y=>(r(),x("div",{key:y.id},[e(W,{color:y.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:P=>n(y.id,y.pivot.is_check)},{default:t(()=>[y.pivot.is_check?(r(),U(H,{key:0,icon:"tabler-check",class:"mr-2"})):R("",!0),S(" "+k(y.title),1)]),_:2},1032,["color","onClick"])]))),128))])):(r(),x("div",et,_[1]||(_[1]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),e(M,{class:"d-flex justify-center mt-4"},{default:t(()=>[e(F,{color:"primary",size:"small",onClick:d},{default:t(()=>_[3]||(_[3]=[S(" Finalizar Oportunidad ")])),_:1})]),_:1})],64))}},$e={__name:"EditCustomerDialog",props:{isDialogVisible:{type:Boolean,required:!0},opportunityKanban:{type:Object,required:!0}},emits:["update:isDialogVisible"],setup(C,{emit:$}){const o=C,g=$;Object.values(ge).map(i=>({title:i.label,value:i.value}));const{allProperty:O,properties:A}=Ee(),{getOpportunitybyId:d,opportunity:n,changeOpportunity:m,loadingOpportunity:_}=X(),y=()=>{g("update:isDialogVisible",!1)},P=async()=>{console.log("antes del save:",n);const i={id:n.value.id,description:n.value.description,property_id:n.value.property_id,customer:{id:n.value.customer.id,name:n.value.customer.name,email:n.value.customer.email,ci:n.value.customer.ci,cod_phone:n.value.cod_phone,phone:n.value.customer.phone}};await m(n.value.id,i),g("update:isDialogVisible",!1)},c=async()=>{var i;(i=o.opportunityKanban)!=null&&i.id&&await d(o.opportunityKanban.id)},b=async()=>{await O({page:1,itemsPerPage:100})};return le(()=>o.isDialogVisible,async i=>{i===!0&&(c(),await b())}),(i,h)=>{const p=ue,v=ne,s=re,w=je,G=fe;return r(),U(pe,{"max-width":"800","model-value":o.isDialogVisible,persistent:"","close-on-esc":!1,"onUpdate:modelValue":y},{default:t(()=>[e(p,{onClick:y}),e(K,{title:"Información del Cliente y Oportunidad",class:"pa-sm-8 pa-5"},{default:t(()=>[e(M,null,{default:t(()=>[e(De,{onSubmit:Ve(P,["prevent"])},{default:t(()=>[e(L,{dense:""},{default:t(()=>[e(f,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:a(n).customer.name,"onUpdate:modelValue":h[0]||(h[0]=V=>a(n).customer.name=V),label:"Nombre del Cliente",placeholder:"Ingresa el nombre",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:a(n).customer.email,"onUpdate:modelValue":h[1]||(h[1]=V=>a(n).customer.email=V),label:"Email del Cliente",placeholder:"Ingresa el email",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(L,null,{default:t(()=>[e(f,{cols:"4"},{default:t(()=>[e(s,{modelValue:a(n).customer.cod_phone,"onUpdate:modelValue":h[2]||(h[2]=V=>a(n).customer.cod_phone=V),label:"Código",items:["+591","+1","+52"],placeholder:"Cód.",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"8"},{default:t(()=>[e(v,{modelValue:a(n).customer.phone,"onUpdate:modelValue":h[3]||(h[3]=V=>a(n).customer.phone=V),label:"Número de Teléfono",placeholder:"Ingresa el teléfono",outlined:"",dense:"",maxlength:"9"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:a(n).customer.ci,"onUpdate:modelValue":h[4]||(h[4]=V=>a(n).customer.ci=V),label:"CI del Cliente",placeholder:"Ingresa el CI",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(w,{modelValue:a(n).property_id,"onUpdate:modelValue":h[5]||(h[5]=V=>a(n).property_id=V),label:"Departamento de Interés",placeholder:"Selecciona un Departamento",items:a(A).map(V=>({title:V.title,value:V.id})),outlined:""},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(G,{modelValue:a(n).description,"onUpdate:modelValue":h[6]||(h[6]=V=>a(n).description=V),label:"Descripción de la Oportunidad",placeholder:"Ingresa una descripción",rows:"3","auto-grow":"",outlined:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",class:"text-center"},{default:t(()=>[e(F,{type:"submit",color:"primary",class:"me-3",disabled:a(_),loading:a(_)},{default:t(()=>h[7]||(h[7]=[S(" Guardar ")])),_:1},8,["disabled","loading"]),e(F,{color:"secondary",variant:"tonal",onClick:y},{default:t(()=>h[8]||(h[8]=[S(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},lt={class:"d-flex align-bottom flex-sm-row flex-column"},ot={class:"user-profile-info"},at={class:"d-flex align-center justify-center justify-sm-space-between flex-wrap gap-4"},it={class:"d-flex align-center gap-x-3"},st={class:"text-4xl font-weight-medium"},nt={class:"d-flex flex-column py-2",style:{"font-size":"14px"}},rt={class:"text-sm text-disabled"},dt={key:0,class:"d-flex flex-wrap gap-2 my-5"},ut={key:1},pt={key:0,class:"d-flex flex-wrap gap-2 my-5"},ct={key:1},mt={__name:"EditPreSaleOpportunity",props:{opportunity:{type:Object,required:!0}},emits:["updateStageId"],setup(C,{emit:$}){const o=C,g=$,{checkProcessForOpportunity:O}=oe(),{changeStatusQuotes:A}=Fe(),d=D(!1),n=D(!1),m=()=>{d.value=!0},_=()=>{n.value=!0},y=async b=>{g("updateStageId",b)},P=async(b,i)=>{console.log(`Procedimiento ${b} marcado como: ${i?"realizado":"no realizado"}`),await O(o.opportunity.id,b,{is_check:!i}),g("updateStageId",o.opportunity.id)},c=async(b,i)=>{const h=i==="APPROVED"?"NOT_APPROVED":"APPROVED";console.log(`Procedimiento ${b} marcado como: ${i}`),await A(b,{status:h}),g("updateStageId",o.opportunity.id)};return(b,i)=>{const h=de("RouterLink");return r(),x(T,null,[l("div",lt,[l("div",ot,[i[3]||(i[3]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Perfil ",-1)),l("div",at,[l("div",it,[l("span",st,k(("avatarText"in b?b.avatarText:a(we))(o.opportunity.customer.name)),1),l("div",nt,[e(h,{to:{name:"apps-ecommerce-customer-details-id",params:{id:1}},class:"font-weight-base"},{default:t(()=>[S(k(o.opportunity.customer.name),1)]),_:1}),l("span",rt,k(o.opportunity.customer.phone),1)]),e(F,{color:"secondary",variant:"tonal",size:"small",onClick:m},{default:t(()=>i[2]||(i[2]=[S(" Editar Perfil ")])),_:1})])])])]),l("div",null,[i[5]||(i[5]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Procesos ",-1)),o.opportunity.procedure&&o.opportunity.procedure.length>0?(r(),x("div",dt,[(r(!0),x(T,null,B(o.opportunity.procedure,p=>(r(),x("div",{key:p.id},[e(W,{color:p.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:v=>P(p.id,p.pivot.is_check)},{default:t(()=>[p.pivot.is_check?(r(),U(H,{key:0,icon:"tabler-check",class:"mr-2"})):R("",!0),S(" "+k(p.title),1)]),_:2},1032,["color","onClick"])]))),128))])):(r(),x("div",ut,i[4]||(i[4]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),l("div",null,[i[8]||(i[8]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Cotizaciones ",-1)),o.opportunity.quotes&&o.opportunity.quotes.length>0?(r(),x("div",pt,[e(ee,{density:"compact",class:"text-no-wrap",style:{"font-size":"12px"}},{default:t(()=>[i[6]||(i[6]=l("thead",null,[l("tr",null,[l("th",null," Nombre "),l("th",null," Fecha "),l("th",null," Monto "),l("th")])],-1)),l("tbody",null,[(r(!0),x(T,null,B(o.opportunity.quotes,p=>(r(),x("tr",{key:p.id},[l("td",null,k(p.social_reason),1),l("td",null,k(new Date(p.created_at).toLocaleDateString()),1),l("td",null,k(p.amount),1),l("td",null,[e(L,null,{default:t(()=>[e(se,{modelValue:p.status,"onUpdate:modelValue":v=>p.status=v,"true-value":"APPROVED","false-value":"NOT_APPROVED",onClick:v=>c(p.id,p.status)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024)])]))),128))])]),_:1})])):(r(),x("div",ct,i[7]||(i[7]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),e(M,{class:"d-flex justify-center mt-4"},{default:t(()=>[e(h,{to:{name:"quote-add-quote"},class:"text-white"},{default:t(()=>[e(F,{color:"primary",class:"mx-1",variant:"tonal",size:"small"},{default:t(()=>i[9]||(i[9]=[S(" Generar Cotización ")])),_:1})]),_:1}),e(F,{color:"primary",class:"mx-auto",size:"small",onClick:_},{default:t(()=>i[10]||(i[10]=[S(" Generar Venta ")])),_:1})]),_:1}),e($e,{"is-dialog-visible":a(d),"onUpdate:isDialogVisible":i[0]||(i[0]=p=>q(d)?d.value=p:null),"opportunity-kanban":o.opportunity},null,8,["is-dialog-visible","opportunity-kanban"]),e(_e,{"is-dialog-visible":a(n),"onUpdate:isDialogVisible":i[1]||(i[1]=p=>q(n)?n.value=p:null),opportunity:o.opportunity,"type-stage":b.PRESALE,onRegisterSale:y},null,8,["is-dialog-visible","opportunity","type-stage"])],64)}}},yt={class:"d-flex align-bottom flex-sm-row flex-column"},ft={class:"user-profile-info"},vt={class:"d-flex align-center justify-center justify-sm-space-between flex-wrap gap-4"},gt={class:"d-flex align-center gap-x-3"},_t={class:"text-4xl font-weight-medium"},bt={class:"d-flex flex-column py-2",style:{"font-size":"14px"}},Vt={class:"text-sm text-disabled"},xt={key:0,class:"d-flex flex-wrap gap-2 my-5"},wt={key:1},kt={key:0,class:"d-flex flex-wrap gap-2 my-5"},Dt={key:1},Pt={__name:"EditProspectOpportunity",props:{opportunity:{type:Object,required:!0}},emits:["updateStageId"],setup(C,{emit:$}){const o=C,g=$,{checkProcessForOpportunity:O}=oe(),{changeStatusByOpportunity:A,loadingOpportunity:d}=X(),n=D(!1),m=()=>{n.value=!0},_=async P=>{await A(P,ge.PRESALE.value,{}),g("updateStageId",P)},y=async P=>{console.log(`Procedimiento ${P.id} marcado como: ${P.pivot.is_check?"realizado":"no realizado"}`),await O(o.opportunity.id,P.id,{is_check:!P.pivot.is_check}),P.pivot.is_check=!P.pivot.is_check,g("updateStageId",o.opportunity.id)};return(P,c)=>{const b=de("RouterLink");return r(),x(T,null,[l("div",yt,[l("div",ft,[c[3]||(c[3]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Perfil ",-1)),l("div",vt,[l("div",gt,[l("span",_t,k(("avatarText"in P?P.avatarText:a(we))(o.opportunity.customer.name)),1),l("div",bt,[e(b,{to:{name:"apps-ecommerce-customer-details-id",params:{id:1}},class:"font-weight-base"},{default:t(()=>[S(k(o.opportunity.customer.name),1)]),_:1}),l("span",Vt,k(o.opportunity.customer.phone),1)]),l("div",null,[e(F,{color:"secondary",variant:"tonal",size:"small",onClick:m},{default:t(()=>c[2]||(c[2]=[S(" Editar Perfil ")])),_:1})])])])])]),l("div",null,[c[5]||(c[5]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Procesos ",-1)),o.opportunity.procedure&&o.opportunity.procedure.length>0?(r(),x("div",xt,[(r(!0),x(T,null,B(o.opportunity.procedure,i=>(r(),x("div",{key:i.id},[e(W,{color:i.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:h=>y(i)},{default:t(()=>[i.pivot.is_check?(r(),U(H,{key:0,icon:"tabler-check",class:"mr-2"})):R("",!0),S(" "+k(i.title),1)]),_:2},1032,["color","onClick"])]))),128))])):(r(),x("div",wt,c[4]||(c[4]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),l("div",null,[c[8]||(c[8]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Cotizaciones ",-1)),o.opportunity.quotes&&o.opportunity.quotes.length>0?(r(),x("div",kt,[e(ee,{density:"compact",class:"text-no-wrap",style:{"font-size":"12px"}},{default:t(()=>[c[6]||(c[6]=l("thead",null,[l("tr",null,[l("th",null," Nombre "),l("th",null," Fecha "),l("th",null," Monto "),l("th")])],-1)),l("tbody",null,[(r(!0),x(T,null,B(o.opportunity.quotes,i=>(r(),x("tr",{key:i.id},[l("td",null,k(i.social_reason),1),l("td",null,k(new Date(i.created_at).toLocaleDateString()),1),l("td",null,k(i.amount),1),l("td",null,[e(H,{icon:"tabler-eye"})])]))),128))])]),_:1})])):(r(),x("div",Dt,c[7]||(c[7]=[l("span",null,"No hay cotizaciones disponibles.",-1)])))]),e(M,{class:"d-flex justify-center mt-4"},{default:t(()=>[e(b,{to:{name:"quote-add-quote"},class:"text-white"},{default:t(()=>[e(F,{color:"primary",class:"mx-1",variant:"tonal",size:"small"},{default:t(()=>c[9]||(c[9]=[S(" Generar Cotización ")])),_:1})]),_:1}),e(F,{color:"primary",class:"mx-auto",size:"small",disabled:a(d),loading:a(d),onClick:c[0]||(c[0]=i=>_(o.opportunity.id))},{default:t(()=>c[10]||(c[10]=[S(" Siguiente Etapa ")])),_:1},8,["disabled","loading"])]),_:1}),e($e,{"is-dialog-visible":a(n),"onUpdate:isDialogVisible":c[1]||(c[1]=i=>q(n)?n.value=i:null),"opportunity-kanban":o.opportunity},null,8,["is-dialog-visible","opportunity-kanban"])],64)}}},ht=async C=>await te(`/sale/paymentPlans/${C}/confirm`,{method:"PATCH"}),$t=async(C,$)=>await te(`/sale/paymentPlans/${C}`,{method:"PATCH",body:$});function Ce(){const C=D(!1),$=D([]),o=D(null),g=D(null);return{loadingPaymentPlans:C,paymentPlan:g,error:o,paymentPlans:$,confirmPaymentPlans:async d=>{try{const n=await ht(d);be("Actualizacion Exitosa","Se confirmo el pago")}catch(n){console.log(n)}},updatePaymentPlans:async(d,n)=>{C.value=!0,o.value=null;try{console.log(n);const m=await $t(d,n);g.value=m.data,ze("¡Planes de pago actualizados exitosamente! ","Los planes de pago han sido modificados y guardados correctamente."),console.log(m)}catch(m){console.log(m),m.response&&m.response.status==422&&Oe("Advertencia","Faltan datos por Completar"),o.value=m.message}finally{C.value=!1}}}}const Ct={__name:"DeliveryForm",props:{isDialogVisible:{type:Boolean,required:!0},opportunity:{type:Object,required:!0}},emits:["update:isDialogVisible","updateDeliveryDate"],setup(C,{emit:$}){const o=C,g=$,{changeStatusByOpportunity:O}=X(),A=_=>{g("update:isDialogVisible",_)},d=D(structuredClone(Q(o.opportunity)));le(o,()=>{d.value=structuredClone(Q(o.opportunity))});const n=async()=>{g("update:isDialogVisible",!1);try{await O(o.opportunity.id,5,{delivery_date:d.value.sales.delivery_date}),g("updateDeliveryDate",d.value.id)}catch(_){console.error("Error updating customer:",_)}},m=()=>{g("update:isDialogVisible",!1)};return(_,y)=>{const P=ue;return r(),U(pe,{"model-value":o.isDialogVisible,"max-width":"800","onUpdate:modelValue":A},{default:t(()=>[e(P,{onClick:y[0]||(y[0]=c=>_.$emit("update:isDialogVisible",!1))}),e(K,{class:"pa-sm-8 pa-5"},{default:t(()=>[e(ke,{class:"text-h3 text-center"},{default:t(()=>y[2]||(y[2]=[S(" Confirmar Fecha ")])),_:1}),e(M,null,{default:t(()=>[e(M,null,{default:t(()=>[e(L,null,{default:t(()=>[e(f,{cols:"12",style:{"padding-block":"0","padding-inline":"8px"}},{default:t(()=>[e(Z,{modelValue:a(d).sales.delivery_date,"onUpdate:modelValue":y[1]||(y[1]=c=>a(d).sales.delivery_date=c),label:"Fecha de Entrega",type:"date",rules:["requiredValidator"in _?_.requiredValidator:a(N)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(F,{onClick:n},{default:t(()=>y[3]||(y[3]=[S(" Pasar a Entrega ")])),_:1}),e(F,{color:"secondary",variant:"tonal",onClick:m},{default:t(()=>y[4]||(y[4]=[S(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},St={__name:"PaymentPlanEdit",props:{isDialogVisible:{type:Boolean,required:!0},opportunity:{type:Object,required:!0},payment:{type:Object,required:!0}},emits:["update:isDialogVisible","updateDeliveryDate"],setup(C,{emit:$}){const o=C,g=$,{updatePaymentPlans:O}=Ce(),A=b=>{g("update:isDialogVisible",b)},d=D(structuredClone(Q(o.payment))),n=D(structuredClone(Q(o.opportunity)));le(o,()=>{d.value=structuredClone(Q(o.payment)),n.value=structuredClone(Q(o.opportunity))});const m=D([]),_=()=>{m.value.push({amount:"",date:"",type:d.value.type})},y=b=>{m.value.splice(b,1)},P=async()=>{try{await O(d.value.id,{date:d.value.date,differData:m.value})}catch(b){console.error("Error updating customer:",b)}finally{g("updateDeliveryDate",n.value.id),g("update:isDialogVisible",!1),m.value=[]}},c=()=>{g("update:isDialogVisible",!1),m.value=[],errorMessage.value=""};return(b,i)=>{const h=ue;return r(),U(pe,{"model-value":o.isDialogVisible,"max-width":"800","onUpdate:modelValue":A},{default:t(()=>[e(h,{onClick:i[0]||(i[0]=p=>b.$emit("update:isDialogVisible",!1))}),e(K,{class:"pa-sm-8 pa-5"},{default:t(()=>[e(ke,{class:"text-h3 text-center"},{default:t(()=>i[2]||(i[2]=[S(" Confirmar Fecha ")])),_:1}),e(M,null,{default:t(()=>[e(M,null,{default:t(()=>[e(L,null,{default:t(()=>[e(f,{cols:"12",style:{"padding-block":"0","padding-inline":"8px"}},{default:t(()=>[l("span",null," Monto a Pagar : "+k(a(d).amount),1),e(K,{flat:"",class:"d-flex flex-column pa-5"},{default:t(()=>[e(Z,{modelValue:a(d).date,"onUpdate:modelValue":i[1]||(i[1]=p=>a(d).date=p),label:"Fecha de Entrega",type:"date",rules:["requiredValidator"in b?b.requiredValidator:a(N)]},null,8,["modelValue","rules"]),(r(!0),x(T,null,B(a(m),(p,v)=>(r(),x("div",{key:p.id,class:"d-flex align-center my-4"},[e(Z,{modelValue:p.amount,"onUpdate:modelValue":s=>p.amount=s,label:"Monto",type:"number",class:"mr-4",outlined:"",rules:["requiredValidator"in b?b.requiredValidator:a(N)]},null,8,["modelValue","onUpdate:modelValue","rules"]),e(Z,{modelValue:p.date,"onUpdate:modelValue":s=>p.date=s,label:"Fecha de Pago",type:"date",class:"mr-3",outlined:"",rules:["requiredValidator"in b?b.requiredValidator:a(N)]},null,8,["modelValue","onUpdate:modelValue","rules"]),e(F,{color:"error",onClick:s=>y(v)},{default:t(()=>[e(H,{icon:"tabler-square-x"})]),_:2},1032,["onClick"])]))),128)),e(F,{color:"primary",variant:"tonal",class:"mt-4",size:"small",onClick:_},{default:t(()=>i[3]||(i[3]=[S(" Agregar Pago ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(F,{onClick:P},{default:t(()=>i[4]||(i[4]=[S(" Guardar ")])),_:1}),e(F,{color:"error",variant:"tonal",onClick:c},{default:t(()=>i[5]||(i[5]=[S(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},At={class:"text-h6"},zt={class:"text-h6"},Ot={class:"text-h6"},Ut={class:"my-5"},qt={key:0},Ft=["src"],jt={class:"mb-4"},Et=["onClick"],Tt=["onClick"],It={class:"my-5"},Nt={key:0,class:"d-flex flex-wrap gap-2 my-5"},Rt={key:1},Lt={__name:"EditSaleOpportunity",props:{opportunity:{type:Object,required:!0}},emits:["updateStageId"],setup(C,{emit:$}){const o=C,g=$,{checkProcessForOpportunity:O}=oe(),{confirmPaymentPlans:A}=Ce(),d=D(!1),n=D(!1),m=D(!1),_=D(""),y=()=>{d.value=!0},P=p=>{console.log("entro aqui"),n.value=!0,_.value={...p}},c=async p=>{g("updateStageId",p)},b=async p=>{console.log(`Procedimiento ${p.id} marcado como: ${p.pivot.is_check?"realizado":"no realizado"}`),await O(o.opportunity.id,p.id,{is_check:!p.pivot.is_check}),p.pivot.is_check=!p.pivot.is_check,g("updateStageId",o.opportunity.id)},i=async p=>{console.log(p),await A(p),g("updateStageId",o.opportunity.id)},h=async p=>{g("updateStageId",p)};return(p,v)=>(r(),x(T,null,[l("div",null,[e(K,null,{default:t(()=>[e(M,null,{default:t(()=>[e(L,null,{default:t(()=>[e(f,{cols:"4",class:"border rounded-sm mx-1"},{default:t(()=>[e(J,{class:"font-weight-medium"},{default:t(()=>v[3]||(v[3]=[S(" Saldo ")])),_:1}),e(Y,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",At,"$ "+k(o.opportunity.sales.amount-o.opportunity.sales.initial_fee),1)]),_:1})]),_:1}),e(f,{cols:"3",class:"border rounded-sm mx-1"},{default:t(()=>[e(J,{class:"font-weight-medium"},{default:t(()=>v[4]||(v[4]=[S(" Anticipo ")])),_:1}),e(Y,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",zt,"$ "+k(o.opportunity.sales.initial_fee),1)]),_:1})]),_:1}),e(f,{cols:"4",class:"border rounded-sm mx-1"},{default:t(()=>[e(J,{class:"font-weight-medium"},{default:t(()=>v[5]||(v[5]=[S(" Precio Final ")])),_:1}),e(Y,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",Ot,"$"+k(o.opportunity.sales.amount),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",Ut,[v[6]||(v[6]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Propiedades ",-1)),o.opportunity.sales.properties&&o.opportunity.sales.properties.length>0?(r(),x("div",qt,[(r(!0),x(T,null,B(o.opportunity.sales.properties,s=>(r(),x("div",{key:s.id,class:"d-flex align-center justify-between"},[e(xe,{size:"50",rounded:""},{default:t(()=>[l("img",{src:a(ve),alt:"Logo pora",style:{"border-radius":"30%"}},null,8,Ft)]),_:1}),e(f,{cols:"12",md:"7"},{default:t(()=>[e(J,{class:"font-weight-medium"},{default:t(()=>[S(k(s.project_title)+" | "+k(s.title),1)]),_:2},1024),e(Y,{class:"text-disabled d-flex justify-between mt-1"},{default:t(()=>[l("span",null,"$ "+k(s.pivot_price),1)]),_:2},1024)]),_:2},1024)]))),128))])):R("",!0)]),l("div",jt,[v[8]||(v[8]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Cuota Inicial ",-1)),o.opportunity.sales.initial_payments&&o.opportunity.sales.initial_payments.length>0?(r(),U(ee,{key:0,density:"compact",class:"text-no-wrap my-2",style:{"font-size":"12px"}},{default:t(()=>[v[7]||(v[7]=l("thead",null,[l("tr",null,[l("th",null," Propiedad "),l("th",null," Fecha "),l("th",null," Monto "),l("th",null," Action ")])],-1)),l("tbody",null,[(r(!0),x(T,null,B(o.opportunity.sales.initial_payments,s=>(r(),x("tr",{key:s.id},[l("td",null,k(s.property_title),1),l("td",null,k(s.date),1),l("td",null,k(s.amount),1),l("td",null,[e(L,null,{default:t(()=>[e(se,{modelValue:s.is_paid,"onUpdate:modelValue":w=>s.is_paid=w,"true-value":1,"false-value":0,disabled:s.is_paid===1,onChange:w=>i(s.id)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),l("div",{"fill-dot":"",onClick:w=>P(s)},[e(H,{size:"25",icon:"tabler-edit"})],8,Et)]),_:2},1024)])]))),128))])]),_:1})):R("",!0)]),l("div",null,[v[10]||(v[10]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Saldos ",-1)),o.opportunity.sales.balance_payments&&o.opportunity.sales.balance_payments.length>0?(r(),U(ee,{key:0,density:"compact",class:"text-no-wrap my-2",style:{"font-size":"12px"}},{default:t(()=>[v[9]||(v[9]=l("thead",null,[l("tr",null,[l("th",null," Propiedad "),l("th",null," Fecha "),l("th",null," Monto "),l("th",null," Action ")])],-1)),l("tbody",null,[(r(!0),x(T,null,B(o.opportunity.sales.balance_payments,s=>(r(),x("tr",{key:s.id},[l("td",null,k(s.property_title),1),l("td",null,k(s.date),1),l("td",null,k(s.amount),1),l("td",null,[e(L,null,{default:t(()=>[e(se,{modelValue:s.is_paid,"onUpdate:modelValue":w=>s.is_paid=w,"true-value":1,"false-value":0,disabled:s.is_paid===1,onChange:w=>i(s.id)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),l("div",{"fill-dot":"",onClick:w=>P(s)},[e(H,{size:"25",icon:"tabler-edit"})],8,Tt)]),_:2},1024)])]))),128))])]),_:1})):R("",!0)]),l("div",It,[v[12]||(v[12]=l("span",{style:{"font-size":"14px","font-weight":"500"}}," Procesos ",-1)),o.opportunity.procedure&&o.opportunity.procedure.length>0?(r(),x("div",Nt,[(r(!0),x(T,null,B(o.opportunity.procedure,s=>(r(),x("div",{key:s.id},[e(W,{color:s.pivot.is_check?"primary":"secondary",variant:"outlined",class:"my-1",style:{cursor:"pointer"},"fill-dot":"",onClick:w=>b(s)},{default:t(()=>[s.pivot.is_check?(r(),U(H,{key:0,icon:"tabler-check",class:"mr-2"})):R("",!0),S(" "+k(s.title),1)]),_:2},1032,["color","onClick"])]))),128))])):(r(),x("div",Rt,v[11]||(v[11]=[l("span",null,"No hay procedimientos disponibles.",-1)])))]),e(M,{class:"d-flex mt-4"},{default:t(()=>[e(F,{color:"primary",class:"mx-auto",size:"small",onClick:y},{default:t(()=>v[13]||(v[13]=[S(" Siguiente Etapa ")])),_:1})]),_:1}),e(Ct,{"is-dialog-visible":a(d),"onUpdate:isDialogVisible":v[0]||(v[0]=s=>q(d)?d.value=s:null),opportunity:o.opportunity,onUpdateDeliveryDate:h},null,8,["is-dialog-visible","opportunity"]),e(St,{"is-dialog-visible":a(n),"onUpdate:isDialogVisible":v[1]||(v[1]=s=>q(n)?n.value=s:null),payment:a(_),opportunity:o.opportunity,onUpdateDeliveryDate:h},null,8,["is-dialog-visible","payment","opportunity"]),e(_e,{"is-dialog-visible":a(m),"onUpdate:isDialogVisible":v[2]||(v[2]=s=>q(m)?m.value=s:null),opportunity:o.opportunity,"type-stage":p.SALE,onRegisterSale:c},null,8,["is-dialog-visible","opportunity","type-stage"])],64))}};const Bt={__name:"SellerReport",setup(C){return D([{title:"Actividad 1",date:"2024-10-09",status:"Pendiente"},{title:"Actividad 2",date:"2024-10-10",status:"Completada"},{title:"Actividad 3",date:"2024-10-11",status:"En Progreso"}]),($,o)=>(r(),U(M,null,{default:t(()=>o[0]||(o[0]=[l("p",null,"No hay actividades seleccionadas. Aquí tienes un resumen de las actividades:",-1)])),_:1}))}},Mt=Pe(Bt,[["__scopeId","data-v-c9cbe3f1"]]),Ht={__name:"CustomerHistory",props:{isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","userData"],setup(C,{emit:$}){const o=C,g=$,O=D(!1),A=D(),d=D(""),n=D(""),m=D(""),_=D(""),y=D(),P=D(""),c=D(),b=D(),i=D(),h=()=>{g("update:isDrawerOpen",!1),ce(()=>{var s,w;(s=A.value)==null||s.reset(),(w=A.value)==null||w.resetValidation()})},p=()=>{var s;(s=A.value)==null||s.validate().then(({valid:w})=>{w&&(g("userData",{id:0,fullName:d.value,company:_.value,role:c.value,country:y.value,contact:P.value,email:m.value,currentPlan:b.value,status:i.value,avatar:"",billing:"Auto Debit"}),g("update:isDrawerOpen",!1),ce(()=>{var G,V;(G=A.value)==null||G.reset(),(V=A.value)==null||V.resetValidation()}))})},v=s=>{g("update:isDrawerOpen",s)};return(s,w)=>{const G=Te,V=ne,u=re;return r(),U(Ne,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":o.isDrawerOpen,"onUpdate:modelValue":v},{default:t(()=>[e(G,{title:"Historial del Cliente",onCancel:h}),e(a(Ie),{options:{wheelPropagation:!1}},{default:t(()=>[e(K,{flat:""},{default:t(()=>[e(M,null,{default:t(()=>[e(De,{ref_key:"refForm",ref:A,modelValue:a(O),"onUpdate:modelValue":w[9]||(w[9]=z=>q(O)?O.value=z:null),onSubmit:Ve(p,["prevent"])},{default:t(()=>[e(L,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[e(V,{modelValue:a(d),"onUpdate:modelValue":w[0]||(w[0]=z=>q(d)?d.value=z:null),rules:["requiredValidator"in s?s.requiredValidator:a(N)],label:"Full Name",placeholder:"John Doe"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(V,{modelValue:a(n),"onUpdate:modelValue":w[1]||(w[1]=z=>q(n)?n.value=z:null),rules:["requiredValidator"in s?s.requiredValidator:a(N)],label:"Username",placeholder:"Johndoe"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(V,{modelValue:a(m),"onUpdate:modelValue":w[2]||(w[2]=z=>q(m)?m.value=z:null),rules:["requiredValidator"in s?s.requiredValidator:a(N),"emailValidator"in s?s.emailValidator:a(Se)],label:"Email",placeholder:"johndoe@email.com"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(V,{modelValue:a(_),"onUpdate:modelValue":w[3]||(w[3]=z=>q(_)?_.value=z:null),rules:["requiredValidator"in s?s.requiredValidator:a(N)],label:"Company",placeholder:"PixInvent"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(u,{modelValue:a(y),"onUpdate:modelValue":w[4]||(w[4]=z=>q(y)?y.value=z:null),label:"Select Country",placeholder:"Select Country",rules:["requiredValidator"in s?s.requiredValidator:a(N)],items:["USA","UK","India","Australia"]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(V,{modelValue:a(P),"onUpdate:modelValue":w[5]||(w[5]=z=>q(P)?P.value=z:null),type:"number",rules:["requiredValidator"in s?s.requiredValidator:a(N)],label:"Contact",placeholder:"+1-541-754-3010"},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(u,{modelValue:a(c),"onUpdate:modelValue":w[6]||(w[6]=z=>q(c)?c.value=z:null),label:"Select Role",placeholder:"Select Role",rules:["requiredValidator"in s?s.requiredValidator:a(N)],items:["Admin","Author","Editor","Maintainer","Subscriber"]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(u,{modelValue:a(b),"onUpdate:modelValue":w[7]||(w[7]=z=>q(b)?b.value=z:null),label:"Select Plan",placeholder:"Select Plan",rules:["requiredValidator"in s?s.requiredValidator:a(N)],items:["Basic","Company","Enterprise","Team"]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(u,{modelValue:a(i),"onUpdate:modelValue":w[8]||(w[8]=z=>q(i)?i.value=z:null),label:"Select Status",placeholder:"Select Status",rules:["requiredValidator"in s?s.requiredValidator:a(N)],items:[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"},{title:"Pending",value:"pending"}]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(F,{type:"submit",class:"me-3"},{default:t(()=>w[10]||(w[10]=[S(" Submit ")])),_:1}),e(F,{type:"reset",variant:"outlined",color:"secondary",onClick:h},{default:t(()=>w[11]||(w[11]=[S(" Cancel ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Gt={class:"mb-2"},Kt={__name:"AddActivity",props:{activitiesData:{type:Object,required:!0,default:()=>({title:"",description:"",schedule_at:""})},isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","refreshActivities"],setup(C,{emit:$}){const o=C,g=$,O=D(!1);D(!1);const A=D("radio-1"),d=D({title:"",description:"",type_activity_id:null,opportunity_id:null,assigned_to:null,scheduled_at:null,status:"COMPLETED"}),{completedActivityAndRegister:n,getallTypeActivities:m,typeActivities:_,loadingActivity:y}=ye(),{getOpportunitybyId:P,opportunity:c}=X(),b=D(structuredClone(Q(o.activitiesData))),i=V=>{console.log("esta consultando de nuevo despues de cambiar etapa "),P(V)};le(o,()=>{b.value=structuredClone(Q(o.activitiesData)),P(b.value.opportunity_id),h()});const h=async()=>{await m()},p=()=>{P(b.value.opportunity_id)},v=()=>{g("update:isDrawerOpen",!1),d.value={title:null,description:null,type_activity_id:null,scheduled_at:null,opportunity_id:null,assigned_to:null,status:"COMPLETED"},g("refreshActivities")},s=async()=>{let V="";A.value==="radio-1"?V="COMPLETED":A.value==="radio-2"&&(V="CANCELLED"),n(b.value.id,{title:d.value.title,description:d.value.description,type_activity_id:d.value.type_activity_id,scheduled_at:d.value.scheduled_at,assigned_to:c.value.user_id,property_id:c.value.property_id,opportunity_id:c.value.id,status:V}),v()},w=async()=>{g("update:isDrawerOpen",!1),g("refreshActivities")},G=V=>{const u=new Date(V),z=u.getDate(),I=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][u.getMonth()],j=u.getHours().toString().padStart(2,"0"),ae=u.getMinutes().toString().padStart(2,"0");return`${z} de ${I}, ${j}:${ae}`};return(V,u)=>{const z=ne,E=Ae,I=fe;return r(),U(L,{class:"d-flex justify-space-between"},{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[C.isDrawerOpen?(r(),U(K,{key:0},{default:t(()=>[e(M,null,{default:t(()=>[e(he,{class:"mx-2 my-2"},{default:t(()=>[e(L,null,{default:t(()=>[e(f,{cols:"12",sm:"5"},{default:t(()=>[e(L,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>u[6]||(u[6]=[l("span",{style:{"font-size":"18px","font-weight":"500"}}," Actividad ",-1)])),_:1}),e(f,{cols:"12"},{default:t(()=>[l("div",Gt,[l("span",null,k(o.activitiesData.title)+" • "+k(G(o.activitiesData.scheduled_at)),1)]),e(Le,{modelValue:a(A),"onUpdate:modelValue":u[0]||(u[0]=j=>q(A)?A.value=j:null),style:{"font-size":"14px"},inline:""},{default:t(()=>[u[7]||(u[7]=l("span",null," ¿ Se Realizo ? ",-1)),e(me,{label:"Si",value:"radio-1",density:"compact"}),e(me,{label:"No",value:"radio-2",density:"compact"})]),_:1},8,["modelValue"]),e(Be,{class:"mt-2"})]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(z,{modelValue:a(d).title,"onUpdate:modelValue":u[1]||(u[1]=j=>a(d).title=j),label:"Titulo de la actividad",placeholder:"..."},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(re,{modelValue:a(d).type_activity_id,"onUpdate:modelValue":u[2]||(u[2]=j=>a(d).type_activity_id=j),label:"Tipo de Actividad",placeholder:"Selecciona el Tipo de Actividad",items:a(_).map(j=>({title:j.name,value:j.id}))},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(E,{modelValue:a(d).scheduled_at,"onUpdate:modelValue":u[3]||(u[3]=j=>a(d).scheduled_at=j),label:"Seleccione la Fecha y Hora",placeholder:"Select date and time",config:{enableTime:!0,dateFormat:"Y-m-d H:i"},rules:["requiredValidator"in V?V.requiredValidator:a(N)]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(I,{modelValue:a(d).description,"onUpdate:modelValue":u[4]||(u[4]=j=>a(d).description=j),label:"Descripcion",rows:"3",rules:["requiredValidator"in V?V.requiredValidator:a(N)]},null,8,["modelValue","rules"])]),_:1}),e(f,null,{default:t(()=>[e(F,{color:"primary",class:"mx-auto",size:"small",loading:a(y),disabled:a(y),onClick:s},{default:t(()=>u[8]||(u[8]=[S(" Crear Actividad ")])),_:1},8,["loading","disabled"]),e(F,{color:"primary",class:"mx-1",variant:"tonal",size:"small"},{default:t(()=>u[9]||(u[9]=[S(" Dar de Baja ")])),_:1})]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",sm:"7",style:{"align-items":"center"}},{default:t(()=>[e(L,{class:"mb-2"},{default:t(()=>[e(f,{cols:"6"},{default:t(()=>u[10]||(u[10]=[l("span",{style:{"font-size":"18px","font-weight":"500"}}," Etapa ",-1)])),_:1}),e(f,{cols:"12",md:"6",class:"d-flex justify-end align-center"},{default:t(()=>[e(W,{label:"",color:"primary"},{default:t(()=>[S(k(a(c).stage.title),1)]),_:1})]),_:1})]),_:1}),a(c).stage_id===2?(r(),U(Pt,{key:0,opportunity:a(c),onUpdateStageId:i},null,8,["opportunity"])):R("",!0),a(c).stage_id===3?(r(),U(mt,{key:1,opportunity:a(c),onUpdateStageId:i},null,8,["opportunity"])):R("",!0),a(c).stage_id===4?(r(),U(Lt,{key:2,opportunity:a(c),onRefreshActivities:p,onUpdateStageId:i},null,8,["opportunity"])):R("",!0),a(c).stage_id===5?(r(),U(tt,{key:3,opportunity:a(c),onRefreshActivities:p,onUpdateStageId:i,onComplet:w},null,8,["opportunity"])):R("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(r(),U(K,{key:1,title:"Reporte de Actividades"},{default:t(()=>[e(Mt)]),_:1}))]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(Ht,{"is-drawer-open":a(O),"onUpdate:isDrawerOpen":u[5]||(u[5]=j=>q(O)?O.value=j:null)},null,8,["is-drawer-open"])]),_:1})]),_:1})}}};const Qt={style:{"font-size":"14px"}},Wt={key:0,class:"no-activities-message d-flex flex-column justify-center align-center",style:{"min-block-size":"200px","text-align":"center"}},Jt=["onClick"],Yt={class:"mx-2"},Xt={class:"d-flex justify-content-between",style:{"font-size":"0.9em"}},Zt={__name:"list",setup(C){const $=D("New");D(["Todos","PORA"]),D("Todos");const{getallActivitiesByAsesorFecha:o,getallActivitiesByFechaPast:g,getallActivitiesByFechaFuture:O,activities:A,activitiesPast:d,activitiesFuture:n}=ye(),m=D(""),_=Ue("userData").value,y=D(!0),P=async()=>{await o(_.id),console.log("Actividades de hoy:",A)},c=async()=>{await g(_.id),console.log("Actividades pasadas:",d)},b=async()=>{await O(_.id),console.log("Actividades futuras:",n)};qe(async()=>{await P(),await c(),await b(),y.value=!1});const i=D(!1),h=V=>{i.value=!0,m.value={...V}},p=async()=>{await P(),await c(),await b(),y.value=!1},v=[{tabName:"Hoy",icon:"tabler-edit",actividades:A,badge:A.value.length},{tabName:"Anteriores",icon:"tabler-calendar",actividades:d,badge:d.value.length},{tabName:"Futuros",icon:"tabler-calendar",actividades:n,badge:n.value.length}],s=[{type:"Visita",icon:"tabler-current-location"},{type:"Llamada",icon:"tabler-phone"},{type:"Cotizacion",icon:"tabler-cash"},{type:"Otro",icon:"tabler-table"}],w=V=>{const u=s.find(z=>z.type===V);return u?u.icon:"tabler-default"},G=V=>{const u=new Date(V),z=u.getDate(),I=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][u.getMonth()],j=u.getHours().toString().padStart(2,"0"),ae=u.getMinutes().toString().padStart(2,"0");return`${z} de ${I}, ${j}:${ae}`};return(V,u)=>{const z=de("VCircularProgress");return r(),U(L,{class:"match-height",style:{display:"flex","block-size":"100vh"}},{default:t(()=>[e(f,{cols:"12",md:"4",style:{display:"flex","flex-direction":"column"}},{default:t(()=>[e(K,{title:"Lista de Actividades",class:"flex-grow-1"},{default:t(()=>[e(Me,{modelValue:a($),"onUpdate:modelValue":u[0]||(u[0]=E=>q($)?$.value=E:null),grow:""},{default:t(()=>[(r(),x(T,null,B(v,E=>e(He,{key:E.tabName},{default:t(()=>[l("span",Qt,k(E.tabName),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),u[9]||(u[9]=l("br",null,null,-1)),e(M,{style:{"flex-grow":"1","overflow-y":"auto"}},{default:t(()=>[a(y)?(r(),U(Ge,{key:0,absolute:"",opacity:"0.7"},{default:t(()=>[e(z,{indeterminate:"",size:"70"})]),_:1})):R("",!0),e(he,{modelValue:a($),"onUpdate:modelValue":u[1]||(u[1]=E=>q($)?$.value=E:null),class:"disable-tab-transition",style:{"max-block-size":"500px","overflow-y":"auto"}},{default:t(()=>[(r(),x(T,null,B(v,E=>e(Re,{key:E.tabName,value:E.tabName},{default:t(()=>[E.actividades.value.length===0?(r(),x("div",Wt,[e(H,{size:"64",color:"grey",icon:"tabler-calendar-off",class:"mb-4",style:{animation:"bounce 1s infinite"}}),u[4]||(u[4]=l("div",{style:{color:"#888","font-size":"1.2em"}}," ¡No tienes actividades pendientes! ",-1)),u[5]||(u[5]=l("div",{style:{color:"#aaa","font-size":"0.9em","margin-block-start":"8px"}}," ¡Relájate y disfruta tu día! ",-1))])):(r(!0),x(T,{key:1},B(E.actividades.value,I=>(r(),x("div",{key:I.id,"fill-dot":"",class:"border mb-2 rounded-sm py-2",onClick:j=>h(I)},[e(ie,null,{default:t(()=>[e(L,null,{default:t(()=>[e(f,{cols:"12",md:"2",style:{"padding-inline-end":"0"}},{default:t(()=>[e(W,{class:"d-flex justify-center align-center",style:{display:"inline-flex","border-radius":"4px","block-size":"36px","inline-size":"36px"}},{default:t(()=>[e(H,{size:"25",icon:"tabler-home"})]),_:1})]),_:1}),I.project_name?(r(),U(f,{key:0,cols:"12",md:"5",class:"d-flex flex-column align-start",style:{"padding-inline-start":"0"}},{default:t(()=>[e(Y,{class:"text-left"},{default:t(()=>[l("strong",null,k(I.property_title),1)]),_:2},1024),e(J,{class:"font-weight-medium text-left"},{default:t(()=>[l("span",null,"$ "+k(I.price),1)]),_:2},1024)]),_:2},1024)):R("",!0),I.project_name?R("",!0):(r(),U(f,{key:1,cols:"12",md:"5"},{default:t(()=>[e(Y,{class:"text-left"},{default:t(()=>u[6]||(u[6]=[l("strong",null," Departamento ",-1)])),_:1}),e(J,{class:"font-weight-medium text-left"},{default:t(()=>u[7]||(u[7]=[l("span",null,"Indefinido",-1)])),_:1})]),_:1})),e(f,{cols:"12",md:"5",class:"d-flex justify-end align-center"},{default:t(()=>[e(W,{label:"",color:"primary",class:"ml-auto",style:{"font-size":"10px"}},{default:t(()=>[S(k(I.stage),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(ie,{class:""},{default:t(()=>[e(W,{label:"",color:"secondary",class:"w-100 h-48"},{default:t(()=>[e(H,{size:"20",icon:w(I.type_activity)},null,8,["icon"]),l("div",Yt,k(I.type_activity)+"   •   "+k(I.name_opportunity),1)]),_:2},1024)]),_:2},1024),e(ie,null,{default:t(()=>[l("div",Xt,[u[8]||(u[8]=l("div",{style:{"flex-grow":"1"}}," Ver ",-1)),l("div",null,k(G(I.scheduled_at)),1)])]),_:2},1024)],8,Jt))),128))]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",md:"8",style:{display:"flex","flex-direction":"column"}},{default:t(()=>[e(Kt,{"is-drawer-open":a(i),"onUpdate:isDrawerOpen":u[2]||(u[2]=E=>q(i)?i.value=E:null),"activities-data":a(m),class:"flex-grow-1",onRefreshActivities:p,onLoaded:u[3]||(u[3]=E=>y.value=!1)},null,8,["is-drawer-open","activities-data"])]),_:1})]),_:1})}}},io=Pe(Zt,[["__scopeId","data-v-eaf15013"]]);export{io as default};
